(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5620],{54283:function(r,h,m){"use strict";m.d(h,{$:function(){return S},J:function(){return w}});var u=m(94801),_=m(55858),f=m(53596);let g=(0,f.j)();function v(r){let h;let m=/(\w+):("[^"]+"|\S+)/g,u={},_=r;for(;null!==(h=m.exec(r));){let r=h[1].toLowerCase(),m=h[2].replace(/"/g,"").toLowerCase();u[r]=m,_=_.replace(h[0],"")}return{parsed:u,searchWithoutTags:_=_.trim()}}class w{get(r,h){var m;return null!==(m=this.data[r])&&void 0!==m?m:h}getObjectSchema(){return this.objectSchema}getModelName(){return this.modelName}getLocation(){let r=this.objectSchema.is("location").getFields();if(!r.length)throw"Model error: "+this.getModelName()+" doesn't have location information";let h=r[0],m=this.objectSchema.getFieldKeyDefinition(h,"latKey"),u=this.objectSchema.getFieldKeyDefinition(h,"lonKey");if(this.data[h])return{lat:this.data[h][m],lon:this.data[h][u]}}getId(){return this.data[this.idField]}getNotificationsTopic(r){return"notifications/".concat(this.getModelName(),"/").concat(r,"/").concat(this.getId())}getNotificationsPayload(){return this.serialize()}setId(r,h){return new this.constructor({...h||this.data,[this.idField]:r},this.session,this.modelName)}isVisible(){return!this.isDeleted()}isDeleted(){return!!this.data._deleted}list(r,h,m,u){if(!r)return this.read();{let{parsed:h,searchWithoutTags:m}=v(r);for(let[r,m]of Object.entries(h))if(!this.data.hasOwnProperty(r)||this.data[r]!=m)return;let u=this.objectSchema.is("search").getFields();for(var _=0;_<u.length;_++)if((this.data[u[_]]+"").toLowerCase().includes(m.toLowerCase()))return this.read()}}async listTransformed(r){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0,_=arguments.length>4?arguments[4]:void 0,f=this.list(r,m,u,_);if(f)return await this.getObjectSchema().apply("list",f,h)}create(r){let h=this.getData(r);return g.debug({transformed:h},"Creating object: ".concat(JSON.stringify(h))),new this.constructor(h,this.session,this.modelName).validate()}async createTransformed(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=await this.getObjectSchema().apply("create",{...this.data},r);return this.create(h)}read(r){return{...this.data}}async readTransformed(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=arguments.length>1?arguments[1]:void 0,m=await this.getObjectSchema().apply("read",this.read(h),r);return m}update(r,h){return r.setId(this.getId(),{...h||r.data})}async updateTransformed(r){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=await this.getObjectSchema().apply("update",{...r.data},h,{...this.data});return this.update(r,m)}delete(r){return new this.constructor({_deleted:!0,...r||this.data},this.session,this.modelName)}async deleteTransformed(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=await this.getObjectSchema().apply("delete",{...this.data},r);return this.delete(h)}validate(){return this.schema.parse(this.data),this}serialize(){return JSON.stringify(this.data)}static getApiOptions(){throw Error("Derived class must implement getApiOptions")}static _newInstance(r,h){throw Error("Derived class must implement _newInstance.")}static unserialize(r,h){return this._newInstance(JSON.parse(r),h)}static load(r,h){return this._newInstance(r,h)}static sort(r,h,m){return r.sort((r,u)=>r[h]>u[h]?"asc"===m?1:-1:r[h]<u[h]?"asc"===m?-1:1:0)}getData(r){return{...this.getObjectSchema().applyGenerators(null!=r?r:this.data)}}constructor(r,h,m,f){var g,v;this.data=r,this.session=null!=m?m:(0,u.ed)(),this.schema=h,this.objectSchema=_.U.load(this.schema),this.modelName=null!==(g=null==f?void 0:f.toLowerCase())&&void 0!==g?g:"unknown";let w=this.objectSchema.is("id");w.getFields().length>1&&(w=w.isNot("fallbackId")),this.idField=null!==(v=w.getFirst("id"))&&void 0!==v?v:"id"}}class S extends w{static _newInstance(r,h){throw Error("Derived class must implement _newInstance.")}static createDerived(r,h,m,u){class _ extends S{static _newInstance(r,h){return new _(r,h)}static getApiOptions(){return{name:m,prefix:u}}constructor(m,u){super(m,h,u,r.substring(0,r.length-5).toLowerCase())}}return _.schemaInstance=h,Object.defineProperty(_,"name",{value:r,writable:!1}),_}constructor(r,h,m,u){super(r,h,m,u)}}},75620:function(r,h,m){"use strict";m.d(h,{Z:function(){return tG}});var u=m(52322),_=m(97729),f=m.n(_),g=m(6429),v=m(17793),w=m(1888),S=m(5632),E=m(25237),I=m.n(E),T=m(64509);let A=I()(()=>m.e(9481).then(m.bind(m,29481)),{loadableGenerated:{webpack:()=>[29481]},ssr:!1});function P(r){let{workspace:h,deviceDefinition:m,data:_,pageSession:w}=r,E=(0,S.useRouter)();(0,g.kP)(w);let{name:I}=E.query;return(0,u.jsxs)(T.US,{children:[(0,u.jsx)(f(),{children:(0,u.jsx)("title",{children:"Protofy - Admin Panel"})}),(0,u.jsx)(v.bR,{workspace:h,children:(0,u.jsx)(A,{deviceDefinition:m})})]})}let D=[{name:"Empty device",board:{name:"Protofy ESP32 devBoard",core:{id:"1",name:"esp32",sdks:["esphome"],config:{}},ports:[{number:1,side:"left",name:"3V3",type:"P",analog:!1,description:"3V3 Power supply",maxVoltage:3.3,rtc:!1},{number:2,side:"left",name:"EN",type:"I",analog:!1,description:"CHIP_PU, RESET",maxVoltage:3.3,rtc:!1},{number:3,side:"left",name:"36",type:"I",analog:!0,description:"GPIO36, ADC1_CH0, S_VP",maxVoltage:3.3,rtc:!0},{number:4,side:"left",name:"39",type:"I",analog:!0,description:"GPIO39, ADC1_CH3, S_VN",maxVoltage:3.3,rtc:!0},{number:5,side:"left",name:"34",type:"I",analog:!0,description:"GPIO34, ADC1_CH6, VDET_1",maxVoltage:3.3,rtc:!0},{number:6,side:"left",name:"35",type:"I",analog:!0,description:"GPIO35, ADC1_CH7, VDET_2",maxVoltage:3.3,rtc:!0},{number:7,side:"left",name:"32",type:"IO",analog:!0,description:"GPIO32, ADC1_CH4, TOUCH_CH9, XTAL_32K_P",maxVoltage:3.3,rtc:!0},{number:8,side:"left",name:"33",type:"IO",analog:!0,description:"GPIO33, ADC1_CH5, TOUCH_CH8, XTAL_32K_N",maxVoltage:3.3,rtc:!0},{number:9,side:"left",name:"25",type:"IO",analog:!0,description:"GPIO25, ADC1_CH8, DAC_1",maxVoltage:3.3,rtc:!0},{number:10,side:"left",name:"26",type:"IO",analog:!0,description:"GPIO26, ADC2_CH9, DAC_2",maxVoltage:3.3,rtc:!0},{number:11,side:"left",name:"27",type:"IO",analog:!0,description:"GPIO27, ADC2_CH7, TOUCH_CH7",maxVoltage:3.3,rtc:!0},{number:12,side:"left",name:"14",type:"IO",analog:!0,description:"GPIO14, ADC2_CH6, TOUCH_CH6, MTMS",maxVoltage:3.3,rtc:!0},{number:13,side:"left",name:"12",type:"IO",analog:!0,description:"GPIO12, ADC2_CH5, TOUCH_CH5, MTDI",maxVoltage:3.3,rtc:!0},{number:14,side:"left",name:"GND",type:"G",analog:!1,description:"Ground",maxVoltage:0,rtc:!1},{number:15,side:"left",name:"13",type:"IO",analog:!0,description:"GPIO13, ADC2_CH4, TOUCH_CH4, MTCK",maxVoltage:3.3,rtc:!0},{number:16,side:"left",name:"9",type:"IO",analog:!1,description:"GPIO9, D2",maxVoltage:3.3,rtc:!1},{number:17,side:"left",name:"10",type:"IO",analog:!1,description:"GPIO10, D3",maxVoltage:3.3,rtc:!1},{number:18,side:"left",name:"11",type:"IO",analog:!1,description:"GPIO11, CMD",maxVoltage:3.3,rtc:!1},{number:19,side:"left",name:"5V",type:"P",analog:!1,description:"5V Power supply",maxVoltage:5,rtc:!1},{number:1,side:"right",name:"GND",type:"G",analog:!1,description:"Ground",maxVoltage:0,rtc:!1},{number:2,side:"right",name:"23",type:"IO",analog:!1,description:"GPIO23",maxVoltage:3.3,rtc:!1},{number:3,side:"right",name:"22",type:"IO",analog:!1,description:"GPIO22",maxVoltage:3.3,rtc:!1},{number:4,side:"right",name:"TX",type:"IO",analog:!1,description:"GPIO1, U0TXD",maxVoltage:3.3,rtc:!1},{number:5,side:"right",name:"RX",type:"IO",analog:!1,description:"GPIO3, U0RXD",maxVoltage:3.3,rtc:!1},{number:6,side:"right",name:"21",type:"IO",analog:!1,description:"GPIO21",maxVoltage:3.3,rtc:!1},{number:7,side:"right",name:"GND",type:"GND",analog:!1,description:"Ground",maxVoltage:0,rtc:!1},{number:8,side:"right",name:"19",type:"IO",analog:!1,description:"GPIO19",maxVoltage:3.3,rtc:!1},{number:9,side:"right",name:"18",type:"IO",analog:!1,description:"GPIO18",maxVoltage:3.3,rtc:!1},{number:10,side:"right",name:"5",type:"IO",analog:!1,description:"GPIO5",maxVoltage:3.3,rtc:!1},{number:11,side:"right",name:"17",type:"IO",analog:!1,description:"GPIO17",maxVoltage:3.3,rtc:!1},{number:12,side:"right",name:"16",type:"IO",analog:!1,description:"GPIO16",maxVoltage:3.3,rtc:!1},{number:13,side:"right",name:"4",type:"IO",analog:!0,description:"GPIO4, ADC2_CH0, TOUCH_CH0",maxVoltage:3.3,rtc:!0},{number:14,side:"right",name:"0",type:"IO",analog:!0,description:"GPIO0, ADC2_CH1, TOUCH_CH1, Boot",maxVoltage:3.3,rtc:!0},{number:15,side:"right",name:"2",type:"IO",analog:!0,description:"GPIO2, ADC2_CH2, TOUCH_CH2",maxVoltage:3.3,rtc:!0},{number:16,side:"right",name:"15",type:"IO",analog:!0,description:"GPIO15, ADC2_CH3, TOUCH_CH3, MTDO",maxVoltage:3.3,rtc:!0},{number:17,side:"right",name:"8",type:"IO",analog:!1,description:"GPIO8, D1",maxVoltage:3.3,rtc:!1},{number:18,side:"right",name:"7",type:"IO",analog:!1,description:"GPIO7, D0",maxVoltage:3.3,rtc:!1},{number:19,side:"right",name:"CLK",type:"IO",analog:!1,description:"GPIO6, CLK",maxVoltage:3.3,rtc:!1}],config:{}},sdk:{name:"esphome"},subsystems:{},config:{mqttServer:{broker:"bo-firmware.protofy.xyz",port:1883,username:null,password:null,clientId:null,websocketEndpoint:"/ws",websocketProtocol:"ws"}},sdkConfig:{board:"esp32dev",framework:{type:"arduino"}}}],C=(0,w.F7)(async r=>(0,g.NA)(r,["admin"],{deviceDefinition:D}));var O=m(41585),R=m(57909),L=m(32627),N=m(30195),M=m(75370),F=m(54283);let q=M.V_.object({name:N.z.string().hint("ESP32, AT-MEGA2560  ARMv7, Protofy, ...").static().id(),sdks:N.z.array(N.z.string()).hint("esphome, platformio, wled, javascript, ...").hidden(),config:N.z.record(N.z.string(),N.z.string()).generate(()=>({}))}),G=F.$.createDerived("DeviceCoreModel",q);var H=m(6289),U=m(26887),z=m(48115),B=m(40214),V=m(13997),W=m(50897),Z=m(79562),K=m(6364);let $=M.V_.object({id:N.z.string().generate((0,K.Z)()).id(),name:N.z.string().hint("MicroPython, Platformio...").static()}),X=F.$.createDerived("DeviceSdkModel",$);var J=m(2784);let Y={name:L.V,sdk:R.S},Q="/adminapi/v1/devicecores",tt="/adminapi/v1/devicesdks?all=1";var te={component:r=>{var h;let{pageState:m,initialItems:_,itemData:f,pageSession:g,extraData:v}=r,[w,S]=(0,J.useState)(null!==(h=null==v?void 0:v.sdks)&&void 0!==h?h:(0,H.E)("pending"));return(0,U.a)(r=>{z.bl.get({url:tt},r)},S,null==v?void 0:v.cores),(0,u.jsx)(B.D,{title:"Device Cores",pageSession:g,children:(0,u.jsx)(V.V,{integratedChat:!0,itemData:f,rowIcon:O.x,sourceUrl:Q,initialItems:_,numColumnsForm:1,entityName:"devicecores",name:"core",onAdd:r=>r,onEdit:r=>r,columns:W.Z.columns(W.Z.column("name","name",!0),W.Z.column("sdk","sdk",!0,r=>{var h;return(0,u.jsx)("div",{style:{gap:"5px",display:"flex",flexDirection:"row"},children:null===(h=r.sdks)||void 0===h?void 0:h.map(r=>(0,u.jsx)(Z.A,{text:r,color:"$gray5"}))})})),extraFieldsForms:{sdks:N.z.array(N.z.union([N.z.literal(""),N.z.literal("")])).generateOptions(()=>w.isLoaded?w.data.items.map(r=>X.load(r).getData()).map(r=>r.name):[]).after("name").display()},model:G,pageState:m,icons:Y,dataTableGridProps:{itemMinWidth:300,spacing:20}})})},getServerSideProps:(0,w.eq)(Q,["admin"],{},async()=>({sdks:await z.bl.get(tt)}))},tn=m(66132);let ti=M.V_.object({name:N.z.string().hint("ESP32S3, CHUWI, Arduino UNO...").static().id(),core:N.z.string().hidden(),ports:N.z.array(N.z.record(N.z.string(),N.z.any())),config:N.z.record(N.z.string(),N.z.any())}),ta=F.$.createDerived("DeviceBoardModel",ti),ts={name:L.V,core:R.S},tr="/adminapi/v1/deviceboards",to="/adminapi/v1/devicecores?all=1";var tc={component:r=>{var h;let{pageState:m,initialItems:_,itemData:f,pageSession:g,extraData:v}=r,[w,S]=(0,J.useState)(null!==(h=null==v?void 0:v.cores)&&void 0!==h?h:(0,H.E)("pending"));return(0,U.a)(r=>{z.bl.get({url:to},r)},S,null==v?void 0:v.cores),(0,u.jsx)(B.D,{title:"Device Boards",pageSession:g,children:(0,u.jsx)(V.V,{integratedChat:!0,entityName:"deviceboards",itemData:f,rowIcon:tn.b,sourceUrl:tr,initialItems:_,numColumnsForm:1,name:"board",onAdd:r=>r,onEdit:r=>r,columns:W.Z.columns(W.Z.column("name","name",!0),W.Z.column("core","core",!0,r=>(0,u.jsx)(Z.A,{text:r.core,color:"$gray5"})),W.Z.column("ports","ports",!0,r=>(0,u.jsx)(Z.A,{text:Object.keys(r.ports).length,color:"$gray5"}))),extraFieldsForms:{core:N.z.union(w.isLoaded?w.data.items.map(r=>N.z.literal(G.load(r).getId())):[]).after("name")},model:ta,pageState:m,icons:ts,dataTableGridProps:{itemMinWidth:300,spacing:20}})})},getServerSideProps:(0,w.eq)(tr,["admin"],{},async()=>({cores:await z.bl.get(to)}))},tl=m(40198),td=m(39608),th=m(74705),tm=m(51813),tp=m(71932),tu=m(66306),t_=m(16399),tf=m(28554),tg=m(66194),ty=m(96325),tb=m.n(ty);function tv(r){var h;return Object.keys(r).forEach(m=>{r[m]._devicePositioning&&(h={id:m,...r[m]})}),h}function tw(r,h){let m=r.filter(r=>r.source==h);return m[0]}let tS={"elk.algorithm":"layered","elk.layered.considerModelOrder.strategy":"NODES_AND_EDGES","elk.hierarchyHandling":"SEPARATE_CHILDREN","elk.layered.crossingMinimization.forceNodeModelOrder":!0,"elk.layered.crossingMinimization.strategy":"LAYER_SWEEP","elk.layered.spacing.nodeNodeBetweenLayers":"150","elk.spacing.nodeNode":"100"},tx=function(r){var h;arguments.length>1&&void 0!==arguments[1]&&arguments[1];let m=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0;return{layoutOptions:(null===(h=r.children)||void 0===h?void 0:h.length)?tS:{},id:r.id,width:r.width,height:r.height,children:r.children?r.children.map((r,h)=>tx(r,h,m,u)):[]}},tE=(r,h,m,u)=>{var _=u;let f=tv(h);if(r.id!=(null==f?void 0:f.id)){let h=tw(m,r.id);_=f._devicePositioning.filter(r=>{if(r)return r.includes(h.targetHandle.split("element-")[1])})[0].split("-")[1]}return _},tI=(r,h,m,u,_)=>{let f=h.filter(h=>tE(h,m,u,r)==r).map(r=>tx(r,0,u,m)),g={id:"root",layoutOptions:{...tS,"elk.direction":"l"==r?"LEFT":"RIGHT"},children:f,edges:u.filter(r=>f.find(h=>h.id==r.source)&&f.find(h=>h.id==r.target)&&_.find(h=>h&&h.id==r.source)&&_.find(h=>h&&h.id==r.target)).sort((r,h)=>{let m=r.targetHandle.split("_"),u=h.targetHandle.split("_"),_=m[m.length-1],f=u[u.length-1];if(_.startsWith("block")&&f.startsWith("block")&&r.target==h.target){let r=parseInt(_.substr(5),10),h=parseInt(f.substr(5),10);return r-h}return 0}).map((r,h)=>({id:r.id,sources:[r.source],targets:[r.target]}))};return g},tT=async(r,h,m,u)=>{let _=new(tb()),f=r=>{let m=[],u=(r,_)=>{let f={...r,data:{...r.data}};if(delete f.children,_&&(f.parentNode=_),m.push(f),r.children&&r.children.length){let m=h.find(h=>h.source==r.children[0].id);if(m){let u=JSON.parse(JSON.stringify(m));u.source=r.id,u.sourceHandle=r.id+"-output",h.push(u)}r.children.forEach(h=>u(h,r.id))}};return r.forEach(r=>u(r,null)),m},g=f(r),v=tI("l",r,u,h,g),w=tI("r",r,u,h,g);try{await _.layout(v),await _.layout(w)}catch(r){console.error("Error in layout: ",r)}var S={};let E=(r,h,u)=>r.forEach(r=>{let _=g.find(h=>h.id==r.id);if(_){S[_.id]={layouted:!0,outputPos:u};let f=r.x-h,g=r.y;_.position={x:_.id==m.id?0:f,y:_.id==m.id?0:g},r.children&&r.children.length&&(_.data.height=r.height,_.data.width=r.width)}r&&r.children&&E(r.children,h,u)}),I=w.children.reduce((r,h)=>Math.max(h.x+h.width-150,r),0);return E(w.children,I,"right"),E(v.children,-150,"left"),{nodes:g,edges:h,metadata:S}};var tA=tT;let tP="  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _fs-1 _fg-1 _miw-10037 ",tD={name:L.V,board:tn.b},tC="/adminapi/v1/devicedefinitions",tO="/adminapi/v1/deviceboards?all=1",tR="/adminapi/v1/devicecores?all=1";var tk={component:r=>{var h,m;let{workspace:_,pageState:f,initialItems:g,itemData:v,pageSession:w,extraData:E}=r,[I,T]=J.useState(!1),{resolvedTheme:A}=(0,t_.P)(),P={components:'[\n "mydevice",\n "esp32dev",\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n null,\n];\n\n'},[D,C]=(0,J.useState)(P.components),[O,R]=J.useState({}),L=(0,S.useRouter)(),[M,F]=(0,J.useState)(null!==(h=null==E?void 0:E.boards)&&void 0!==h?h:(0,H.E)("pending"));(0,U.a)(r=>{z.bl.get({url:tO},r)},F,null==E?void 0:E.deviceDefinitions);let q=M.isLoaded?M.data.items.map(r=>ta.load(r).getData()):[],[K,$]=(0,J.useState)(null!==(m=null==E?void 0:E.cores)&&void 0!==m?m:(0,H.E)("pending"));(0,U.a)(r=>{z.bl.get({url:tR},r)},$,null==E?void 0:E.cores);let X=K.isLoaded?K.data.items.map(r=>G.load(r).getData()):[];return(0,u.jsxs)(B.D,{title:"Device Definitions",workspace:_,pageSession:w,children:[(0,u.jsx)(tm.a,{open:I,setOpen:r=>{T(r)},hideAccept:!0,style:{width:"80%",height:"80%",padding:"0px",overflow:"hidden"},children:(0,u.jsx)("div",{className:tP,children:(0,u.jsx)(tf.Z,{style:{width:"100%"},disableDots:!1,hideBaseComponents:!0,disableStart:!0,autoFitView:!0,getFirstNode:r=>r.find(r=>"ArrayLiteralExpression"==r.type),showActionsBar:!1,layout:tA,customComponents:(0,tg.B)(L.pathname,L.query),bridgeNode:!1,setSourceCode:r=>{console.log("set new sourcecode from flows: ",r),C(r)},sourceCode:D,themeMode:A,config:{masks:(0,tg.W)(L.pathname,L.query),layers:[]},bgColor:"transparent",dataNotify:r=>{r.notifyId},onEdit:r=>O.setData({components:r,sdkConfig:{board:"esp32dev",framework:{type:"arduino"}}}),positions:[],disableSideBar:!0,display:!0,flowId:"flows-editor"},"flow")})}),(0,u.jsx)(V.V,{integratedChat:!0,entityName:"devicedefinitions",itemData:v,rowIcon:tl.p,sourceUrl:tC,initialItems:g,numColumnsForm:1,name:"Definition",onAdd:r=>(console.log("DATA (onAdd): ",r),r),onEdit:r=>(console.log("DATA (onEdit): ",r),r),columns:W.Z.columns(W.Z.column("",()=>"",!0,r=>(0,u.jsx)(tp.z,{onPress:async h=>{T(!0),C(r.config.components)},Icon:td.b}),!0,"50px"),W.Z.column("name",r=>r.name,!0),W.Z.column("board",r=>r.board,!0,r=>(0,u.jsx)(Z.A,{text:r.board,color:"$gray5"})),W.Z.column("sdk",r=>r.sdk,!0,r=>(0,u.jsx)(Z.A,{text:r.sdk,color:"$gray5"}))),extraFieldsForms:{board:N.z.union(q.map(r=>N.z.literal(r.name))).after("name"),sdk:N.z.union([N.z.any(),N.z.any()]).dependsOn("board").generateOptions(r=>{if(r.board){let h=q.find(h=>h.name===r.board);return X.find(r=>r.name===h.core).sdks}return[]}).after("name")},model:th.q,pageState:f,icons:tD,dataTableGridProps:{itemMinWidth:300,spacing:20},customFields:{config:{component:(r,h,m,_)=>"preview"==_?(0,u.jsx)(u.Fragment,{}):(0,u.jsx)(tu.zx,{style:{width:"100%"},onPress:u=>{T(!0),"add"==_?C(P.components):C(h.components),R({path:r,data:h,setData:m,mode:_})},children:"Edit"}),hideLabel:!1}}})]})},getServerSideProps:(0,w.eq)(tC,["admin"],{},async()=>({boards:await z.bl.get(tO),cores:await z.bl.get(tR)}))};m(76649);var tL=m(65704),tN=m(32878);let tM={name:L.V,sdk:R.S},tF="/adminapi/v1/devicesdks";var tq={component:r=>{let{pageState:h,initialItems:m,itemData:_,pageSession:f}=r;return(0,u.jsx)(B.D,{title:"Device Sdks",pageSession:f,children:(0,u.jsx)(V.V,{integratedChat:!0,entityName:"devicesdks",itemData:_,rowIcon:tN.E,sourceUrl:tF,initialItems:m,numColumnsForm:1,name:"Sdk",onAdd:r=>r,onEdit:r=>r,columns:W.Z.columns(W.Z.column("id","id",!0),W.Z.column("name","name",!0)),model:X,pageState:h,icons:tM,dataTableGridProps:{itemMinWidth:300,spacing:20}})})},getServerSideProps:(0,w.eq)(tF,["admin"])},tG={"device-test/**":{component:P,getServerSideProps:C},"devices/**":tL.Z,"deviceSdks/**":tq,"deviceCores/**":te,"deviceBoards/**":tc,"deviceDefinitions/**":tk}},74705:function(r,h,m){"use strict";m.d(h,{q:function(){return v}});var u=m(30195),_=m(75370),f=m(54283);let g=_.V_.object({name:u.z.string().hint("Protofy screen controller...").static().id(),board:u.z.string().hidden(),sdk:u.z.string().hidden(),subsystems:u.z.record(u.z.string(),u.z.any()).optional(),config:u.z.record(u.z.string(),u.z.any())}),v=f.$.createDerived("DeviceDefinitionModel",g)},11010:function(r,h,m){"use strict";let u;m.d(h,{$:function(){return I},K:function(){return T}});var _=m(3089),f=m(58895),g=m(5436),v=m(71155),w=m(36076);let S="https://firmware.protofy.xyz/api/v1",E=async r=>{await r.device.setSignals({dataTerminalReady:!1,requestToSend:!0}),await r.device.setSignals({dataTerminalReady:!1,requestToSend:!1})},I=async()=>{let r=!0;try{u=await navigator.serial.requestPort()}catch(h){return h.name,r}if(!u)return r;try{await u.open({baudRate:115200})}catch(h){return r}},T=async r=>{let h,m;r({message:'Please hold "Boot" button of your ESP32 board.'});let I=new _.J(u),T=new f.p(I,115200,void 0);await u.close(),window.esploader=T;try{await T.main_fn()}catch(h){throw console.error(h),r({message:"Failed to initialize. Try resetting your device or holding the BOOT button while clicking INSTALL.",details:{error:v.g.FAILED_INITIALIZING,details:h}}),await E(I),await I.disconnect(),"Failed to initialize. Try resetting your device or holding the BOOT button while clicking INSTALL."}if(console.log("chipFamily: ",m=T.chip.CHIP_NAME),!T.chip.ROM_TEXT)throw r({message:"Chip ".concat(m," is not supported"),details:{error:v.g.NOT_SUPPORTED,details:"Chip ".concat(m," is not supported")}}),await E(I),await I.disconnect(),"Chip ".concat(m," is not supported");if(r({message:"Initialized. Found ".concat(m),details:{done:!0}}),!(h=w.I.builds.find(r=>r.chipFamily===m)))throw r({message:"Your ".concat(m," board is not supported."),details:{error:v.g.NOT_SUPPORTED,details:m}}),await E(I),await I.disconnect(),"Your ".concat(m," board is not supported.");r({message:"Preparing installation...",details:{done:!1}});let A=h.parts.map(async r=>{let h=S+"/device/download?configuration=test.yaml&type=firmware-factory.bin",m=await fetch(h);if(!m.ok)throw Error("Downlading firmware ".concat(h," failed: ").concat(m.status));let u=new FileReader,_=await m.blob();return new Promise(r=>{u.addEventListener("load",()=>r(u.result)),u.readAsBinaryString(_)})}),P=[],D=0;for(let m=0;m<A.length;m++)try{let r=await A[m];P.push({data:r,address:h.parts[m].offset}),D+=r.length}catch(h){r({message:h.message,details:{error:v.g.FAILED_FIRMWARE_DOWNLOAD,details:h.message}}),await E(I),await I.disconnect();return}r({message:"Installation prepared",details:{done:!0}}),r({message:"Erasing device...",details:{done:!1}}),await T.erase_flash(),r({message:"Device erased",details:{done:!0}}),r({message:"Writing progress: 0%",details:{bytesTotal:D,bytesWritten:0,percentage:0}});let C=0;try{await T.write_flash(P,"keep","keep","keep",!1,!0,(h,m,u)=>{let _=m/u*P[h].data.length,f=Math.floor((C+_)/D*100);if(m===u){C+=_;return}r({message:"Writing progress: ".concat(f,"%"),details:{bytesTotal:D,bytesWritten:C+m,percentage:f}})})}catch(h){r({message:h.message,details:{error:v.g.WRITE_FAILED,details:h}}),await E(I),await I.disconnect();return}r({message:"Writing complete",details:{bytesTotal:D,bytesWritten:C,percentage:100}}),await (0,g._)(100),console.log("HARD RESET"),await E(I),console.log("DISCONNECT"),await I.disconnect(),r({message:"All done!"})}},65704:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(52322),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2784),_tamagui_lucide_icons_dist_esm_icons_book_open__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(40198),_tamagui_lucide_icons_dist_esm_icons_tag__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(32627),_tamagui_lucide_icons_dist_esm_icons_router__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(15230),_devicesSchemas__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(1940),protolib__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(48115),protolib__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(26887),protolib__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(40214),protolib__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(13997),protolib__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(50897),protolib__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(62962),protolib__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(19252),protolib__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(96455),protolib_base__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(30195),_deviceDefinitions__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(74705),_devicesUtils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(11010),mqtt_react_hooks__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(39684),protodevice_src_DeviceModal__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(6873),protodevice_src_device__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(93917),protodevice_src_Subsystem__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(84536),_my_ui__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(75296),protolib_base__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(6289),_tamagui_lucide_icons_dist_esm_icons_pencil__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(89560),_tamagui_lucide_icons_dist_esm_icons_upload_cloud__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(7244),_next__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(82695);let _cn5="  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 ",_cn4="  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _mih-0px _miw-0px _fs-0 _r-20px _t-20px _pos-absolute ",_cn3="  is_Paragraph _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _col-312414369 _ff-299667014 _fow-233016140 _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto font_body ",_cn2="  is_Paragraph _dsp-inline _bxs-border-box _ww-break-word _mt-1481558152 _mr-0px _mb-0px _ml-0px _col-312414369 _ff-299667014 _fow-233016140 _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto font_body ",_cn="  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 _h-10037 ",MqttTest=r=>{let{onSetStage:h,onSetModalFeedback:m}=r,{message:u}=(0,mqtt_react_hooks__WEBPACK_IMPORTED_MODULE_2__.mU)(["device/compile"]),[_,f]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{console.log("Compile Message: ",u);try{if(null==u?void 0:u.message){let r=JSON.parse(null==u?void 0:u.message.toString());"exit"==r.event&&0==r.code?(f([]),console.log("Succesfully compiled"),h("upload")):"exit"==r.event&&0!=r.code&&(console.error("Error compiling",_),m({message:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:_cn,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:_cn2,children:"Error compiling code."}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:_cn3,children:"Please check your flow configuration."}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_my_ui__WEBPACK_IMPORTED_MODULE_3__.K,{textAlign:"left",f:1,mt:"$2",mb:"$5",children:_.map(r=>r.data).join("")})]}),details:{error:!0}})),f([..._,r])}}catch(r){console.log(r)}},[u]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{})},DevicesIcons={name:_tamagui_lucide_icons_dist_esm_icons_tag__WEBPACK_IMPORTED_MODULE_4__.V,deviceDefinition:_tamagui_lucide_icons_dist_esm_icons_book_open__WEBPACK_IMPORTED_MODULE_5__.p},callText=async(r,h,m,u)=>{var _={method:h,headers:{"Content-Type":"text/plain;charset=UTF-8"}};m&&(_.body=m);let f="?";-1!=r.indexOf("?")&&(f="&");var g=r+(u?f+"token="+u:"");return console.log("Deff URL: ",g),fetch(g,_).then(function(r){return 200==r.status?"ok":(console.log(r.status),r.ok,r)})},sourceUrl="/adminapi/v1/devices",definitionsSourceUrl="/adminapi/v1/deviceDefinitions?all=1";__webpack_exports__.Z={component:param=>{var _extraData_deviceDefinitions;let{pageState,initialItems,itemData,pageSession,extraData}=param,{replace}=(0,_next__WEBPACK_IMPORTED_MODULE_6__.N)(pageState);Object.keys(protodevice_src_device__WEBPACK_IMPORTED_MODULE_7__.Z).forEach(r=>window[r]=protodevice_src_device__WEBPACK_IMPORTED_MODULE_7__.Z[r]);let[showModal,setShowModal]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),[modalFeedback,setModalFeedback]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(),[stage,setStage]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(""),yamlRef=react__WEBPACK_IMPORTED_MODULE_1__.useRef(),flashDevice=async(deviceName,deviceDefinitionId)=>{console.log("Flash device: ",{deviceName,deviceDefinitionId});let response=await protolib__WEBPACK_IMPORTED_MODULE_8__.bl.get("/adminapi/v1/deviceDefinitions/"+deviceDefinitionId);if(response.isError){alert(response.error);return}let deviceDefinition=response.data,response1=await protolib__WEBPACK_IMPORTED_MODULE_8__.bl.get("/adminapi/v1/deviceBoards/"+deviceDefinition.board);if(response1.isError){alert(response1.error);return}console.log("---------deviceDefinition----------",deviceDefinition),deviceDefinition.board=response1.data;let jsCode=deviceDefinition.config.components,deviceCode="device("+jsCode+")";console.log("-------DEVICE CODE------------",deviceCode);let deviceObj=eval(deviceCode.replace(/;/g,"")),componentsTree=deviceObj.getComponentsTree(deviceName,deviceDefinition),yaml=deviceObj.dump("yaml"),subsystems=deviceObj.getSubsystemsTree(deviceName,deviceDefinition),deviceObject=await protolib__WEBPACK_IMPORTED_MODULE_8__.bl.get("/adminapi/v1/devices/"+deviceName);if(await protolib__WEBPACK_IMPORTED_MODULE_8__.bl.post("/adminapi/v1/devices/"+deviceName+"/yamls",{yaml}),deviceObject.isError){alert(deviceObject.error);return}deviceObject.data.subsystem=subsystems,protolib__WEBPACK_IMPORTED_MODULE_8__.bl.post("/adminapi/v1/devices/"+deviceName,deviceObject.data),console.log("ComponentsTree: ",componentsTree),console.log("Subsystems: ",subsystems),yamlRef.current=yaml,setShowModal(!0);try{setStage("yaml")}catch(e){console.error("error writting firmware: ",e)}},sendMessage=async r=>{await fetch("https://firmware.protofy.xyz/api/v1/device/compile")},compile=async()=>{setModalFeedback({message:"Compiling firmware...",details:{error:!1}});let r={type:"spawn",configuration:"test.yaml"};sendMessage(JSON.stringify(r))},flashCb=r=>{console.log(r),setModalFeedback(h=>h=r)},onSelectPort=async()=>{let r=await (0,_devicesUtils__WEBPACK_IMPORTED_MODULE_9__.$)();r||setStage("write")},saveYaml=async r=>{console.log("Save Yaml"),console.log(await callText("https://firmware.protofy.xyz/api/v1/device/edit?configuration=test.yaml","POST",r))};(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{let r=async()=>{if("yaml"==stage)await saveYaml(yamlRef.current),setStage("compile");else if("compile"==stage)console.log("stage - compile"),await compile();else if("write"==stage)try{await (0,_devicesUtils__WEBPACK_IMPORTED_MODULE_9__.K)(flashCb),setStage("idle")}catch(r){flashCb({message:"Error writing the device. Check that the USB connection and serial port are correctly configured.",details:{error:!0}})}else if("upload"==stage){let r=navigator.userAgent.includes("Chrome")||navigator.userAgent.includes("Edge")||navigator.userAgent.includes("Opera");r?(setModalFeedback({message:"Connect your device and click select to chose the port. ",details:{error:!1}}),console.log("chormium based true")):(console.log("chormium based very false"),setModalFeedback({message:"You need Chrome, Opera or Edge to upload the code to the device.",details:{error:!0}}))}};r()},[stage]);let[deviceDefinitions,setDeviceDefinitions]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null!==(_extraData_deviceDefinitions=null==extraData?void 0:extraData.deviceDefinitions)&&void 0!==_extraData_deviceDefinitions?_extraData_deviceDefinitions:(0,protolib_base__WEBPACK_IMPORTED_MODULE_10__.E)("pending"));(0,protolib__WEBPACK_IMPORTED_MODULE_11__.a)(r=>{protolib__WEBPACK_IMPORTED_MODULE_8__.bl.get({url:definitionsSourceUrl},r)},setDeviceDefinitions,null==extraData?void 0:extraData.deviceDefinitions);let extraMenuActions=[{text:"Edit config file",icon:_tamagui_lucide_icons_dist_esm_icons_pencil__WEBPACK_IMPORTED_MODULE_12__.z,action:r=>{replace("editFile",r.getConfigFile())},isVisible:r=>r.isInitialized()&&r.getConfigFile()},{text:"Upload",icon:_tamagui_lucide_icons_dist_esm_icons_upload_cloud__WEBPACK_IMPORTED_MODULE_13__.W,action:r=>{flashDevice(r.data.name,r.data.deviceDefinition)},isVisible:r=>!0}];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(protolib__WEBPACK_IMPORTED_MODULE_14__.D,{title:"Devices",pageSession:pageSession,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(mqtt_react_hooks__WEBPACK_IMPORTED_MODULE_2__.wR,{brokerUrl:"wss://firmware.protofy.xyz/ws",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(protodevice_src_DeviceModal__WEBPACK_IMPORTED_MODULE_15__.Z,{stage:stage,onCancel:()=>setShowModal(!1),onSelect:onSelectPort,modalFeedback:modalFeedback,showModal:showModal}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(MqttTest,{onSetStage:r=>setStage(r),onSetModalFeedback:r=>setModalFeedback(r)})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(protolib__WEBPACK_IMPORTED_MODULE_16__.V,{defaultView:"grid",integratedChat:!0,itemData:itemData,rowIcon:_tamagui_lucide_icons_dist_esm_icons_router__WEBPACK_IMPORTED_MODULE_17__.F,sourceUrl:sourceUrl,initialItems:initialItems,name:"device",columns:protolib__WEBPACK_IMPORTED_MODULE_18__.Z.columns(protolib__WEBPACK_IMPORTED_MODULE_18__.Z.column("name","name",!0),protolib__WEBPACK_IMPORTED_MODULE_18__.Z.column("device definition","deviceDefinition",!0),protolib__WEBPACK_IMPORTED_MODULE_18__.Z.column("config","config",!1,r=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(protolib__WEBPACK_IMPORTED_MODULE_19__.Z,{onPress:h=>{flashDevice(r.name,r.deviceDefinition)},children:"Upload"}))),extraFieldsForms:{deviceDefinition:protolib_base__WEBPACK_IMPORTED_MODULE_20__.z.union(deviceDefinitions.isLoaded?deviceDefinitions.data.items.map(r=>protolib_base__WEBPACK_IMPORTED_MODULE_20__.z.literal(_deviceDefinitions__WEBPACK_IMPORTED_MODULE_21__.q.load(r).getId())):[]).after("name")},model:_devicesSchemas__WEBPACK_IMPORTED_MODULE_22__.O7,pageState:pageState,icons:DevicesIcons,dataTableGridProps:{disableItemSelection:!0,onSelectItem:r=>{},getBody:r=>{var h;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(protolib__WEBPACK_IMPORTED_MODULE_23__.e,{title:r.name,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:_cn4,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(protolib__WEBPACK_IMPORTED_MODULE_24__.o,{type:"item",sourceUrl:sourceUrl,onDelete:async r=>{await protolib__WEBPACK_IMPORTED_MODULE_8__.bl.get(r+"/delete")},deleteable:()=>!0,element:_devicesSchemas__WEBPACK_IMPORTED_MODULE_22__.O7.load(r),extraMenuActions:extraMenuActions})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:_cn5,children:null==r?void 0:null===(h=r.subsystem)||void 0===h?void 0:h.map(h=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(protodevice_src_Subsystem__WEBPACK_IMPORTED_MODULE_25__.Z,{subsystem:h,deviceName:r.name}))})]})}},extraMenuActions:extraMenuActions})]})}},__webpack_require__(79897)},1940:function(r,h,m){"use strict";m.d(h,{Hj:function(){return A},O7:function(){return T},zm:function(){return E}});var u=m(30195),_=m(75370),f=m(54283),g=m(15153),v=m.n(g);let w=_.V_.object({name:u.z.string().hint("Device name").static().regex(/^[a-z0-9A-Z]+$/,"Only lower case chars or numbers").id().search(),deviceDefinition:u.z.string().hidden(),substitutions:u.z.record(u.z.string().optional(),u.z.any().optional()).optional().hidden(),subsystem:u.z.record(u.z.string(),u.z.any()).optional().hidden(),data:u.z.array(u.z.record(u.z.string(),u.z.any())).optional().hidden(),currentSdk:u.z.string().hidden().generate("esphome"),location:u.z.object({lat:u.z.string(),long:u.z.string()}).optional().location("lat","long").hidden()});class S{getEndpoint(){return A(this.device,this.data.endpoint)}getValue(){return this.data.payload.value}constructor(r,h,m){this.data=m,this.device=r,this.subsystem=h}}class E{getEndpoint(){return A(this.device,this.data.endpoint)}getEventPath(){return this.getEndpoint().split("/").slice(-3).join("/")}getLabel(){var r;return null!==(r=this.data.label)&&void 0!==r?r:this.data.name}getUnits(){return this.data.units?this.data.units:""}getValueAPIURL(){return"/adminapi/v1/devices/"+this.device+"/subsystems/"+this.subsystem+"/monitors/"+this.data.name}constructor(r,h,m){this.data=m,this.device=r,this.subsystem=h}}class I{getAction(r){if(!this.data||!this.data.actions)return;let h=this.data.actions.find(h=>h.name==r);if(h)return new S(this.device,r,h)}getMonitor(r){if(!this.data||!this.data.monitors)return;let h=this.data.monitors.find(h=>h.name==r);if(h)return new E(this.device,r,h)}constructor(r,h){this.data=h,this.device=r}}class T extends f.J{static getApiOptions(){return{name:"devices",prefix:"/api/v1/"}}isInitialized(){var r;return null!==(r=this.data)&&void 0!==r&&!!r.subsystem}getConfigDir(){var r;return"data/devices/"+(null===(r=this.data)||void 0===r?void 0:r.name)}getConfigFile(){var r;if((null===(r=this.data)||void 0===r?void 0:r.currentSdk)=="esphome")return v().join(this.getConfigDir(),"config.yaml")}getSubsystem(r){if(!this.data||!this.data.subsystem)return;let h=this.data.subsystem.find(h=>h.name==r);if(h)return new I(this.data.name,h)}create(r){let h=super.create(r);return h}read(r){let h=super.read(r);return h}update(r,h){let m=super.update(r,h);return m}list(r,h,m,u){let _=super.list(r,h,m,u);return _}delete(r){let h=super.delete(r);return h}static _newInstance(r,h){return new T(r,h)}static load(r,h){return this._newInstance(r,h)}constructor(r,h){super(r,w,h,"Test")}}let A=function(r){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"devices/"+r+h}},62962:function(r,h,m){"use strict";var u=m(52322),_=m(66306),f=m(52026),g=m(2784);let v=g.forwardRef((r,h)=>{let{textColor:m,fontFamily:g="$silkscreen",...v}=r;return(0,u.jsx)(_.zx,{ref:h,borderRadius:"$10",size:"$3",elevate:!0,space:"$3",...v,children:(0,u.jsx)(f.Text,{color:m,fontFamily:g,display:"flex",alignItems:"center",children:v.children})})});h.Z=v},19252:function(r,h,m){"use strict";m.d(h,{e:function(){return v}});var u=m(52322),_=m(91838);let f="  is_Paragraph _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-20px _mr-0px _mb-0px _ml-20px _ff-299667014 _fow-233016233 _ls-167744152 _fos-229441313 _lh-222976666 _ussel-auto font_body ",g="  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _pr-1481558214 _pl-1481558214 _pb-1316330238 _fg-1 ",v=r=>{let{title:h,children:m}=r;return(0,u.jsx)("div",{className:g,children:(0,u.jsxs)(_.I,{children:[(0,u.jsx)("p",{className:f,children:h}),m]})})};m(47533)},1888:function(r,h,m){"use strict";m.d(h,{F7:function(){return g},eq:function(){return v}});var u=m(46149),_=m(6429),f=m(48115);let g=r=>u.l.SSR?r:void 0;function v(r,h){let m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return g(async g=>{var v,w,S,E,I,T;let A={itemsPerPage:parseInt(g.query.itemsPerPage)?parseInt(g.query.itemsPerPage):"",page:parseInt(g.query.page,10)?parseInt(g.query.page,10):"",search:null!==(v=g.query.search)&&void 0!==v?v:"",orderBy:null!==(w=g.query.orderBy)&&void 0!==w?w:"",orderDirection:null!==(S=g.query.orderDirection)&&void 0!==S?S:"",view:null!==(E=g.query.view)&&void 0!==E?E:"",item:null!==(I=g.query.item)&&void 0!==I?I:"",editFile:null!==(T=g.query.editFile)&&void 0!==T?T:"",..."function"==typeof m?await m(g):m},P="function"==typeof r?r(g):r;return(0,_.NA)(g,h,{sourceUrl:P,initialItems:await f.bl.get({url:(0,_.VM)(P,g),...A}),itemData:g.query.item?await f.bl.get((0,_.VM)(P+"/"+g.query.item,g)):"",extraData:{..."function"==typeof u?await u(g):u},pageState:{...A}})})}},6873:function(r,h,m){"use strict";m.d(h,{Z:function(){return P}});var u=m(52322),_=m(2784),f={src:"/admin/_next/static/media/protofitoCompiling.7548c399.gif"},g={src:"/admin/_next/static/media/protofitoCompilingW.1d28e002.gif"},v={src:"/admin/_next/static/media/protofitoLoading.b3d41156.gif"},w={src:"/admin/_next/static/media/protofitoLoadingW.a84348f3.gif"},S={src:"/admin/_next/static/media/protofitoDancing.5a429207.gif"},E={src:"/admin/_next/static/media/protofitoDancingW.fa27d98c.gif"},I=m(51813),T=m(52026);let A=r=>{var h,m;let{stage:A,onCancel:P,onSelect:D,showModal:C,modalFeedback:O}=r,R=null==O?void 0:null===(h=O.details)||void 0===h?void 0:h.error,L=["write"].includes(A)&&!R&&!(null==O?void 0:null===(m=O.message)||void 0===m?void 0:m.includes('Please hold "Boot"'));L||["idle","compile"].includes(A);let N=(0,T.useThemeName)(),M={yaml:"Uploading yaml to the project...",compile:"Compiling firmware...",upload:"Connect your device and click select to chose the port. ",write:"Writting firmware to device. Please do not unplug your device.",idle:"Device configured successfully. You can unplug your device."},[F,q]=_.useState(M[A]),G=()=>"upload"===A&&!R&&(0,u.jsx)("div",{style:{textAlign:"center",color:R?"red":"",marginTop:R?"80px":"",marginBottom:"0px"},children:(0,u.jsxs)(u.Fragment,{children:["If you don't see your device on the menu, download device drivers on",(0,u.jsx)("a",{href:"https://www.silabs.com/documents/public/software/CP210x_Windows_Drivers.zip",target:"_blank",style:{paddingLeft:"5px"},children:"Windows"}),",",(0,u.jsx)("a",{href:"https://www.silabs.com/documents/public/software/Mac_OSX_VCP_Driver.zip",target:"_blank",style:{paddingInline:"5px"},children:"Mac"}),"or ",(0,u.jsx)("a",{href:"https://www.silabs.com/developers/usb-to-uart-bridge-vcp-drivers?tab=downloads",target:"_blank",children:"other OS"})]})}),H={compile:"1",upload:"2",write:"3",idle:"4"};return(0,u.jsx)(I.a,{open:C,hideAccept:!0,children:(0,u.jsxs)("div",{style:{height:"350px",width:"400px",position:"relative",overflow:"visible",justifyContent:"space-between",display:"flex",flexDirection:"column"},children:[(0,u.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[(0,u.jsx)("div",{style:{textAlign:"center",fontWeight:"bold",fontSize:"xs"},children:"[".concat(H[A],"/").concat(Object.keys(H).length,"]")}),(0,u.jsx)("div",{style:{flexGrow:1,textAlign:"center",color:R?"red":"",marginBottom:"0px",marginTop:"2"===H[A]?"100px":"0px"},children:O&&["write","compile","upload"].includes(A)?O.message:F}),(0,u.jsx)(G,{})]}),L?(0,u.jsx)("img",{alt:"protofito loading",style:{height:"160px",width:"300px",alignSelf:"center",marginTop:"30px",marginBottom:"10px",objectFit:"cover"},src:"light"==N?v.src:w.src}):null,"idle"!=A||R?null:(0,u.jsx)("img",{alt:"protofito dancing",style:{height:"160px",width:"190px",alignSelf:"center",marginTop:"30px",marginBottom:"10px",objectFit:"cover"},src:"light"==N?S.src:E.src}),"compile"!=A||R?null:(0,u.jsx)("img",{alt:"protofito compiling",style:{height:"160px",width:"180px",alignSelf:"center",marginTop:"30px",marginBottom:"10px",objectFit:"cover"},src:"light"==N?f.src:g.src}),(0,u.jsxs)("div",{style:{justifyContent:"center",alignSelf:"center",display:"flex",gap:"20px"},children:["write"!=A&&"idle"!=A||R?(0,u.jsx)("button",{style:{padding:"10px 20px 10px 20px",backgroundColor:"#cccccc40",borderRadius:"10px"},onClick:()=>{P()},children:"Cancel"}):(0,u.jsx)(u.Fragment,{}),"upload"==A?(0,u.jsx)("button",{style:{padding:"10px 20px 10px 20px",backgroundColor:"black",color:"white",borderRadius:"10px"},onClick:()=>{D()},children:"Select"}):(0,u.jsx)(u.Fragment,{}),"idle"==A?(0,u.jsx)("button",{style:{padding:"10px 20px 10px 20px",backgroundColor:"black",color:"white",borderRadius:"10px"},onClick:()=>{P()},children:"Done!"}):(0,u.jsx)(u.Fragment,{})]})]})})};var P=A},84536:function(r,h,m){"use strict";m.d(h,{Z:function(){return M}});var u=m(52322),_=m(39684),f=m(2784),g=m(8939),v=m(52026),w=m(60545),S=m(66306),E=m(84291),I=m(16247),T=m(48115);let A=(r,h,m)=>{let[u,_]=(0,f.useState)(),[g,v]=(0,f.useState)(!1),[w,S]=(0,f.useState)(),E=(0,f.useRef)(!1),I=r=>{r.isError?(v(!1),S(r.error)):r.isLoaded&&(v(!1),_(r.data))};return E.current||(v(!0),E.current=!0,h?T.bl.post(r,h,I,m):T.bl.get(r,I,m)),[u,g,w]};var P=m(79562),D=m(65919),C=m(91838),O=m(1940);let R=r=>{let{deviceName:h,monitorData:m}=r,S=new O.zm(h,N.name,m),[E,I]=(0,f.useState)(void 0),{message:T}=(0,_.mU)(S.getEndpoint()),[D,C,R]=A(S.getValueAPIURL());return f.useEffect(()=>{var r;I(null==T?void 0:null===(r=T.message)||void 0===r?void 0:r.toString())},[T]),(0,u.jsxs)(g.sL,{gap:"$3",children:[(0,u.jsxs)(v.Text,{marginLeft:4,textAlign:"left",children:[S.getLabel(),": "]}),C||void 0===E&&(null==D?void 0:D.value)===void 0?(0,u.jsx)(w.$,{color:"$color7"}):(0,u.jsx)(P.A,{text:"".concat(null!=E?E:null==D?void 0:D.value," ").concat(S.getUnits())})]})},L=r=>{var h,m;let{deviceName:_,action:v,buttonAction:w}=r,[I,T]=(0,f.useState)("");return v.payload.value?(0,u.jsx)(S.zx,{onPress:()=>{w(v)},color:"$color10",title:"Description: "+v.description,flex:1,children:null!==(h=v.label)&&void 0!==h?h:v.name},v.name):(0,u.jsxs)(g.sL,{gap:"$3",children:[(0,u.jsx)(E.II,{value:I,onChange:async r=>T(r.target.value),width:80,placeholder:"value",mr:8,flex:1}),(0,u.jsx)(S.zx,{onPress:()=>{client.publish((0,O.Hj)(_,v.endpoint),"json"==v.payload.type?JSON.stringify(I):I.toString())},color:"$color10",title:"Description: "+v.description,flex:1,children:null!==(m=v.label)&&void 0!==m?m:v.name},v.name)]})},N=r=>{var h,m;let{subsystem:f,deviceName:v}=r,{client:w}=(0,_.Td)(),S=r=>{"mqtt"==r.connectionType&&(console.log("MQTT Dev: ",r.payload),w.publish((0,O.Hj)(v,r.endpoint),"json"==r.payload.type?JSON.stringify(r.payload.value):r.payload.value.toString()))},E=null===(h=f.actions)||void 0===h?void 0:h.map((r,h)=>(0,u.jsx)(L,{deviceName:v,action:r,buttonAction:S},h)),T=null===(m=f.monitors)||void 0===m?void 0:m.map((r,h)=>(0,u.jsx)(R,{deviceName:v,monitorData:r},h));return(0,u.jsx)(D._k,{position:"relative",borderRadius:"10px",mt:"10px",children:(0,u.jsxs)(C.I,{children:[(0,u.jsx)(I.Paragraph,{textAlign:"left",color:"$color10",children:f.name}),(0,u.jsxs)(g.FA,{mb:"10px",mt:"10px",alignSelf:"flex-start",children:[(0,u.jsx)(g.sL,{gap:"$2",flexWrap:"wrap",children:E}),(0,u.jsx)(g.sL,{alignItems:"left",gap:"$3",children:T})]})]})})};var M=N},71155:function(r,h,m){"use strict";var u,_;m.d(h,{g:function(){return _}}),function(r){r.INITIALIZING="initializing",r.PREPARING="preparing",r.ERASING="erasing",r.WRITING="writing",r.FINISHED="finished",r.ERROR="error"}(u||(u={})),function(r){r.FAILED_INITIALIZING="failed_initialize",r.FAILED_MANIFEST_FETCH="fetch_manifest_failed",r.NOT_SUPPORTED="not_supported",r.FAILED_FIRMWARE_DOWNLOAD="failed_firmware_download",r.WRITE_FAILED="write_failed"}(_||(_={}))},58895:function(r,h,m){"use strict";m.d(h,{p:function(){return g}});class u extends Error{}var _=m(32845);async function f(r){switch(r){case 15736195:{let{ESP32ROM:r}=await m.e(1568).then(m.bind(m,91568));return new r}case 1763790959:case 456216687:{let{ESP32C3ROM:r}=await m.e(5867).then(m.bind(m,65867));return new r}case 9:{let{ESP32S3ROM:r}=await m.e(5963).then(m.bind(m,15963));return new r}case 1990:{let{ESP32S2ROM:r}=await m.e(2579).then(m.bind(m,2579));return new r}case 4293968129:{let{ESP8266ROM:r}=await m.e(90).then(m.bind(m,40090));return new r}default:return null}}class g{_sleep(r){return new Promise(h=>setTimeout(h,r))}write(r){let h=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.terminal?h?this.terminal.writeLine(r):this.terminal.write(r):console.log(r)}error(r){let h=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.write("Error: ".concat(r),h)}info(r){let h=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.write(r,h)}debug(r){let h=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.debugLogging&&this.write("Debug: ".concat(r),h)}_short_to_bytearray(r){return new Uint8Array([255&r,r>>8&255])}_int_to_bytearray(r){return new Uint8Array([255&r,r>>8&255,r>>16&255,r>>24&255])}_bytearray_to_short(r,h){return r|h>>8}_bytearray_to_int(r,h,m,u){return r|h<<8|m<<16|u<<24}_appendBuffer(r,h){let m=new Uint8Array(r.byteLength+h.byteLength);return m.set(new Uint8Array(r),0),m.set(new Uint8Array(h),r.byteLength),m.buffer}_appendArray(r,h){let m=new Uint8Array(r.length+h.length);return m.set(r,0),m.set(h,r.length),m}ui8ToBstr(r){let h="";for(let m=0;m<r.length;m++)h+=String.fromCharCode(r[m]);return h}bstrToUi8(r){let h=new Uint8Array(r.length);for(let m=0;m<r.length;m++)h[m]=r.charCodeAt(m);return h}async flush_input(){try{await this.transport.rawRead(200)}catch(r){this.error(r.message)}}async command(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint8Array(0),m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,_=!(arguments.length>3)||void 0===arguments[3]||arguments[3],f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e3;if(null!=r){let u;let _=new Uint8Array(8+h.length);for(u=0,_[0]=0,_[1]=r,_[2]=this._short_to_bytearray(h.length)[0],_[3]=this._short_to_bytearray(h.length)[1],_[4]=this._int_to_bytearray(m)[0],_[5]=this._int_to_bytearray(m)[1],_[6]=this._int_to_bytearray(m)[2],_[7]=this._int_to_bytearray(m)[3];u<h.length;u++)_[8+u]=h[u];await this.transport.write(_)}if(!_)return[0,new Uint8Array(0)];for(let h=0;h<100;h++){let h=await this.transport.read(f),m=h[0],_=h[1],g=this._bytearray_to_int(h[4],h[5],h[6],h[7]),v=h.slice(8);if(1==m){if(null==r||_==r)return[g,v];if(0!=v[0]&&v[1]==this.ROM_INVALID_RECV_MSG)throw await this.flush_input(),new u("unsupported command error")}}throw new u("invalid response")}async read_reg(r){let h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,m=this._int_to_bytearray(r),u=await this.command(this.ESP_READ_REG,m,void 0,void 0,h);return u[0]}async write_reg(r,h){let m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4294967295,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,_=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=this._appendArray(this._int_to_bytearray(r),this._int_to_bytearray(h));f=this._appendArray(f,this._int_to_bytearray(m)),f=this._appendArray(f,this._int_to_bytearray(u)),_>0&&(f=this._appendArray(f,this._int_to_bytearray(this.chip.UART_DATE_REG_ADDR)),f=this._appendArray(f,this._int_to_bytearray(0)),f=this._appendArray(f,this._int_to_bytearray(0)),f=this._appendArray(f,this._int_to_bytearray(_))),await this.check_command("write target memory",this.ESP_WRITE_REG,f)}async sync(){let r;this.debug("Sync");let h=new Uint8Array(36);for(r=0,h[0]=7,h[1]=7,h[2]=18,h[3]=32;r<32;r++)h[4+r]=85;try{let r=await this.command(8,h,void 0,void 0,100);return r}catch(r){throw this.debug("Sync err "+r),r}}async _connect_attempt(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default_reset",h=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.debug("_connect_attempt "+r+" "+h),"no_reset"!==r&&(this.transport.get_pid()===this.USB_JTAG_SERIAL_PID?(await this.transport.setRTS(!1),await this.transport.setDTR(!1),await this._sleep(100),await this.transport.setDTR(!0),await this.transport.setRTS(!1),await this._sleep(100),await this.transport.setRTS(!0),await this.transport.setDTR(!1),await this.transport.setRTS(!0),await this._sleep(100),await this.transport.setRTS(!1)):(await this.transport.setDTR(!1),await this.transport.setRTS(!0),await this._sleep(100),h&&await this._sleep(2e3),await this.transport.setDTR(!0),await this.transport.setRTS(!1),await this._sleep(50)),await this.transport.setDTR(!1));let m=0,u=!0;for(;u;){try{let r=await this.transport.read(1e3);m+=r.length}catch(r){if(this.debug(r.message),r instanceof Error){u=!1;break}}await this._sleep(50)}for(this.transport.slip_reader_enabled=!0,m=7;m--;){try{let r=await this.sync();return this.debug(r[0].toString()),"success"}catch(r){r instanceof Error&&(h?this.info("_",!1):this.info(".",!1))}await this._sleep(50)}return"error"}async connect(){let r,h,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default_reset",_=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,g=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(this.info("Connecting...",!1),await this.transport.connect(this.rom_baudrate),r=0;r<_&&"success"!==(h=await this._connect_attempt(m,!1))&&"success"!==(h=await this._connect_attempt(m,!0));r++);if("success"!==h)throw new u("Failed to connect with the device");if(this.info("\n\r",!1),!g){let r=await this.read_reg(1073745920)>>>0;this.debug("Chip Magic "+r.toString(16));let h=await f(r);if(null===this.chip)throw new u("Unexpected CHIP magic value ".concat(r,". Failed to autodetect chip type."));this.chip=h}}async detect_chip(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default_reset";await this.connect(r),this.info("Detecting chip type... ",!1),null!=this.chip?this.info(this.chip.CHIP_NAME):this.info("unknown!")}async check_command(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Uint8Array(0),u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,_=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e3;this.debug("check_command "+r);let f=await this.command(h,m,u,void 0,_);return f[1].length>4?f[1]:f[0]}async mem_begin(r,h,m,u){this.debug("mem_begin "+r+" "+h+" "+m+" "+u.toString(16));let _=this._appendArray(this._int_to_bytearray(r),this._int_to_bytearray(h));_=this._appendArray(_,this._int_to_bytearray(m)),_=this._appendArray(_,this._int_to_bytearray(u)),await this.check_command("enter RAM download mode",this.ESP_MEM_BEGIN,_)}async mem_block(r,h){let m=this._appendArray(this._int_to_bytearray(r.length),this._int_to_bytearray(h));m=this._appendArray(m,this._int_to_bytearray(0)),m=this._appendArray(m,this._int_to_bytearray(0)),m=this._appendArray(m,r);let u=this.checksum(r);await this.check_command("write to target RAM",this.ESP_MEM_DATA,m,u)}async mem_finish(r){let h=0===r?1:0,m=this._appendArray(this._int_to_bytearray(h),this._int_to_bytearray(r));await this.check_command("leave RAM download mode",this.ESP_MEM_END,m,void 0,50)}async flash_spi_attach(r){let h=this._int_to_bytearray(r);await this.check_command("configure SPI flash pins",this.ESP_SPI_ATTACH,h)}async flash_begin(r,h){let m=Math.floor((r+this.FLASH_WRITE_SIZE-1)/this.FLASH_WRITE_SIZE),u=this.chip.get_erase_size(h,r),_=new Date,f=_.getTime(),g=3e3;!1==this.IS_STUB&&(g=this.timeout_per_mb(this.ERASE_REGION_TIMEOUT_PER_MB,r)),this.debug("flash begin "+u+" "+m+" "+this.FLASH_WRITE_SIZE+" "+h+" "+r);let v=this._appendArray(this._int_to_bytearray(u),this._int_to_bytearray(m));v=this._appendArray(v,this._int_to_bytearray(this.FLASH_WRITE_SIZE)),v=this._appendArray(v,this._int_to_bytearray(h)),!1==this.IS_STUB&&(v=this._appendArray(v,this._int_to_bytearray(0))),await this.check_command("enter Flash download mode",this.ESP_FLASH_BEGIN,v,void 0,g);let w=_.getTime();return 0!=r&&!1==this.IS_STUB&&this.info("Took "+(w-f)/1e3+"."+(w-f)%1e3+"s to erase flash block"),m}async flash_defl_begin(r,h,m){let u,_;let f=Math.floor((h+this.FLASH_WRITE_SIZE-1)/this.FLASH_WRITE_SIZE),g=Math.floor((r+this.FLASH_WRITE_SIZE-1)/this.FLASH_WRITE_SIZE),v=new Date,w=v.getTime();this.IS_STUB?(u=r,_=3e3):(u=g*this.FLASH_WRITE_SIZE,_=this.timeout_per_mb(this.ERASE_REGION_TIMEOUT_PER_MB,u)),this.info("Compressed "+r+" bytes to "+h+"...");let S=this._appendArray(this._int_to_bytearray(u),this._int_to_bytearray(f));S=this._appendArray(S,this._int_to_bytearray(this.FLASH_WRITE_SIZE)),S=this._appendArray(S,this._int_to_bytearray(m)),("ESP32-S2"===this.chip.CHIP_NAME||"ESP32-S3"===this.chip.CHIP_NAME||"ESP32-C3"===this.chip.CHIP_NAME)&&!1===this.IS_STUB&&(S=this._appendArray(S,this._int_to_bytearray(0))),await this.check_command("enter compressed flash mode",this.ESP_FLASH_DEFL_BEGIN,S,void 0,_);let E=v.getTime();return 0!=r&&!1===this.IS_STUB&&this.info("Took "+(E-w)/1e3+"."+(E-w)%1e3+"s to erase flash block"),f}async flash_block(r,h,m){let u=this._appendArray(this._int_to_bytearray(r.length),this._int_to_bytearray(h));u=this._appendArray(u,this._int_to_bytearray(0)),u=this._appendArray(u,this._int_to_bytearray(0)),u=this._appendArray(u,r);let _=this.checksum(r);await this.check_command("write to target Flash after seq "+h,this.ESP_FLASH_DATA,u,_,m)}async flash_defl_block(r,h,m){let u=this._appendArray(this._int_to_bytearray(r.length),this._int_to_bytearray(h));u=this._appendArray(u,this._int_to_bytearray(0)),u=this._appendArray(u,this._int_to_bytearray(0)),u=this._appendArray(u,r);let _=this.checksum(r);this.debug("flash_defl_block "+r[0].toString(16)+" "+r[1].toString(16)),await this.check_command("write compressed data to flash after seq "+h,this.ESP_FLASH_DEFL_DATA,u,_,m)}async flash_finish(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],h=r?0:1,m=this._int_to_bytearray(h);await this.check_command("leave Flash mode",this.ESP_FLASH_END,m)}async flash_defl_finish(){let r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],h=r?0:1,m=this._int_to_bytearray(h);await this.check_command("leave compressed flash mode",this.ESP_FLASH_DEFL_END,m)}async run_spiflash_command(r,h,m){let _,f;let g=-2147483648,v=268435456,w=134217728,S=this.chip.SPI_REG_BASE,E=S+0,I=S+this.chip.SPI_USR_OFFS,T=S+this.chip.SPI_USR1_OFFS,A=S+this.chip.SPI_USR2_OFFS,P=S+this.chip.SPI_W0_OFFS;_=null!=this.chip.SPI_MOSI_DLEN_OFFS?async(r,h)=>{let m=S+this.chip.SPI_MOSI_DLEN_OFFS,u=S+this.chip.SPI_MISO_DLEN_OFFS;r>0&&await this.write_reg(m,r-1),h>0&&await this.write_reg(u,h-1)}:async(r,h)=>{let m=T,u=17,_=8,f=0===r?0:r-1,g=0===h?0:h-1,v=g<<_|f<<u;await this.write_reg(m,v)};let D=262144,C=28;if(m>32)throw new u("Reading more than 32 bits back from a SPI flash operation is unsupported");if(h.length>64)throw new u("Writing more than 64 bytes of data with one SPI command is unsupported");let O=8*h.length,R=await this.read_reg(I),L=await this.read_reg(A),N=g;m>0&&(N|=v),O>0&&(N|=w),await _(O,m),await this.write_reg(I,N);let M=7<<C|r;if(await this.write_reg(A,M),0==O)await this.write_reg(P,0);else{if(h.length%4!=0){let r=new Uint8Array(h.length%4);h=this._appendArray(h,r)}let r=P;for(f=0;f<h.length-4;f+=4)M=this._bytearray_to_int(h[f],h[f+1],h[f+2],h[f+3]),await this.write_reg(r,M),r+=4}for(await this.write_reg(E,D),f=0;f<10&&0!=(M=await this.read_reg(E)&D);f++);if(10===f)throw new u("SPI command did not complete in time");let F=await this.read_reg(P);return await this.write_reg(I,R),await this.write_reg(A,L),F}async read_flash_id(){let r=159,h=new Uint8Array(0);return await this.run_spiflash_command(r,h,24)}async erase_flash(){this.info("Erasing flash (this may take a while)...");let r=new Date,h=r.getTime(),m=await this.check_command("erase flash",this.ESP_ERASE_FLASH,void 0,void 0,this.CHIP_ERASE_TIMEOUT);r=new Date;let u=r.getTime();return this.info("Chip erase completed successfully in "+(u-h)/1e3+"s"),m}toHex(r){return Array.prototype.map.call(r,r=>("00"+r.toString(16)).slice(-2)).join("")}async flash_md5sum(r,h){let m=this.timeout_per_mb(this.MD5_TIMEOUT_PER_MB,h),u=this._appendArray(this._int_to_bytearray(r),this._int_to_bytearray(h));u=this._appendArray(u,this._int_to_bytearray(0)),u=this._appendArray(u,this._int_to_bytearray(0));let _=await this.check_command("calculate md5sum",this.ESP_SPI_FLASH_MD5,u,void 0,m);_ instanceof Uint8Array&&_.length>16&&(_=_.slice(0,16));let f=this.toHex(_);return f}async run_stub(){let r;this.info("Uploading stub...");let h=atob(this.chip.ROM_TEXT),m=h.split("").map(function(r){return r.charCodeAt(0)}),_=new Uint8Array(m);m=(h=atob(this.chip.ROM_DATA)).split("").map(function(r){return r.charCodeAt(0)});let f=new Uint8Array(m),g=Math.floor((_.length+this.ESP_RAM_BLOCK-1)/this.ESP_RAM_BLOCK);for(await this.mem_begin(_.length,g,this.ESP_RAM_BLOCK,this.chip.TEXT_START),r=0;r<g;r++){let h=r*this.ESP_RAM_BLOCK,m=h+this.ESP_RAM_BLOCK;await this.mem_block(_.slice(h,m),r)}for(g=Math.floor((f.length+this.ESP_RAM_BLOCK-1)/this.ESP_RAM_BLOCK),await this.mem_begin(f.length,g,this.ESP_RAM_BLOCK,this.chip.DATA_START),r=0;r<g;r++){let h=r*this.ESP_RAM_BLOCK,m=h+this.ESP_RAM_BLOCK;await this.mem_block(f.slice(h,m),r)}this.info("Running stub..."),await this.mem_finish(this.chip.ENTRY);for(let r=0;r<100;r++){let r=await this.transport.read(1e3,6);if(79===r[0]&&72===r[1]&&65===r[2]&&73===r[3])return this.info("Stub running..."),this.IS_STUB=!0,this.FLASH_WRITE_SIZE=16384,this.chip}throw new u("Failed to start stub. Unexpected response")}async change_baud(){this.info("Changing baudrate to "+this.baudrate);let r=this.IS_STUB?this.transport.baudrate:0,h=this._appendArray(this._int_to_bytearray(this.baudrate),this._int_to_bytearray(r)),m=await this.command(this.ESP_CHANGE_BAUDRATE,h);this.debug(m[0].toString()),this.info("Changed"),await this.transport.disconnect(),await this._sleep(50),await this.transport.connect(this.baudrate);try{await this.transport.rawRead(500)}catch(r){this.debug(r.message)}}async main_fn(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default_reset";await this.detect_chip(r);let h=await this.chip.get_chip_description(this);return this.info("Chip is "+h),this.info("Features: "+await this.chip.get_chip_features(this)),this.info("Crystal is "+await this.chip.get_crystal_freq(this)+"MHz"),this.info("MAC: "+await this.chip.read_mac(this)),await this.chip.read_mac(this),void 0!==this.chip._post_connect&&await this.chip._post_connect(this),await this.run_stub(),this.rom_baudrate!==this.baudrate&&await this.change_baud(),h}parse_flash_size_arg(r){if(void 0===this.chip.FLASH_SIZES[r])throw new u("Flash size "+r+" is not supported by this chip type. Supported sizes: "+this.chip.FLASH_SIZES);return this.chip.FLASH_SIZES[r]}_update_image_flash_params(r,h,m,u,_){if(this.debug("_update_image_flash_params "+m+" "+u+" "+_),r.length<8||h!=this.chip.BOOTLOADER_FLASH_OFFSET)return r;if("keep"===m&&"keep"===u&&"keep"===_)return this.info("Not changing the image"),r;let f=parseInt(r[0]),g=parseInt(r[2]),v=parseInt(r[3]);if(f!==this.ESP_IMAGE_MAGIC)return this.info("Warning: Image file at 0x"+h.toString(16)+" doesn't look like an image file, so not changing any flash settings."),r;if("keep"!==u){let r={qio:0,qout:1,dio:2,dout:3};g=r[u]}let w=15&v;if("keep"!==_){let r={"40m":0,"26m":1,"20m":2,"80m":15};w=r[_]}let S=240&v;"keep"!==m&&(S=this.parse_flash_size_arg(m));let E=g<<8|w+S;return this.info("Flash params set to "+E.toString(16)),parseInt(r[2])!==g<<8&&(r=r.substring(0,2)+(g<<8).toString()+r.substring(3)),parseInt(r[3])!==w+S&&(r=r.substring(0,3)+(w+S).toString()+r.substring(4)),r}async write_flash(r){let h,m,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"keep",g=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"keep",v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"keep",w=arguments.length>4&&void 0!==arguments[4]&&arguments[4],S=!(arguments.length>5)||void 0===arguments[5]||arguments[5],E=arguments.length>6?arguments[6]:void 0,I=arguments.length>7?arguments[7]:void 0;if(this.debug("EspLoader program"),"keep"!==f){let h=this.flash_size_bytes(f);for(let m=0;m<r.length;m++)if(r[m].data.length+r[m].address>h)throw new u("File ".concat(m+1," doesn't fit in the available flash"))}!0===this.IS_STUB&&!0===w&&await this.erase_flash();for(let w=0;w<r.length;w++){let T;this.debug("Data Length "+r[w].data.length),h=r[w].data;let A=r[w].data.length%4;if(A>0&&(h+="\xff\xff\xff\xff".substring(4-A)),m=r[w].address,this.debug("Image Length "+h.length),0===h.length){this.debug("Warning: File is empty");continue}h=this._update_image_flash_params(h,m,f,g,v);let P=null;I&&(P=I(h),this.debug("Image MD5 "+P));let D=h.length;if(S){let r=this.bstrToUi8(h);h=this.ui8ToBstr((0,_.deflate)(r,{level:9})),T=await this.flash_defl_begin(D,h.length,m)}else T=await this.flash_begin(D,m);let C=0,O=0,R=h.length;E&&E(w,0,R);let L=new Date,N=L.getTime(),M=5e3,F=new _.Inflate({chunkSize:1}),q=0;for(F.onData=function(r){q+=r.byteLength};h.length>0;){this.debug("Write loop "+m+" "+C+" "+T),this.info("Writing at 0x"+(m+q).toString(16)+"... ("+Math.floor(100*(C+1)/T)+"%)");let r=this.bstrToUi8(h.slice(0,this.FLASH_WRITE_SIZE));if(S){let h=q;F.push(r,!1);let m=q-h,u=3e3;this.timeout_per_mb(this.ERASE_WRITE_TIMEOUT_PER_MB,m)>3e3&&(u=this.timeout_per_mb(this.ERASE_WRITE_TIMEOUT_PER_MB,m)),!1===this.IS_STUB&&(M=u),await this.flash_defl_block(r,C,M),this.IS_STUB&&(M=u)}else throw new u("Yet to handle Non Compressed writes");O+=r.length,h=h.slice(this.FLASH_WRITE_SIZE,h.length),C++,E&&E(w,O,R)}this.IS_STUB&&await this.read_reg(this.CHIP_DETECT_MAGIC_REG_ADDR,M),L=new Date;let G=L.getTime()-N;if(S&&this.info("Wrote "+D+" bytes ("+O+" compressed) at 0x"+m.toString(16)+" in "+G/1e3+" seconds."),P){let r=await this.flash_md5sum(m,D);if(new String(r).valueOf()!=new String(P).valueOf())throw this.info("File  md5: "+P),this.info("Flash md5: "+r),new u("MD5 of file does not match data in flash!");this.info("Hash of data verified.")}}this.info("Leaving..."),this.IS_STUB&&(await this.flash_begin(0,0),S?await this.flash_defl_finish():await this.flash_finish())}async flash_id(){this.debug("flash_id");let r=await this.read_flash_id();this.info("Manufacturer: "+(255&r).toString(16));let h=r>>16&255;this.info("Device: "+(r>>8&255).toString(16)+h.toString(16)),this.info("Detected flash size: "+this.DETECTED_FLASH_SIZES[h])}async hard_reset(){await this.transport.setRTS(!0),await this._sleep(100),await this.transport.setRTS(!1)}async soft_reset(){if(this.IS_STUB){if("ESP8266"!=this.chip.CHIP_NAME)throw new u("Soft resetting is currently only supported on ESP8266");await this.command(this.ESP_RUN_USER_CODE,void 0,void 0,!1)}else await this.flash_begin(0,0),await this.flash_finish(!1)}constructor(r,h,m,u=115200,_=!1){this.transport=r,this.baudrate=h,this.terminal=m,this.rom_baudrate=u,this.debugLogging=_,this.ESP_RAM_BLOCK=6144,this.ESP_FLASH_BEGIN=2,this.ESP_FLASH_DATA=3,this.ESP_FLASH_END=4,this.ESP_MEM_BEGIN=5,this.ESP_MEM_END=6,this.ESP_MEM_DATA=7,this.ESP_WRITE_REG=9,this.ESP_READ_REG=10,this.ESP_SPI_ATTACH=13,this.ESP_CHANGE_BAUDRATE=15,this.ESP_FLASH_DEFL_BEGIN=16,this.ESP_FLASH_DEFL_DATA=17,this.ESP_FLASH_DEFL_END=18,this.ESP_SPI_FLASH_MD5=19,this.ESP_ERASE_FLASH=208,this.ESP_ERASE_REGION=209,this.ESP_RUN_USER_CODE=211,this.ESP_IMAGE_MAGIC=233,this.ESP_CHECKSUM_MAGIC=239,this.ROM_INVALID_RECV_MSG=5,this.ERASE_REGION_TIMEOUT_PER_MB=3e4,this.ERASE_WRITE_TIMEOUT_PER_MB=4e4,this.MD5_TIMEOUT_PER_MB=8e3,this.CHIP_ERASE_TIMEOUT=12e4,this.MAX_TIMEOUT=2*this.CHIP_ERASE_TIMEOUT,this.CHIP_DETECT_MAGIC_REG_ADDR=1073745920,this.DETECTED_FLASH_SIZES={18:"256KB",19:"512KB",20:"1MB",21:"2MB",22:"4MB",23:"8MB",24:"16MB"},this.USB_JTAG_SERIAL_PID=4097,this.checksum=function(r){let h;let m=239;for(h=0;h<r.length;h++)m^=r[h];return m},this.timeout_per_mb=function(r,h){let m=r*(h/1e6);return m<3e3?3e3:m},this.flash_size_bytes=function(r){let h=-1;return -1!==r.indexOf("KB")?h=1024*parseInt(r.slice(0,r.indexOf("KB"))):-1!==r.indexOf("MB")&&(h=1048576*parseInt(r.slice(0,r.indexOf("MB")))),h},this.IS_STUB=!1,this.FLASH_WRITE_SIZE=16384,this.terminal&&this.terminal.clean(),this.info("esptool.js"),this.info("Serial port "+this.transport.get_info())}}},3089:function(r,h,m){"use strict";m.d(h,{J:function(){return u}});class u{get_info(){let r=this.device.getInfo();return r.usbVendorId&&r.usbProductId?"WebSerial VendorID 0x".concat(r.usbVendorId.toString(16)," ProductID 0x").concat(r.usbProductId.toString(16)):""}get_pid(){return this.device.getInfo().usbProductId}slip_writer(r){let h=0,m=0,u=0;for(m=0;m<r.length;m++)(192===r[m]||219===r[m])&&h++;let _=new Uint8Array(2+h+r.length);for(m=0,_[0]=192,u=1;m<r.length;m++,u++){if(192===r[m]){_[u++]=219,_[u]=220;continue}if(219===r[m]){_[u++]=219,_[u]=221;continue}_[u]=r[m]}return _[u]=192,_}async write(r){let h=this.slip_writer(r);if(this.device.writable){let r=this.device.writable.getWriter();await r.write(h),r.releaseLock()}}_appendBuffer(r,h){let m=new Uint8Array(r.byteLength+h.byteLength);return m.set(new Uint8Array(r),0),m.set(new Uint8Array(h),r.byteLength),m.buffer}slip_reader(r){let h=0,m=0,u=0,_="init";for(;h<r.length;){if("init"===_&&192==r[h]){m=h+1,_="valid_data",h++;continue}if("valid_data"===_&&192==r[h]){u=h-1,_="packet_complete";break}h++}if("packet_complete"!==_)return this.left_over=r,new Uint8Array(0);this.left_over=r.slice(u+2);let f=new Uint8Array(u-m+1),g=0;for(h=m;h<=u;h++,g++){if(219===r[h]&&220===r[h+1]){f[g]=192,h++;continue}if(219===r[h]&&221===r[h+1]){f[g]=219,h++;continue}f[g]=r[h]}let v=f.slice(0,g);return v}async read(){let r,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,u=this.left_over;if(this.left_over=new Uint8Array(0),this.slip_reader_enabled){let r=this.slip_reader(u);if(r.length>0)return r;u=this.left_over,this.left_over=new Uint8Array(0)}if(null==this.device.readable)return this.left_over;let _=this.device.readable.getReader();try{h>0&&(r=setTimeout(function(){_.cancel()},h));do{let{value:r,done:h}=await _.read();if(h)throw this.left_over=u,Error("Timeout");let m=new Uint8Array(this._appendBuffer(u.buffer,r.buffer));u=m}while(u.length<m)}finally{h>0&&clearTimeout(r),_.releaseLock()}return this.slip_reader_enabled?this.slip_reader(u):u}async rawRead(){let r,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0!=this.left_over.length){let r=this.left_over;return this.left_over=new Uint8Array(0),r}if(!this.device.readable)return this.left_over;let m=this.device.readable.getReader();try{h>0&&(r=setTimeout(function(){m.cancel()},h));let{value:u,done:_}=await m.read();if(_)throw Error("Timeout");return u}finally{h>0&&clearTimeout(r),m.releaseLock()}}async setRTS(r){await this.device.setSignals({requestToSend:r}),await this.setDTR(this._DTR_state)}async setDTR(r){this._DTR_state=r,await this.device.setSignals({dataTerminalReady:r})}async connect(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:115200;await this.device.open({baudRate:r}),this.baudrate=r,this.left_over=new Uint8Array(0)}async sleep(r){return new Promise(h=>setTimeout(h,r))}async waitForUnlock(r){for(;this.device.readable&&this.device.readable.locked||this.device.writable&&this.device.writable.locked;)await this.sleep(r)}async disconnect(){await this.waitForUnlock(400),await this.device.close()}constructor(r){this.device=r,this.slip_reader_enabled=!1,this.left_over=new Uint8Array(0),this.baudrate=0,this._DTR_state=!1}}},93917:function(r,h,m){"use strict";m.d(h,{Z:function(){return tj}});class u{attach(r,h){let m=[{name:this.type,config:{ssid:this.ssid,password:this.password,power_save_mode:this.power_save_mode}}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}constructor(r,h,m){this.ssid=r,this.password=h,this.power_save_mode=m,this.type="wifi"}}function _(r,h,m){return new u(r,h,m)}class f{attach(r,h){this.topic_prefix="devices/"+h.esphome.name;let m=[{name:this.type,config:{broker:this.broker,topic_prefix:this.topic_prefix,port:this.port},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?h[r.name]={...h[r.name],...r.config}:h[r.name]=r.config}),h}getSubsystem(){return{name:this.name,type:this.type,config:{prefix:this.topic_prefix,frontendEndpoint:"/ws",brokerUrl:this.broker},actions:[],monitors:[{name:"status",label:"Device status",description:"Gets the status of the mqtt connection",endpoint:"/status",connectionType:"mqtt"}]}}constructor(r,h){this.broker=r,this.port=h,this.name=this.type="mqtt"}}function g(r,h){return new f(r,h)}class v{extractNestedComponents(r,h){let m=[{key:"mqtt",nestedKey:"on_message"},{key:"esphome",nestedKey:"on_boot"}];m.forEach(m=>{let{key:u,nestedKey:_}=m;r.config[_]&&(h[u]||(h[u]={}),h[u][_]||(h[u][_]=[]),Array.isArray(h[u][_])?h[u][_].push(...r.config[_]):h[u][_]={...h[u][_],...r.config[_]})})}exctractComponent(r,h){["mqtt","esphome"].includes(r.name)?this.extractNestedComponents(r,h):h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name].push(r.config)):h[r.name]=r.config}attach(r,h,m){var u,_,f,g;let v=[{name:"deep_sleep",config:{id:"ds",sleep_duration:this.sleep_duration+"s",wakeup_pin:this.wakeup_pin,wakeup_pin_mode:"KEEP_AWAKE"}}],w=[{name:"globals",config:{id:"dp_run_duration",type:"int",restore_value:"yes",initial_value:this.run_duration}},{name:"globals",config:{id:"dp_sleep_duration",type:"int",restore_value:"yes",initial_value:this.sleep_duration}},{name:"mqtt",config:{on_message:[{topic:"".concat((null===(u=h.mqtt)||void 0===u?void 0:u.topic_prefix)!==""?(null===(_=h.mqtt)||void 0===_?void 0:_.topic_prefix)+"/"+h.esphome.name:h.esphome.name,"/deep_sleep/dp_sleep_duration/command"),then:{lambda:'int value = atoi(x.c_str());\nif (value == 0) {\n  id(ds).prevent_deep_sleep();\n  ESP_LOGD("Deep Sleep", "Deep Sleep disabled");\n} else if (value > 0) {\n  id(ds).allow_deep_sleep();\n  id(dp_sleep_duration) = value;\n  id(ds).set_sleep_duration(value * 1000);\n  ESP_LOGD("Deep Sleep", "Deep Sleep sleep duration set to: %d", value);\n  ESP_LOGD("Deep Sleep", "Global Deep Sleep sleep duration set to: %d", id(dp_run_duration));\n} else {\n  ESP_LOGD("Deep Sleep", "Invalid sleep duration value");\n}'}}]}},{name:"mqtt",config:{on_message:[{topic:"".concat((null===(f=h.mqtt)||void 0===f?void 0:f.topic_prefix)!==""?(null===(g=h.mqtt)||void 0===g?void 0:g.topic_prefix)+"/"+h.esphome.name:h.esphome.name,"/deep_sleep/dp_run_duration/command"),then:{lambda:'int value = atoi(x.c_str());\nif (value > 0){\n  id(dp_run_duration) = value;\n  id(ds).set_run_duration(value*1000);\n  ESP_LOGD("Deep Sleep", "Deep Sleep run duration set to: %d",  value);\n  ESP_LOGD("Deep Sleep", "Global Deep Sleep run duration set to: %d",  id(dp_run_duration));       \n} else {\n  ESP_LOGD("Deep Sleep", "Invalid run duration value");\n}'}}]}},{name:"esphome",config:{on_boot:[{priority:600,then:{lambda:'ESP_LOGD("Deep Sleep", "Global Deep Sleep run duration set to at boot: %d",  id(dp_run_duration));\nid(ds).set_run_duration(id(dp_run_duration)*1000);\nESP_LOGD("Deep Sleep", "Global Deep Sleep sleep duration set to at boot: %d",  id(dp_sleep_duration));\nid(ds).set_sleep_duration(id(dp_sleep_duration)*1000);'}}]}}];return v.forEach((r,m)=>{this.exctractComponent(r,h)}),m.filter(r=>null!==r).map(r=>r.constructor.name).includes("Mqtt")&&w.forEach((r,m)=>{this.exctractComponent(r,h)}),h}constructor(r,h,m,u){this.run_duration=r,this.sleep_duration=h,this.wakeup_pin=m,this.mqttTopicPrefix=""}}function w(r,h,m,u){return new v(r,h,m,u)}class S{attach(r,h){let m=[{name:this.type,config:{platform:this.platform,pin:r,name:this.name,id:this.name,filters:[{delayed_off:"100ms"},{delayed_on:"100ms"}]},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{name:this.name,type:this.type,monitors:[{name:"status",label:"Button status",description:"Get binary sensor status",endpoint:"/"+this.type+"/"+this.name+"/state",connectionType:"mqtt"}]}}constructor(r,h){this.name=r,this.platform=h,this.type="binary_sensor"}}function E(r){return new S(r,"gpio")}let I=m(49431);class T{createComponentsTree(r,h){var m,u={esphome:{name:r},[h.board.core]:h.config.sdkConfig,logger:{}};null===(m=this.components)||void 0===m||m.forEach((r,h)=>{console.log("\uD83D\uDE80 ~ file: Device.ts:62 ~ Device ~ this.components?.forEach ~ component:",r),r&&(u=r.attach(isNaN(parseInt(this.pinTable[h]))?this.pinTable[h]:parseInt(this.pinTable[h]),u,this.components))}),this.componentsTree=u}createSubsystemsTree(r,h){var m;this.subsystemsTree=[],null===(m=this.components)||void 0===m||m.forEach(r=>{if(r)try{this.subsystemsTree.push(r.getSubsystem())}catch(r){}})}getComponentsTree(r,h){let m=h.board.ports;return this.pinTable=[],m.forEach(r=>{["3V3","EN","36","39","CLK"].includes(r.name)||this.pinTable.push(r.name)}),this.createComponentsTree(r,h),this.componentsTree}getSubsystemsTree(r,h){return this.createSubsystemsTree(r,h),this.subsystemsTree}dump(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"yaml";return"yaml"==r?I.dump(this.componentsTree,{lineWidth:-1}):void 0}constructor(r){this.pinTable=[],this.components=r.slice(2),this.componentsTree={},this.subsystemsTree=[]}}function A(r){return new T(r)}class P{attach(r,h){var m=!1;this.effects.forEach(r=>{!0===r&&(m=!0)});let u=[{name:this.type,config:{platform:this.platform,pin:r,name:this.name,id:this.name,variant:this.chipset,num_leds:this.numLeds,type:this.rgb_order,method:{type:"esp32_rmt",channel:this.channel},restore_mode:this.restoreMode,default_transition_length:this.defaultTransitionLength},subsystem:this.getSubsystem()}];if(u.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),!m)return h;{let r=[];return this.effects[0]&&(r=r.concat([{pulse:null},{pulse:{name:"Fast Pulse",transition_length:"0.5s",update_interval:"0.5s"}},{pulse:{name:"Slow Pulse",update_interval:"2s"}}])),this.effects[1]&&(r=r.concat([{random:null},{random:{name:"My Slow Random Effect",transition_length:"30s",update_interval:"30s"}},{random:{name:"My Fast Random Effect",transition_length:"4s",update_interval:"5s"}}])),this.effects[2]&&(r=r.concat([{strobe:null},{strobe:{name:"Strobe Effect With Custom Values",colors:[{state:!0,brightness:"100%",red:"100%",green:"0%",blue:"0%",duration:"500ms"},{state:!1,duration:"250ms"},{state:!0,brightness:"100%",red:"0%",green:"100%",blue:"0%",duration:"500ms"}]}}])),this.effects[3]&&(r=r.concat([{flicker:null},{flicker:{name:"Flicker Effect With Custom Values",alpha:"95%",intensity:"1.5%"}}])),this.effects[4]&&(r=r.concat([{addressable_rainbow:null},{addressable_rainbow:{name:"Rainbow Effect With Custom Values",speed:10,width:50}}])),this.effects[5]&&(r=r.concat([{addressable_color_wipe:null},{addressable_color_wipe:{name:"Color Wipe Effect With Custom Values",add_led_interval:"100ms",reverse:!1,colors:[{red:"100%",green:"100%",blue:"100%",num_leds:1},{red:"0%",green:"0%",blue:"0%",num_leds:1}]}}])),this.effects[6]&&(r=r.concat([{addressable_scan:null},{addressable_scan:{name:"Scan Effect With Custom Values",move_interval:"100ms",scan_width:1}}])),this.effects[7]&&(r=r.concat([{addressable_twinkle:null},{addressable_twinkle:{name:"Twinkle Effect With Custom Values",twinkle_probability:"5%",progress_interval:"4ms"}}])),this.effects[8]&&(r=r.concat([{addressable_random_twinkle:null},{addressable_random_twinkle:{name:"Random Twinkle Effect With Custom Values",twinkle_probability:"5%",progress_interval:"32ms"}}])),this.effects[9]&&(r=r.concat([{addressable_fireworks:null},{addressable_fireworks:{name:"Fireworks Effect With Custom Values",update_interval:"32ms",spark_probability:"10%",use_random_color:!1,fade_out_rate:120}}])),this.effects[10]&&(r=r.concat([{addressable_flicker:null},{addressable_flicker:{name:"Adressable flicker Effect With Custom Values",update_interval:"16ms",intensity:"5%"}}])),u[0].config.effects=r,h}}getSubsystem(){return{name:this.name,type:this.type,actions:[{name:"on",label:"Turn on",description:"Turns on the neopixels",endpoint:"/"+this.type+"/"+this.name+"/command",connectionType:"mqtt",payload:{type:"json",value:{state:"ON",color:{r:255,g:0,b:0},effect:"none",brightness:255}}},{name:"off",label:"Turn off",description:"Turns off the neopixels",endpoint:"/"+this.type+"/"+this.name+"/command",connectionType:"mqtt",payload:{type:"json",value:{state:"OFF",color:{r:0,g:0,b:0},effect:"none",brightness:255}}},{name:"toggle",label:"Toggle",description:"Turn on an effect on the gpio",endpoint:"/"+this.type+"/"+this.name+"/command",connectionType:"mqtt",payload:{type:"json",value:{state:"ON",color:{r:255,g:255,b:255},effect:"pulse",brightness:255}}}]}}constructor(r,h,m,u,_,f,g,v,w,S,E,I,T,A,P,D,C,O,R){this.effects=[],this.name=r,this.type="light",this.platform=h,this.rgb_order=u,this.chipset=_,this.numLeds=m,this.restoreMode=f,this.defaultTransitionLength=g,this.channel=v,this.effects=[w,S,E,I,T,A,P,D,C,,O,R],this.mqttMsgs={state:"ON",color:{r:255,g:0,b:0},effect:"My Slow Random Effect",brightness:255}}}function D(r,h,m,u,_,f,g,v,w,S,E,I,T,A,D,C,O){return new P(r,"neopixelbus",h,m,u,_,f,g,v,w,S,E,I,T,A,D,C,O)}class C{attach(r){return{componentName:"output",payload:"    - platform: ".concat(this.platform,"\n      pin: ").concat(r,"\n      id: ").concat(this.name,"\n")}}constructor(r,h){this.name=r,this.platform=h}}function O(r){return new C(r,"gpio")}class R{attach(r,h){let m=[{name:this.type,config:{platform:this.platform,pin:r,name:this.name,id:this.name,restore_mode:this.restoreMode},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{name:this.name,type:this.type,config:{restoreMode:"ON"},actions:[{name:"on",label:"Turn on",description:"turns on the gpio",endpoint:"/"+this.type+"/"+this.name+"/command",connectionType:"mqtt",payload:{type:"str",value:"ON"}},{name:"off",label:"Turn off",description:"turns off the gpio",endpoint:"/"+this.type+"/"+this.name+"/command",connectionType:"mqtt",payload:{type:"str",value:"OFF"}},{name:"toggle",label:"Toggle",description:"Toggles the gpio",endpoint:"/"+this.type+"/"+this.name+"/command",connectionType:"mqtt",payload:{type:"str",value:"TOGGLE"}}]}}constructor(r,h,m){this.name=r,this.platform=h,this.restoreMode=m,this.type="switch"}}function L(r,h){return new R(r,"gpio",h)}let N=L;class M{attach(r,h){let m=[{name:this.type,config:{platform:this.platform,pin:r,name:this.name,id:this.name,update_interval:this.updateInterval,attenuation:this.attenuation},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{name:this.name,type:this.type,monitors:[{name:"status",label:"Get status",description:"Get sensor status",endpoint:"/"+this.type+"/"+this.name+"/state",connectionType:"mqtt"}]}}constructor(r,h,m,u){this.name=r,this.platform=h,this.type="sensor",this.updateInterval=m,this.attenuation=u||"auto"}}function F(r,h,m){return new M(r,"adc",h,m)}class q{attach(r){return{componentName:"sensor",payload:"    - platform: ".concat(this.platform,"\n      pin: ").concat(r,"\n      id: ").concat(this.name,"\n      name: ").concat(this.name,"\n")}}constructor(r,h){this.name=r,this.platform=h}}function G(r){return new q(r,"pulse_counter")}class H{setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{componentName:"on_json_message",payload:"    - topic: ".concat(this.mqttTopicPrefix,"/output/").concat(this.name,'/command\n      then:\n      - lambda: |-\n          if (x.containsKey("pwmLevel"))  {\n            id(').concat(this.name,').set_level((float)x["pwmLevel"]);\n          }\n')},{componentName:"output",payload:"    - platform: ".concat(this.platform,"\n      pin: ").concat(r,"\n      id: ").concat(this.name,"\n      frequency: ").concat(this.frequency,"\n")}]}constructor(r,h,m){this.name=r,this.platform=h,this.frequency=m,this.mqttTopicPrefix=""}}function U(r,h){return new H(r,"ledc",h)}class z{attach(r){return{componentName:"binary_sensor",payload:"    - platform: ".concat(this.platform,"\n      pin: ").concat(r,"\n      id: ").concat(this.name,"\n      name: ").concat(this.name,"\n      device_class: motion\n")}}constructor(r,h){this.name=r,this.platform=h}}function B(r){return new z(r,"gpio")}class V{attach(r,h){let m=[{name:this.type,config:{platform:this.platform,name:this.name,id:this.name,dout_pin:r,clk_pin:this.clkPin,gain:this.gain,update_interval:this.updateInterval},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{name:this.name,type:this.type,monitors:[{name:"Load cell",label:"Load",description:"Get load cell status",units:"pts",endpoint:"/sensor/"+this.name+"/state",connectionType:"mqtt"}]}}constructor(r,h,m,u,_){this.type="sensor",this.name=r,this.platform=h,this.clkPin=m,this.updateInterval=_,this.gain=u}}function W(r,h,m,u){return new V(r,"hx711",h,m,u)}class Z{attach(r){return{componentName:"sensor",payload:"    - platform: ".concat(this.platform,"\n      pin: ").concat(r,"\n      id: ").concat(this.name,"\n      name: ").concat(this.name,"\n      update_interval: ").concat(this.updateInterval,"\n      attenuation: ").concat(this.attenuation,"\n")}}constructor(r,h,m){this.name=r,this.platform=h,this.updateInterval=m,this.attenuation="11db"}}function K(r,h){return new Z(r,"adc",h)}class ${getPlatform(){return this.platform}setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{componentName:"".concat(this.platform,"_i2c"),payload:"    update_interval: 1s\n    id: noconflict_".concat(this.name,"\n    i2c_id: ").concat(this.i2cBusId,"\n    on_tag:\n        then:\n            - mqtt.publish:\n                topic: ").concat(this.mqttTopicPrefix,"/").concat(this.platform,"_i2c/").concat(this.name,"/state\n                payload: !lambda 'return x;'\n    on_tag_removed:\n        then:\n            - mqtt.publish:\n                topic: ").concat(this.mqttTopicPrefix,"/").concat(this.platform,"_i2c/").concat(this.name,"/state\n                payload: !lambda 'return \"not:\"+x;'\n")},{componentName:"i2c",payload:"    sda: ".concat(r,"\n    scl: ").concat(this.sclPin,"\n    #scan: true\n    id: ").concat(this.i2cBusId,"\n")}]}constructor(r,h,m,u){this.name=r,this.platform=h,this.i2cBusId=m,this.sclPin=u,this.mqttTopicPrefix=""}}function X(r,h){return new $(r,"pn532","bus_a",h)}class J{attach(r){return{componentName:"sensor",payload:"    - platform: ".concat(this.platform,"\n      id: ").concat(this.name,"\n      name: ").concat(this.name,"\n      trigger_pin: ").concat(r,"\n      echo_pin: ").concat(this.echoPin,"\n      update_interval: ").concat(this.updateInterval,"\n      timeout : ").concat(this.timeout,"\n")}}constructor(r,h,m,u,_){this.name=r,this.platform=h,this.echoPin=m,this.updateInterval=u,this.timeout=_}}function Y(r,h,m,u){return new J(r,"ultrasonic",h,m,u)}class Q{setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{componentName:"on_message",payload:"    - topic: ".concat(this.mqttTopicPrefix,"/output/").concat(this.name,'/command\n      then:\n        - lambda: |-\n            if (x=="ON")  {\n              id(').concat(this.name,").turn_on();\n            }else{\n              id(").concat(this.name,").turn_off();\n            }\n  ")},{componentName:"i2c",payload:"   sda: 21\n   scl: 22\n   scan: true\n   id: bus_a\n\n"},{componentName:this.platform,payload:"    - id: pca9685_hub1\n      frequency: 100\n\n"},{componentName:"output",payload:"    - platform: ".concat(this.platform,"\n      channel: 11\n      id: ").concat(this.name,"\n      pca9685_id: 'pca9685_hub1'\n\n")}]}constructor(r,h){this.name=r,this.platform=h,this.mqttTopicPrefix=""}}function tt(r){return new Q(r,"pca9685")}class te{setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{name:"on_json_message",config:{topic:"".concat(this.mqttTopicPrefix,"/").concat(this.platform,"/").concat(this.name,"/command"),then:{lambda:'if (x.containsKey("file2Play")){\n    id('.concat(this.platform,'file) = (int) x["file2Play"];\n    for(int i = 0; i<10 && !id(').concat(this.name,"busypin).state; i++){\n      id(").concat(this.name,').play_file((int) x["file2Play"]);\n    }\n}\nif(x.containsKey("volume")){\n    id(').concat(this.platform,'vol) = (int) x["volume"];\n    id(').concat(this.name,').set_volume((int) x["volume"]);\n}')}}},{name:"globals",config:{id:"".concat(this.platform,"file"),type:"int",restore_value:"no",initial_value:"0"}},{name:"globals",config:{id:"".concat(this.platform,"vol"),type:"int",restore_value:"no",initial_value:"30"}},{name:"uart",config:{id:"".concat(this.platform,"dfplayer"),tx_pin:r,rx_pin:this.rxPin,baud_rate:9600}},{name:this.platform,config:{uart_id:"".concat(this.platform,"dfplayer"),id:this.name,on_finished_playback:{then:{"logger.log":"Somebody press play!"}}},subsystem:{action:[{name:"Set Volume",description:"Sets de mp3 volume",endpoint:"/command",connectionType:"mqtt",payload:{type:"json",json:{volume:{type:"int",min:0,max:30}}}},{name:"Play file",description:"Plays the specified file",endpoint:"/command",connectionType:"mqtt",value:{type:"json",json:{file2Play:{type:"int",min:0,max:void 0}}}}]}},{name:"binary_sensor",config:{platform:"gpio",pin:this.busyPin,name:"".concat(this.name,"busypin"),id:"".concat(this.name,"busypin"),filters:[{invert:null},{delayed_off:"100ms"},{delayed_on:"100ms"}]}}]}constructor(r,h,m,u){this.name=r,this.platform=h,this.rxPin=m,this.busyPin=u,this.mqttTopicPrefix=""}}function tn(r,h,m){return new te(r,"dfplayer",h,m)}class ti{getWifiPowerMode(){return"light"}attach(r){return[{componentName:"esp32_ble_tracker",payload:"   scan_parameters:\n        interval: 320ms # try with 300ms if you don't have LAN module\n        window: 30ms # try with 300ms if you don't have LAN module\n        continuous: true\n        active: false\n"},{componentName:"sensor",payload:"    - platform: ".concat(this.platform,"\n      mac_address: '").concat(this.macAddress,"'\n      id: ").concat(this.id,'\n      temperature:\n          name: "').concat(this.id,'temperature"\n   \n      moisture:\n          name: "').concat(this.id,'moisture"\n\n      illuminance:\n          name: "').concat(this.id,'illuminance"\n\n      conductivity:\n          name: "').concat(this.id,'soilconductivity"\n\n      battery_level:\n          name: "').concat(this.id,'batterylevel"\n')}]}constructor(r,h,m){this.id=r,this.platform=h,this.macAddress=m}}function ta(r,h){return new ti(r,"xiaomi_hhccjcy01",h)}class ts{setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{componentName:"remote_transmitter",payload:"   pin: ".concat(r,"\n   carrier_duty_percent: 50%\n\n")},{componentName:"climate",payload:"  - platform: ".concat(this.platform,'\n    name: "').concat(this.name,'"\n    id: ').concat(this.name,"\n    protocol: ").concat(this.protocol,"\n    horizontal_default: ").concat(this.horizontal_default,"\n    vertical_default: ").concat(this.verical_default,"\n    max_temperature: ").concat(this.max_temperature,"\n    min_temperature: ").concat(this.min_temperature,"\n\n")}]}constructor(r,h,m,u,_,f,g){this.name=r,this.platform=h,this.protocol=m,this.horizontal_default=u,this.verical_default=_,this.max_temperature=f,this.min_temperature=g,this.mqttTopicPrefix=""}}function tr(r,h,m,u,_,f){return new ts(r,"heatpumpir",h,m,u,_,f)}class to{setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{componentName:"on_message",payload:"    - topic: ".concat(this.mqttTopicPrefix,"/").concat(this.platform,"/").concat(this.name,"/command\n      then:\n      - lambda: |-\n         float value = atoi(x.c_str());\n         if(value >= 0 && value <= 180) id(").concat(this.name,").write(value/180);\n         if(value > 180) id(").concat(this.name,").write(180);\n         if(value < 0) id(").concat(this.name,").write(0);\n")},{componentName:"output",payload:"  - platform: ledc\n    pin: ".concat(r,"\n    id: ").concat(this.name,"ledcOutput\n    frequency: 50 Hz\n")},{componentName:"servo",payload:"  - id: ".concat(this.name,"\n    output: ").concat(this.name,"ledcOutput\n    auto_detach_time: 0s\n    transition_length: 0s\n")}]}constructor(r,h){this.name=r,this.platform=h,this.mqttTopicPrefix=""}}function tc(r){return new to(r,"servo")}class tl{getPlatform(){return this.platform}setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{componentName:"i2c",payload:"    sda: ".concat(r,"\n    scl: ").concat(this.sclPin,"\n    #scan: true\n    id: ").concat(this.i2cBusId,"\n")},{componentName:"".concat(this.platform),payload:"    id: ".concat(this.name,"\n    address: 0x5A\n    touch_debounce: 1\n    release_debounce: 1\n    touch_threshold: 10\n    release_threshold: 7\n")},...this.channels.map((r,h)=>r?{componentName:"binary_sensor",payload:"    - platform: mpr121\n      id: ".concat(this.name+"_"+h,"\n      channel: ").concat(h,"\n      name:  ").concat(this.name+"_"+h,"\n      touch_threshold: 12\n      release_threshold: 6\n")}:null).filter(Boolean)]}constructor(r,h,m,u,_,f,g,v,w,S,E,I,T,A,P,D){this.channels=[],this.name=r,this.platform=h,this.i2cBusId=m,this.sclPin=u,this.mqttTopicPrefix="",this.channels=[_,f,g,v,w,S,E,I,T,A,P,D]}}function td(r,h,m,u,_,f,g,v,w,S,E,I,T,A){return new tl(r,"mpr121","bus_a",h,m,u,_,f,g,v,w,S,E,I,T,A)}class th{attach(r,h){let m=[{name:this.type,config:{platform:this.platform,pin:r,model:this.model,id:this.name,update_interval:this.updateInterval,temperature:{name:"temperature"},humidity:{name:"humidity"}},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{name:this.name,type:this.type,monitors:[{name:"Temperature",label:"temperature",description:"Get sensor status",endpoint:"/"+this.type+"/temperature/state",connectionType:"mqtt"},{name:"Humidity",label:"humidity",description:"Get sensor status",endpoint:"/"+this.type+"/humidity/state",connectionType:"mqtt"}]}}constructor(r,h,m,u){this.name=r,this.platform=h,this.type="sensor",this.model=m,this.updateInterval=u}}function tm(r,h,m){return new th(r,"dht",h,m)}class tp{setMqttTopicPrefix(r){this.mqttTopicPrefix=r}setDeepSleep(r){this.dpEnabled=r}attach(r){var h=[{name:"uart",config:{id:"".concat(this.name,"uartmodbus"),tx_pin:r,rx_pin:this.rxPin,baud_rate:19200,stop_bits:2}},{name:this.platform,config:{id:"".concat(this.name,"modbusid"),uart_id:"".concat(this.name,"uartmodbus")}},{name:"modbus_controller",config:{id:"".concat(this.name,"modbuscontrollerid"),address:1,modbus_id:"".concat(this.name,"modbusid"),setup_priority:-10,update_interval:this.updateInterval}},{name:"sensor",config:{platform:"modbus_controller",modbus_controller_id:"".concat(this.name,"modbuscontrollerid"),id:"".concat(this.name,"load"),name:"".concat(this.name,"load"),unit_of_measurement:"Kg",address:parseInt(this.weightRegister),register_type:"holding",value_type:2==this.weightRegisters2Read?"U_DWORD":"U_WORD",register_count:parseInt(this.weightRegisters2Read)}},{name:"binary_sensor",config:{platform:"modbus_controller",modbus_controller_id:"".concat(this.name,"modbuscontrollerid"),id:"".concat(this.name,"stateflags0"),name:"".concat(this.name,"stateflags0"),address:parseInt(this.stateFlagsRegister),register_type:"holding",bitmask:0}},{name:"binary_sensor",config:{platform:"modbus_controller",modbus_controller_id:"".concat(this.name,"modbuscontrollerid"),id:"".concat(this.name,"stateflags3"),name:"".concat(this.name,"stateflags3"),address:parseInt(this.stateFlagsRegister),register_type:"holding",bitmask:3}},{name:"binary_sensor",config:{platform:"modbus_controller",modbus_controller_id:"".concat(this.name,"modbuscontrollerid"),id:"".concat(this.name,"stateflags4"),name:"".concat(this.name,"stateflags4"),address:parseInt(this.stateFlagsRegister),register_type:"holding",bitmask:16}}];let m=[{name:"switch",config:{platform:"gpio",pin:this.enablePin,id:"".concat(this.name,"enablepin"),name:"".concat(this.name,"enablepin")}},{name:"on_boot",config:{priority:100,then:[{"switch.turn_on":"".concat(this.name,"enablepin")},{wait_until:{condition:{"mqtt.connected":null}}},{"component.update":"".concat(this.name,"modbuscontrollerid")},{delay:"1s"},{"deep_sleep.enter":"ds"}]}},{name:"on_shutdown",config:{priority:700,then:[{"switch.turn_off":"".concat(this.name,"enablepin")}]}}];return this.dpEnabled&&(h=h.concat(m)),h}constructor(r,h,m,u,_,f,g,v){this.name=r,this.platform=h,this.rxPin=m,this.enablePin=u,this.updateInterval=_,this.weightRegister=f,this.weightRegisters2Read=g,this.stateFlagsRegister=v,this.mqttTopicPrefix="",this.dpEnabled=!1}}function tu(r,h,m,u,_,f,g){return new tp(r,"modbus",h,m,u,_,f,g)}class t_{getPlatform(){return this.platform}setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{componentName:"i2c",payload:"    sda: ".concat(r,"\n    scl: ").concat(this.sclPin,"\n    #scan: true\n    id: ").concat(this.i2cBusId,"\n")},{componentName:"sensor",payload:"    - platform: ".concat(this.platform," \n      id: ").concat(this.name,"\n      name: ").concat(this.name,"\n      address: ").concat(this.address,"\n      update_interval: ").concat(this.updateInterval,"\n")}]}constructor(r,h,m,u,_,f){this.name=r,this.platform=h,this.address=m,this.updateInterval=u,this.i2cBusId=_,this.sclPin=f,this.mqttTopicPrefix=""}}function tf(r,h,m,u){return new t_(r,"bh1750",m,u,"bus_a",h)}class tg{getPlatform(){return this.platform}setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{componentName:"i2c",payload:"    sda: ".concat(r,"\n    scl: ").concat(this.sclPin,"\n    #scan: true\n    id: ").concat(this.i2cBusId,"\n")},{componentName:"sensor",payload:"    - platform: ".concat(this.platform," \n      id: ").concat(this.name,"\n      address: ").concat(this.address,"\n      update_interval: ").concat(this.updateInterval,'\n      pm_1_0:\n        name: "').concat(this.name,'-pm1-0"\n      pm_2_5:\n        name: "').concat(this.name,'-pm2-5"\n      pm_10_0:\n        name: "').concat(this.name,'-pm10-0"\n      aqi:\n        name: "').concat(this.name,'-aqi"\n        calculation_type: "CAQI"\n')}]}constructor(r,h,m,u,_,f){this.name=r,this.platform=h,this.address=m,this.updateInterval=u,this.i2cBusId=_,this.sclPin=f,this.mqttTopicPrefix=""}}function ty(r,h,m,u){return new tg(r,"hm3301",m,u,"bus_a",h)}class tb{getPlatform(){return this.platform}setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{componentName:"i2c",payload:"    sda: ".concat(r,"\n    scl: ").concat(this.sclPin,"\n    #scan: true\n    id: ").concat(this.i2cBusId,"\n")},{componentName:"sensor",payload:"    - platform: ".concat(this.platform," \n      id: ").concat(this.name,"\n      address: ").concat(this.address,"\n      update_interval: ").concat(this.updateInterval,"\n      nitrogen_dioxide:\n        name: ").concat(this.name,"-nitrogen-dioxide\n      carbon_monoxide:\n        name: ").concat(this.name,"-carbon-monoxide\n      hydrogen:\n        name: ").concat(this.name,"-hydrogen\n      ethanol:\n        name: ").concat(this.name,"-ethanol\n      methane:\n        name: ").concat(this.name,"-methane\n      ammonia:\n        name: ").concat(this.name,"-ammonia\n")}]}constructor(r,h,m,u,_,f){this.name=r,this.platform=h,this.address=m,this.updateInterval=u,this.i2cBusId=_,this.sclPin=f,this.mqttTopicPrefix=""}}function tv(r,h,m,u){return new tb(r,"mics_4514",m,u,"bus_a",h)}class tw{attach(r,h){let m=[{name:this.type,config:{platform:this.platform,id:this.name,address:this.address,update_interval:this.updateInterval,accel_x:{name:"".concat(this.name,"-accel-x")},accel_y:{name:"".concat(this.name,"-accel-y")},accel_z:{name:"".concat(this.name,"-accel-z")},gyro_x:{name:"".concat(this.name,"-gyro-x")},gyro_y:{name:"".concat(this.name,"-gyro-y")},gyro_z:{name:"".concat(this.name,"-gyro-z")}},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{name:this.name,type:this.type,monitors:[{name:"accel_x",label:"Accelerometer X",description:"Get accelerometer X axis status",units:"m/s\xb2",endpoint:"/sensor/"+this.name+"-accel-x/state",connectionType:"mqtt"},{name:"accel_y",label:"Accelerometer Y",description:"Get accelerometer Y axis status",units:"m/s\xb2",endpoint:"/sensor/"+this.name+"-accel-y/state",connectionType:"mqtt"},{name:"accel_z",label:"Accelerometer Z",description:"Get accelerometer Z axis status",units:"m/s\xb2",endpoint:"/sensor/"+this.name+"-accel-z/state",connectionType:"mqtt"},{name:"gyro_x",label:"Gyroscope X",description:"Get gyroscope X axis status",units:"\xb0/s",endpoint:"/sensor/"+this.name+"-gyro-x/state",connectionType:"mqtt"},{name:"gyro_y",label:"Gyroscope Y",description:"Get gyroscope Y axis status",units:"\xb0/s",endpoint:"/sensor/"+this.name+"-gyro-y/state",connectionType:"mqtt"},{name:"gyro_z",label:"Gyroscope Z",description:"Get gyroscope Z axis status",units:"\xb0/s",endpoint:"/sensor/"+this.name+"-gyro-z/state",connectionType:"mqtt"}]}}constructor(r,h,m,u,_){this.type="sensor",this.name=r,this.platform=h,this.address=u,this.updateInterval=_,this.i2cBusId=m}}function tS(r,h,m,u){return new tw(r,"mpu6050",h,m,u)}class tx{setMqttTopicPrefix(r){this.mqttTopicPrefix=r}attach(r){return[{componentName:"i2c",payload:"    sda: ".concat(r,"\n    scl: ").concat(this.sclPin,"\n    #scan: true\n    id: ").concat(this.i2cBusId,"\n")},{componentName:"sensor",payload:"    - platform: bh1750\n      id: ".concat(this.name,"bh1750\n      name: ").concat(this.name,"bh1750\n      address: ").concat(this.bh1750Address,"\n      update_interval: ").concat(this.updateInterval,"\n")},{componentName:"sensor",payload:"    - platform: hm3301 \n      id: ".concat(this.name,"hm3301\n      address: ").concat(this.hm3301Address,"\n      update_interval: ").concat(this.updateInterval,'\n      pm_1_0:\n        name: "').concat(this.name,'-hm3301-pm1-0"\n      pm_2_5:\n        name: "').concat(this.name,'-hm3301-pm2-5"\n      pm_10_0:\n        name: "').concat(this.name,'-hm3301-pm10-0"\n      aqi:\n        name: "').concat(this.name,'-hm3301-aqi"\n        calculation_type: "CAQI"\n')},{componentName:"sensor",payload:"    - platform: mics_4514 \n      id: ".concat(this.name,"sen0377\n      address: ").concat(this.sen0377Address,"\n      update_interval: ").concat(this.updateInterval,"\n      nitrogen_dioxide:\n        name: ").concat(this.name,"-sen0377-nitrogen-dioxide\n      carbon_monoxide:\n        name: ").concat(this.name,"-sen0377-carbon-monoxide\n      hydrogen:\n        name: ").concat(this.name,"-sen0377-hydrogen\n      ethanol:\n        name: ").concat(this.name,"-sen0377-ethanol\n      methane:\n        name: ").concat(this.name,"-sen0377-methane\n      ammonia:\n        name: ").concat(this.name,"-sen0377-ammonia\n")},,{componentName:"sensor",payload:"    - platform: mpu6050\n      id: ".concat(this.name,"mpu6050\n      address: ").concat(this.mpu6050Address,"\n      update_interval: ").concat(this.updateInterval,'\n      accel_x:\n        name: "').concat(this.name,'-mpu6050-accel-x"\n      accel_y:\n        name: "').concat(this.name,'-mpu6050-accel-y"\n      accel_z:\n        name: "').concat(this.name,'-mpu6050-accel-z"\n      gyro_x:\n        name: "').concat(this.name,'-mpu6050-gyro-x"\n      gyro_y:\n        name: "').concat(this.name,'-mpu6050-gyro-y"\n      gyro_z:\n        name: "').concat(this.name,'-mpu6050-gyro-z"\n      temperature:\n        name: "').concat(this.name,'-mpu6050-temperature"\n')}]}constructor(r,h,m,u,_,f,g,v){this.name=r,this.sclPin=h,this.updateInterval=m,this.i2cBusId=u,this.mqttTopicPrefix="",this.bh1750Address=_,this.hm3301Address=f,this.sen0377Address=g,this.mpu6050Address=v}}function tE(r,h,m,u,_,f,g){return new tx(r,h,m,"bus_a",u,_,f,g)}class tI{attach(r,h){let m=[{name:this.type,config:{platform:this.platform,id:this.name,address:this.address,update_interval:this.updateInterval,pm_1_0:{name:"".concat(this.name,"-pm1-0")},pm_2_5:{name:"".concat(this.name,"-pm2-5")},pm_4_0:{name:"".concat(this.name,"-pm4-0")},pm_10_0:{name:"".concat(this.name,"-pm10-0")},temperature:{name:"".concat(this.name,"-temperature")},humidity:{name:"".concat(this.name,"-humidity")},nox:{name:"".concat(this.name,"-nox")},voc:{name:"".concat(this.name,"-voc")}},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{name:this.name,type:this.type,monitors:[{name:"pm1.0",label:"Pm1.0",description:"Get pm1.0 status",units:"\xb5g/m\xb3",endpoint:"/sensor/"+this.name+"-pm1-0/state",connectionType:"mqtt"},{name:"pm2.5",label:"Pm2.5",description:"Get pm2.5 status",units:"\xb5g/m\xb3",endpoint:"/sensor/"+this.name+"-pm2-5/state",connectionType:"mqtt"},{name:"pm4.0",label:"Pm4.0",description:"Get pm4.0 status",units:"\xb5g/m\xb3",endpoint:"/sensor/"+this.name+"-pm4-0/state",connectionType:"mqtt"},{name:"pm10.0",label:"Pm10.0",description:"Get pm10.0 status",units:"\xb5g/m\xb3",endpoint:"/sensor/"+this.name+"-pm10-0/state",connectionType:"mqtt"},{name:"temperature",label:"Temperature",description:"Get temperature status",units:"\xbaC",endpoint:"/sensor/"+this.name+"-temperature/state",connectionType:"mqtt"},{name:"humidity",label:"Humidity",description:"Get humidity status",units:"%",endpoint:"/sensor/"+this.name+"-humidity/state",connectionType:"mqtt"},{name:"nox",label:"NOx",description:"Get NOX status",endpoint:"/sensor/"+this.name+"-nox/state",connectionType:"mqtt"},{name:"voc",label:"VOC",description:"Get VOC status",endpoint:"/sensor/"+this.name+"-voc/state",connectionType:"mqtt"}]}}constructor(r,h,m,u,_){this.type="sensor",this.name=r,this.platform=h,this.address=u,this.updateInterval=_,this.i2cBusId=m}}function tT(r,h,m,u){return new tI(r,"sen5x",h,m,u)}class tA{attach(r,h){let m=[{name:this.type,config:{platform:this.platform,id:this.name,uart_id:this.uartBusId,update_interval:this.updateInterval,co2:{name:"".concat(this.name,"-co2")},temperature:{name:"".concat(this.name,"-temperature")}},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{name:this.name,type:this.type,monitors:[{name:"CO_2",description:"Get CO_2 status",units:"ppm",endpoint:"/"+this.type+"/"+this.name+"-co2/state",connectionType:"mqtt"},{name:"CO_2-temp",description:"Get CO_2 status",units:"\xbaC",endpoint:"/"+this.type+"/"+this.name+"-temperature/state",connectionType:"mqtt"}]}}constructor(r,h,m,u){this.type="sensor",this.name=r,this.platform=h,this.uartBusId=m,this.updateInterval=u,this.mqttTopicPrefix=""}}function tP(r,h,m){return new tA(r,"mhz19",h,m)}class tD{attach(r,h){let m=[{name:this.type,config:{id:this.id,sda:r,scl:this.scl,scan:this.scan},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{}}constructor(r,h,m){this.type="i2c",this.scl=h,this.scan=m,this.id=r}}function tC(r,h,m){return new tD(r,h,m)}class tO{getOutputComponents(){let r=[];for(var h=0;h<16;h++){let m={name:"output",config:{platform:"pca9685",pca9685_id:this.name,channel:h,id:this.name+"_channel_"+h},subsystem:{}};r.push(m)}return r}attach(r,h){let m=[{name:this.type,config:{id:this.name,...this.external_clock_input?{}:{frequency:this.frequency},external_clock_input:this.external_clock_input,address:this.address,i2c_id:this.i2cBusId},subsystem:this.getSubsystem()}],u=this.getOutputComponents();return(m=m.concat(u)).forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{}}constructor(r,h,m,u,_){this.type="pca9685",this.name=r,this.frequency=h,this.external_clock_input=m,this.address=u,this.i2cBusId=_}}function tR(r,h,m,u,_){return new tO(r,h,m,u,_)}class tk{attach(r,h){return[{name:"ethernet",config:{type:this.type,mdc_pin:this.mdc_pin,mdio_pin:this.mdio_pin,clk_mode:this.clk_mode,phy_addr:this.phy_addr,power_pin:this.power_pin},subsystem:this.getSubsystem()}].forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{}}constructor(r,h,m,u,_,f){this.type=r,this.mdc_pin=h,this.mdio_pin=m,this.clk_mode=u,this.phy_addr=_,this.power_pin=f}}function tL(r,h,m,u,_,f){return new tk(r,h,m,u,_,f)}class tN{attach(r,h){let m=[{name:"external_components",config:[{source:{type:"git",url:"https://github.com/u-fire/ESPHomeComponents/"}}]},{name:"i2c",config:{sda:r,scl:this.scl},subsystem:this.getSubsystem()},{name:this.type,config:{platform:"mod_ntc",id:"water_temp",name:"water-temp",on_value:{then:[{"component.update":"ec"},{"component.update":"ph"}]}},subsystem:this.getSubsystem()},{name:this.type,config:{platform:"mod_ec",id:"ec",update_interval:this.updateInterval,name:"EC",temperature_sensor:"water_temp"},subsystem:this.getSubsystem()},{name:this.type,config:{platform:"mod_ph",id:"ph",update_interval:this.updateInterval,name:"pH",temperature_sensor:"water_temp"},subsystem:this.getSubsystem()},{name:"button",config:{platform:"template",id:"ec_calibrate_low",name:"EC Calibrate Low 0.5",on_press:{lambda:"return id(ec).calibrateLow(0.5);"}}},{name:"button",config:{platform:"template",id:"ec_calibrate_high",name:"EC Calibrate High 5.0",on_press:{lambda:"return id(ec).calibrateHigh(5.0);"}}},{name:"button",config:{platform:"template",id:"ec_calibrate_reset",name:"EC Calibrate Reset",on_press:{lambda:"return id(ec).calibrateReset();"}}},{name:"button",config:{platform:"template",id:"ph_calibrate_low",name:"pH Calibrate Low 4.0",on_press:{lambda:"return id(ph).calibrateLow(4.0);"}}},{name:"button",config:{platform:"template",id:"ph_calibrate_mid",name:"pH Calibrate Mid 7.0",on_press:{lambda:"return id(ph).calibrateMid(7.0);"}}},{name:"button",config:{platform:"template",id:"ph_calibrate_high",name:"pH Calibrate High 10.0",on_press:{lambda:"return id(ph).calibrateHigh(10.0);"}}},{name:"button",config:{platform:"template",id:"ph_calibrate_reset",name:"pH Calibrate Reset",on_press:{lambda:"return id(ph).calibrateReset();"}}},{name:"button",config:{platform:"factory_reset",name:"Restart with Factory Default Settings"}}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{name:this.name,type:this.type,monitors:[{name:"Ph",label:"ph",description:"Get sensor status",endpoint:"/"+this.type+"/ph/state",connectionType:"mqtt"},{name:"Water Temperature",label:"water-temp",description:"Get sensor status",endpoint:"/"+this.type+"/water-temp/state",connectionType:"mqtt"},{name:"EC",label:"ec",description:"Get sensor status",endpoint:"/"+this.type+"/ec/state",connectionType:"mqtt"}]}}constructor(r,h,m){this.name=r,this.platform="mod_ntc",this.scl=m,this.type="sensor",this.updateInterval=h}}function tM(r,h,m){return new tN(r,m,h)}class tF{attach(r,h){let m=[{name:this.type,config:{id:this.id,tx_pin:r,rx_pin:this.rx,baud_rate:this.baudrate},subsystem:this.getSubsystem()}];return m.forEach((r,m)=>{h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name]=[...h[r.name],r.config]):h[r.name]=r.config}),h}getSubsystem(){return{}}constructor(r,h,m){this.type="uart",this.rx=h,this.baudrate=m,this.id=r}}function tq(r,h,m){return new tF(r,h,m)}class tG{extractNestedComponents(r,h){let m=[{key:"mqtt",nestedKey:"on_message"},{key:"esphome",nestedKey:"on_boot"}];m.forEach(m=>{let{key:u,nestedKey:_}=m;r.config[_]&&(h[u]||(h[u]={}),h[u][_]||(h[u][_]=[]),Array.isArray(h[u][_])?h[u][_].push(...r.config[_]):h[u][_]={...h[u][_],...r.config[_]})})}exctractComponent(r,h){["mqtt","esphome"].includes(r.name)?this.extractNestedComponents(r,h):h[r.name]?(Array.isArray(h[r.name])||(h[r.name]=[h[r.name]]),h[r.name].push(r.config)):h[r.name]=r.config}attach(r,h){let m=[{name:this.type,config:{platform:this.platform,id:this.name,step_pin:r,dir_pin:this.dirPin,max_speed:this.maxSpeed,acceleration:this.acceleration,deceleration:this.deceleration},subsystem:this.getSubsystem()},{name:"switch",config:{platform:"gpio",pin:this.sleepPin,name:this.name+"_sleep_switch",id:this.name+"_sleep_switch",restore_mode:"ALWAYS_ON"}},{name:"mqtt",config:{on_message:[{topic:"devices/".concat(h.esphome.name,"/").concat(this.type,"/").concat(this.name,"/set_target"),then:{lambda:"id(".concat(this.name,"_sleep_switch).turn_off();\nint value = atoi(x.c_str());\nid(").concat(this.name,').set_target(value);\nESP_LOGD("Set target", "').concat(this.name,' stepper target set to: %d",  value);\n')}}]}},{name:"mqtt",config:{on_message:[{topic:"devices/".concat(h.esphome.name,"/").concat(this.type,"/").concat(this.name,"/set_max_speed"),then:{lambda:"int value = atoi(x.c_str());\nif (value > 0){\n  id(".concat(this.name,').set_max_speed(value);\n  ESP_LOGD("Set max speed", "').concat(this.name,' stepper max speed set to: %d",  value);\n} else {\n  ESP_LOGD("Set max speed", "').concat(this.name,' invalid max speed value");\n}')}}]}},{name:"mqtt",config:{on_message:[{topic:"devices/".concat(h.esphome.name,"/").concat(this.type,"/").concat(this.name,"/set_acceleration"),then:{lambda:"int value = atoi(x.c_str());\nif (value > 0){\n  id(".concat(this.name,').set_acceleration(value);\n  ESP_LOGD("Set acceleration", "').concat(this.name,' stepper acceleration set to: %d",  value);\n} else {\n  ESP_LOGD("Set acceleration", "').concat(this.name,' invalid acceleration value");\n}')}}]}},{name:"mqtt",config:{on_message:[{topic:"devices/".concat(h.esphome.name,"/").concat(this.type,"/").concat(this.name,"/set_deceleration"),then:{lambda:"int value = atoi(x.c_str());\nif (value > 0){\n  id(".concat(this.name,').set_acceleration(value);\n  ESP_LOGD("Set deceleration", "').concat(this.name,' stepper deceleration set to: %d",  value);\n} else {\n  ESP_LOGD("Set deceleration", "').concat(this.name,' invalid deceleration value");\n}\n')}}]}},{name:"mqtt",config:{on_message:[{topic:"devices/".concat(h.esphome.name,"/").concat(this.type,"/").concat(this.name,"/report_position"),then:{lambda:"int value = atoi(x.c_str());\nid(".concat(this.name,').report_position(value);\nESP_LOGD("Report position", "').concat(this.name,' stepper report position set to: %d",  value);\n')}}]}}];return m.forEach((r,m)=>{this.exctractComponent(r,h)}),h}getSubsystem(){return{name:this.name,type:this.type,actions:[{name:"set_target",label:"Set target",description:"Sets target of the stepper",endpoint:"/"+this.type+"/"+this.name+"/set_target",connectionType:"mqtt",payload:{type:"str"}},{name:"set_max_speed",label:"Set max speed",description:"Sets speed of the stepper",endpoint:"/"+this.type+"/"+this.name+"/set_max_speed",connectionType:"mqtt",payload:{type:"str"}},{name:"set_acceleration",label:"Set acceleration",description:"Sets acceleration of the stepper",endpoint:"/"+this.type+"/"+this.name+"/set_acceleration",connectionType:"mqtt",payload:{type:"str"}},{name:"set_deceleration",label:"Set deceleration",description:"Sets deceleration of the stepper",endpoint:"/"+this.type+"/"+this.name+"/set_deceleration",connectionType:"mqtt",payload:{type:"str"}},{name:"report_position",label:"Report position",description:"Reports position of the stepper",endpoint:"/"+this.type+"/"+this.name+"/report_position",connectionType:"mqtt",payload:{type:"str"}},{name:"hold_motor",label:"Hold motor",description:"Holds the motor power, so it doesn't move",endpoint:"/switch/"+this.name+"_sleep_switch/command",connectionType:"mqtt",payload:{type:"str",value:"OFF"}},{name:"release_motor",label:"Release motor",description:"Releases the motor power, so it can move",endpoint:"/switch/"+this.name+"_sleep_switch/command",connectionType:"mqtt",payload:{type:"str",value:"ON"}}]}}constructor(r,h,m,u,_,f,g){this.type="stepper",this.name=r,this.platform=h,this.dirPin=m,this.maxSpeed=u,this.sleepPin=_,this.acceleration=f,this.deceleration=g}}var tj={wifi:_,mqtt:g,deepSleep:w,device:A,output:O,binarySensor:E,neopixelsBus:D,relay:L,GPIOSwitch:N,adcSensor:F,capacitiveSoilMoistureSensor:K,pulseCounter:G,ledcOutput:U,pirSensor:B,hx711:W,nfcReader:X,ultrasonicDistanceSensor:Y,isOutput:tt,dfplayer:tn,xiaomiMiFlora:ta,climateIR:tr,servo:tc,mpr121:td,tempHumidity:tm,modbusLoadCell:tu,bh1750:tf,hm3301:ty,sen0377:tv,mpu6050:tS,i2cSensorMatrix:tE,sen55:tT,mhz19:tP,i2cBus:tC,pca9685:tR,ethernet:tL,microfirePhEcTemp:tM,uartBus:tq,a4988:function(r,h,m,u,_,f){return new tG(r,"a4988",h,m,u,_,f)}}},36076:function(r,h,m){"use strict";m.d(h,{I:function(){return u}});let u={name:"ESPHome",version:"2022.12.8",home_assistant_domain:"esphome",funding_url:"https://esphome.io/guides/supporters.html",builds:[{chipFamily:"ESP32",parts:[{path:"https://firmware.esphome.io/esphome-web-esp32/esphome-web-esp32.bin",offset:0}]},{chipFamily:"ESP32-C3",parts:[{path:"https://firmware.esphome.io/esphome-web-esp32c3/esphome-web-esp32c3.bin",offset:0}]},{chipFamily:"ESP32-S2",parts:[{path:"https://firmware.esphome.io/esphome-web-esp32s2/esphome-web-esp32s2.bin",offset:0}]},{chipFamily:"ESP32-S3",parts:[{path:"https://firmware.esphome.io/esphome-web-esp32s3/esphome-web-esp32s3.bin",offset:0}]},{chipFamily:"ESP8266",parts:[{path:"https://firmware.esphome.io/esphome-web-esp8266/esphome-web-esp8266.bin",offset:0}]}]}},5436:function(r,h,m){"use strict";m.d(h,{_:function(){return u}});let u=r=>new Promise(h=>setTimeout(h,r))},79897:function(){},47533:function(){},76649:function(){}}]);