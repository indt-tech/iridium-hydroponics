(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2158],{68918:function(e,t,r){"use strict";r.d(t,{d:function(){return l}});var s=r(78161),a=r(2784),o=r(73675),n=r(52322);let i=e=>{let{color:t="black",size:r=24,...s}=e;return(0,n.jsxs)(o.ny,{width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:`${t}`,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[(0,n.jsx)(o.y$,{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",stroke:`${t}`}),(0,n.jsx)(o.aH,{points:"15 3 21 3 21 9",stroke:`${t}`}),(0,n.jsx)(o.x1,{x1:"10",x2:"21",y1:"14",y2:"3",stroke:`${t}`})]})};i.displayName="ExternalLink";let l=(0,a.memo)((0,s.H)(i))},17165:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pages",function(){return r(17208)}])},17208:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return U}});var s=r(52322),a=r(52725),o=r(13997),n=r(48115),i=r(40214),l=r(50897),d=r(71932),c=r(79562),_=r(1888),p=r(30195),x=r(56305),m=r(89929),u=r(53763),b=r(8939),h=r(68918),f=r(89560),j=r(82695),g=r(6429),w=r(2784),v=r(6289),$=r(26887),k=r(5632),y=r(51813),N=r(80330),C=r(24066),P=r(57643),E=r(82614),S=r(91838),H=r(22287),F=r(66306),z=r(70396);let A=e=>{var t;let{template:r,isSelected:a,onPress:o,theme:n}=e,[i,l]=(0,w.useState)(!1),d="/images/templates/".concat(r.id,"-").concat(n,".png");return(0,s.jsx)(S.I,{children:(0,s.jsxs)(b.FA,{id:"pages-template-"+r.id,onPress:o,onHoverIn:()=>l(!0),onHoverOut:()=>l(!1),overflow:"hidden",borderWidth:a?"$1":"$0.5",borderColor:a?"$color7":"$gray8",cursor:"pointer",borderRadius:"$3",children:[(0,s.jsx)(H.E,{source:{height:180,width:357,uri:d}}),(0,s.jsx)("div",{className:(0,z.concatClassName)(" _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _mih-0px _miw-0px _fs-0  _zi-10000 _pos-absolute _r-1481558214 _t-1481558214  "+(i?" _dsp-block":" _dsp-none")),children:(0,s.jsx)(E.p,{target:"_blank",href:d,children:(0,s.jsx)(F.zx,{backgroundColor:"$color7",size:"$1.5",borderRadius:"$1",px:"$2",textProps:{size:"$1"},onPress:e=>{e.stopPropagation()},children:"preview"})})}),(0,s.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _jc-441309761 _btw-1481558338 _btc-791969557 _brc-791969557 _bbc-791969557 _blc-791969557 _bg-791969402 _pt-1481558276 _pb-1481558276 _pr-1481558214 _pl-1481558214 _bts-solid ",children:(0,s.jsx)("p",{className:"  is_Paragraph _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _ff-299667014 _fow-233016140 _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto font_body ",children:null!==(t=r.name)&&void 0!==t?t:r.id})})]})})};r(57117);var L=r(81974),Z=r(36701);let I={},V="/adminapi/v1/pages",D="/adminapi/v1/objects?all=1",O=e=>{let{children:t}=e;return(0,s.jsx)("div",{className:"  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _jc-center _ai-center _gap-25px _fw-wrap ",children:t})},M=e=>{let{selected:t,setSelected:r}=e,a=(0,x.C)();return(0,s.jsxs)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 ",children:[(0,s.jsx)(m.p,{mah:"500px",children:(0,s.jsx)(O,{children:Object.entries(Z.H).map(e=>{let[o,n]=e;return(0,s.jsx)(A,{theme:a,template:n,isSelected:t===o,onPress:()=>r(o)})})})}),(0,s.jsx)("span",{className:"  is_Spacer _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-1316330176 _miw-1316330176 _fs-0 _w-1316330176 _h-1316330176 _pe-none _mb-1316330331 "})]})},T=e=>{let{data:t,setData:r,error:o,setError:n,objects:i}=e;return(0,s.jsx)(C.G,{externalErrorHandling:!0,error:o,setError:n,data:t,setData:r,name:"page",numColumns:2,mode:"add",title:"",model:a.L,extraFields:Z.H[t.data.template].extraFields?Z.H[t.data.template].extraFields(i):{}})};var W={pages:{component:e=>{var t;let{pageState:r,initialItems:_,pageSession:m,extraData:g}=e,C={data:{web:!0,electron:!1,protected:!1,template:"blank"}};(0,k.useRouter)();let{replace:E}=(0,j.N)(r),[S,H]=(0,w.useState)(null!==(t=null==g?void 0:g.objects)&&void 0!==t?t:(0,v.E)("pending")),[F,A]=(0,w.useState)(!1);(0,x.C)();let[O,W]=(0,w.useState)(C),B=(0,u.Py)(),[R,U]=(0,w.useState)("");(0,P.rf)(()=>{U(""),W(C)},[F]),(0,$.a)(e=>{n.bl.get({url:D},e)},H,null==g?void 0:g.objects);let X=e=>{let t=L.T[document.location.hostname.split(".")[0]];return t&&t.baseUrl?t.baseUrl+e:e};return(0,s.jsxs)(i.D,{title:"Pages",pageSession:m,children:[(0,s.jsx)(y.a,{integratedChat:!0,p:"$2",pt:"$5",pl:"$5",setOpen:A,open:F,hideAccept:!0,description:"",children:(0,s.jsx)("div",{className:"  _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 _jc-center _ai-center ",children:(0,s.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mr-1316330238 ",children:(0,s.jsx)(N.M,{lastButtonCaption:"Create",onFinish:async()=>{try{let e=a.L.load(O.data);if(Z.H[O.data.template].extraValidation){let e=Z.H[O.data.template].extraValidation(O.data);if(null==e?void 0:e.error)throw e.error}let t=await n.bl.post(V,e.create().getData());if(t.isError)throw t.error;A(!1),B.show("Page created",{message:e.getId()})}catch(e){console.log("original error: ",e),U((0,v.E)("error",null,e instanceof p.z.ZodError?e.flatten():e))}},slides:[{name:"Create new page",title:"Select your Template",component:(0,s.jsx)(M,{selected:null==O?void 0:O.data.template,setSelected:e=>W({...O,data:{...O.data,template:e}})})},{name:"Configure your page",title:"Configure your page",component:(0,s.jsx)(T,{error:R,objects:S,setError:U,data:O,setData:W})}]})})})}),(0,s.jsx)(o.V,{integratedChat:!0,sourceUrl:V,initialItems:_,numColumnsForm:2,name:"page",rowIcon:()=>(0,s.jsx)(s.Fragment,{}),objectProps:{columnWidth:500},columns:l.Z.columns(l.Z.column("","",!0,e=>(0,s.jsx)("a",{href:X(e.route.startsWith("/")?e.route:"/"+e.route),target:"_blank",children:(0,s.jsx)(d.z,{Icon:h.d})}),!0,"50px"),l.Z.column("name","name",!0,e=>(0,s.jsx)(b.sL,{id:"pages-datatable-"+e.name,children:e.name})),l.Z.column("route","route",!0),l.Z.column("visibility","protected",!0,e=>e.protected?(0,s.jsx)(c.A,{text:"protected",color:"$gray5"}):(0,s.jsx)(c.A,{text:"public",color:"$color5"})),l.Z.column("permissions","permissions",!0,e=>e.permissions.map((e,t)=>(0,s.jsx)("div",{className:(0,z.concatClassName)(" _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0  "+(t?" _ml-10px":" _ml-0px")),children:(0,s.jsx)(c.A,{text:e,color:"$gray5"})},t)))),onAddButton:()=>{A(!0)},extraMenuActions:[{text:"Edit Page file",icon:f.z,action:e=>{E("editFile",e.getDefaultFilePath())},isVisible:e=>!0}],model:a.L,pageState:r,icons:I})]})},getServerSideProps:(0,_.eq)(V,["admin"],{},async e=>({objects:await n.bl.get((0,g.VM)(D,e))}))}};r(73344);var B=r(97729),R=r.n(B);function U(e){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R(),{children:(0,s.jsx)("title",{children:"Protofy - Pages"})}),(0,s.jsx)(W.pages.component,{...e})]})}},57117:function(){},73344:function(){}},function(e){e.O(0,[8641,8081,4733,1335,8873,2859,9795,3950,4575,546,3532,2905,1004,6076,2029,7594,6649,9774,2888,179],function(){return e(e.s=17165)}),_N_E=e.O()}]);