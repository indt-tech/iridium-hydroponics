(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2013,4305],{68425:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/apis",function(){return a(21310)}])},21310:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ef}});var r=a(52322),s=a(75370),i=a(54283);let n=s.V_.object({name:s.V_.string().id().static()}),o=i.$.createDerived("ObjectModel",n);var l=a(48115),d=a(40214),c=a(51813),p=a(13997),_=a(50897),m=a(45734),u=a(59928),h=a(8939),x=a(89929),f=a(88505),b=a(78161),g=a(2784),v=a(87656);let j=e=>{let{color:t="black",size:a=24,...s}=e;return(0,r.jsxs)(v.Svg,{width:a,height:a,viewBox:"0 0 24 24",fill:"none",stroke:`${t}`,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[(0,r.jsx)(v.Path,{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",stroke:`${t}`}),(0,r.jsx)(v.Circle,{cx:"12",cy:"12",r:"3",stroke:`${t}`})]})};j.displayName="Eye";let w=(0,g.memo)((0,b.H)(j));var y=a(60166),N=a(30195),S=a(82695),P=a(6429),I=a(1201),k=a(79562),z=a(10836),C=a(28044),$=a(3559),A=a(93976),O=a(52415);let D=N.z.object({type:N.z.string(),options:N.z.any()});N.z.object({resources:N.z.array(D),menu:N.z.any()});let F=s.V_.object({name:N.z.string().search().id()}),T=i.$.createDerived("WorkspaceModel",F);var E=a(43657);(0,E.jb)("features",{AutoAPI:!0});let Z=s.V_.object((0,E.jb)("schema",{name:N.z.string()})),L=s.V_.object({...s.Pp.shape,...Z.shape}),R=i.$.createDerived("PatataModel",L,"patatas","/api/v1/");(0,E.jb)("features",{AutoAPI:!0});let M=s.V_.object((0,E.jb)("schema",{name:N.z.string()})),q=s.V_.object({...s.Pp.shape,...M.shape}),U=i.$.createDerived("NewModel",q,"news","/api/v1/");(0,E.jb)("features",{});let V=s.V_.object((0,E.jb)("schema",{})),W=s.V_.object({...s.Pp.shape,...V.shape}),B=i.$.createDerived("FwefwModel",W,"fwefws","/api/v1/");(0,E.jb)("features",{});let G=s.V_.object((0,E.jb)("schema",{})),J=s.V_.object({...s.Pp.shape,...G.shape}),H=i.$.createDerived("EeeeeeModel",J,"eeeeees","/api/v1/");(0,E.jb)("features",{});let K=s.V_.object((0,E.jb)("schema",{name:N.z.string()})),X=s.V_.object({...s.Pp.shape,...K.shape}),Y=i.$.createDerived("TesoroModel",X,"tesoros","/api/v1/");(0,E.jb)("features",{});let Q=s.V_.object((0,E.jb)("schema",{precio:N.z.string()})),ee=s.V_.object({...s.Pp.shape,...Q.shape}),et=i.$.createDerived("ZanahoriaModel",ee,"zanahorias","/api/v1/");var ea=(0,E.jb)("objects",{patata:R,new:U,fwefw:B,eeeeee:H,tesoro:Y,zanahoria:et});let er={event:A.Yq,user:C.T,group:$.d,object:O.Wk,workspace:T,api:o,...ea};var es=a(91838),ei=a(26887),en=a(6289),eo=a(1888),el=a(70396);let ed="  _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-36 _mr-0px _mb-1481558152 _ml-0px ",ec={},ep=e=>{let{method:t,path:a,description:s,children:i}=e,[n,o]=(0,g.useState)([""]);return(0,r.jsx)(m.U,{onValueChange:e=>o(e),onPress:e=>e.stopPropagation(),type:"multiple",boc:"$gray6",f:1,mb:"$5",width:"640px",children:(0,r.jsxs)(m.U.Item,{br:"$5",bw:1,boc:"$gray6",value:"item",children:[(0,r.jsx)(m.U.Trigger,{p:0,px:8,height:43,bc:"$transparent",focusStyle:{bc:"$transparent"},br:n.includes("item")?"$0":"$5",btlr:"$5",btrr:"$5",bw:"$0",flexDirection:"row",ai:"center",children:e=>{let{open:i}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mt-1481558214 ",children:(0,r.jsx)(em,{method:t,path:a,description:s})}),(0,r.jsx)(u.b,{animation:"quick",rotate:i?"180deg":"0deg",children:(0,r.jsx)(y._,{size:"$1"})})]})}}),(0,r.jsx)(m.U.Content,{f:1,br:"$5",children:i})]})})},e_=e=>{let{query:t,desc:a}=e;return(0,r.jsx)(es.I,{children:(0,r.jsxs)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mb-1481558152 _mt-1481558152 ",children:[(0,r.jsx)(k.A,{text:t,color:"$color5",mr:"$3",h:25,w:"100px"}),(0,r.jsxs)("span",{className:"  _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px ",children:[" ",a]})]})})},em=e=>{let{method:t,path:a,description:s}=e;return(0,r.jsx)(es.I,{children:(0,r.jsxs)("div",{className:"  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _pt-10px _pr-1316330393 _pb-10px _pl-10px _mt-5px _mb-1481558152 _w-600px _ai-center ",children:[(0,r.jsxs)(h.sL,{alignItems:"center",space:!0,children:[(0,r.jsx)("div",{className:(0,el.concatClassName)(" _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _pt-1481558276 _pr-1481558276 _pb-1481558276 _pl-1481558276  _btlr-1307609936 _btrr-1307609936 _bbrr-1307609936 _bblr-1307609936  "+("GET"===t?" _bg-549765325":" _bg-549765356")),children:(0,r.jsx)("span",{className:"  _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _fos-14px _fow-bold _col-white _pt-5px _pr-5px _pb-5px _pl-5px _btlr-5px _btrr-5px _bbrr-5px _bblr-5px ",children:t})}),(0,r.jsx)("span",{className:"  _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _fow-bold _fg-1 _fs-1 _fb-auto ",children:a})]}),(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ml-1481558152 ",children:(0,r.jsx)("span",{className:"  _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _col-grey36 _fos-14px ",children:s})})]})})};var eu={apis:{component:e=>{var t,a,s,i,n,m,u,b;let{pageState:v,initialItems:j,pageSession:y,extraData:P}=e,{replace:C}=(0,S.N)(null!=v?v:{});(0,I.G)(()=>'At this moment the user is browsing the Rest API management page. The Rest API management page allows to list, create, read, update and delete API definitions. API definitions are typescript files using express.\n            The system allows to create APIs either from an empty template, or from an AutoCRUD template. The automatic crud template creates an automatic CRUD API for a given object. \n            To Automatic CRUD API generates the following endpoints: get /api/v1/:objectName (list), post /api/v1/:objectName (create), post /api/v1/:objectName/:objectId (update), get /api/v1/:objectName/:objectId/delete (delete) and get /api/v1/:objectName/:objectId (read)\n            the API files are located at /packages/app/bundles/custom/apis. \n            The Automatic CURD system can be manually extended to have more endpoints.\n            The user can edit the API files by clicking on any API, and can choose visual programming using interactive diagrams generated from the source code, or text based tradicional programming to edit the .ts api file.\n            Those APIs allow the user to create pages based on object data. The automatic crud is an "storage" to manage data for a specific object.\n            '+((null==j?void 0:j.isLoaded)?"Currently the system returned the following information: "+JSON.stringify(j.data):""));let[$,A]=(0,g.useState)(!1),[O,D]=(0,g.useState)(null!==(b=null==P?void 0:P.objects)&&void 0!==b?b:(0,en.E)("pending")),[F,T]=(0,g.useState)({}),E={},Z=(null==F?void 0:null===(t=F.data)||void 0===t?void 0:t.object)?er[null==F?void 0:null===(a=F.data)||void 0===a?void 0:a.object]:null;return Z&&(E=Z.getApiOptions()),(0,ei.a)(e=>{l.bl.get({url:"/adminapi/v1/objects?all=1"},e)},D,null==P?void 0:P.objects),(0,r.jsxs)(d.D,{title:"APIs",pageSession:y,children:[(0,r.jsx)(c.a,{acceptCaption:"Close",cancelCaption:"Keep editing",onAccept:async()=>{},open:$,setOpen:A,title:"API Endpoints",description:"",children:(0,r.jsx)(x.p,{maxHeight:"80vh",children:(0,r.jsx)(z.Z,{mt:"$5",children:(0,r.jsxs)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 ",children:[(0,r.jsxs)(ep,{method:"GET",path:E?E.prefix+E.name:"",description:"List all "+(null==F?void 0:null===(s=F.data)||void 0===s?void 0:s.name)+" entries",children:[(0,r.jsx)("span",{className:ed,children:"The list API endpoint is designed to provide a paginated, ordered list of items from a dataset. It accepts several query parameters that allow you to customize the response."}),(0,r.jsx)(e_,{query:"itemsPerPage",desc:"Defines max items returned per page; defaults to 25."}),(0,r.jsx)(e_,{query:"page",desc:"Selects which page of results to retrieve, starting at 0."}),(0,r.jsx)(e_,{query:"orderBy",desc:"Specifies field name to sort the results by."}),(0,r.jsx)(e_,{query:"orderDirection",desc:"Sets sort direction, ascending ('asc') by default, use 'desc' for descending."}),(0,r.jsx)(e_,{query:"all",desc:"If set, returns all results, bypassing pagination."})]}),(0,r.jsxs)(ep,{method:"GET",path:E?E.prefix+E.name+"/:id":"",description:"Reads a "+(null==F?void 0:null===(i=F.data)||void 0===i?void 0:i.name)+" entry by id",children:[(0,r.jsx)("span",{className:ed,children:"This 'read' endpoint is used to fetch a specific item based on its unique id. It implements security checks and custom data transformations."}),(0,r.jsx)(e_,{query:":id",desc:"The unique id of the item to be retrieved from the dataset."})]}),(0,r.jsx)(ep,{method:"POST",path:E?E.prefix+E.name:"",description:"Creates a new "+(null==F?void 0:null===(n=F.data)||void 0===n?void 0:n.name)+" entry",children:(0,r.jsx)("span",{className:ed,children:"The 'create' endpoint is utilized for adding new items to the dataset. It includes data transformations, and event notifications for successful creations."})}),(0,r.jsxs)(ep,{method:"POST",path:E?E.prefix+E.name+"/:id":"",description:"Updates a "+(null==F?void 0:null===(m=F.data)||void 0===m?void 0:m.name)+" entry by id",children:[(0,r.jsx)("span",{className:ed,children:"The 'update' endpoint is used for modifying existing items based on their unique id. It includes data transformation processes, and notifications for each update action."}),(0,r.jsx)(e_,{query:":id",desc:"The unique id of the item to be updated in the dataset."})]}),(0,r.jsxs)(ep,{method:"POST",path:E?E.prefix+E.name+"/:id/delete":"",description:"Deletes a "+(null==F?void 0:null===(u=F.data)||void 0===u?void 0:u.name)+" entry by id",children:[(0,r.jsx)("span",{className:ed,children:"The 'delete' endpoint facilitates the removal of items based on their unique id. It encompasses transformations of the data for deletion, and event notifications for the action performed."}),(0,r.jsx)(e_,{query:":id",desc:"The unique id of the item to be deleted from the dataset."})]})]})})})}),(0,r.jsx)(p.V,{integratedChat:!0,onSelectItem:e=>C("editFile","/packages/app/bundles/custom/apis/"+e.data.name+".ts"),rowIcon:f.S,sourceUrl:"/adminapi/v1/apis",initialItems:j,numColumnsForm:1,name:"api",columns:_.Z.columns(_.Z.column("name","name",!0,e=>(0,r.jsx)(h.sL,{id:"apis-datatable-"+e.name,children:e.name})),_.Z.column("type","type",!0,e=>(0,r.jsx)(k.A,{text:e.type.toUpperCase(),color:"AutoAPI"==e.type?"$color5":"$gray5"})),_.Z.column("object","object",!0,e=>(0,r.jsx)(k.A,{text:e.object,color:"None"==e.object?"$gray5":"$color5"}))),extraFieldsFormsAdd:O.isLoaded?{template:N.z.union([N.z.literal("Automatic CRUD"),N.z.literal("Automatic CRUD (custom storage)"),N.z.literal("IOT Router"),N.z.literal("Custom API")]).after("name"),object:N.z.union([N.z.literal("without object"),...O.data.items.map(e=>N.z.literal(e.name))]).after("name")}:{},extraMenuActions:[{text:"View API details",icon:w,action:e=>{A(!0),T(e),console.log("DATA",e)},isVisible:e=>"AutoAPI"===e.data.type}],model:o,pageState:v,icons:ec})]})},getServerSideProps:(0,eo.F7)(async e=>(0,P.NA)(e,["admin"]))}};a(14528);var eh=a(97729),ex=a.n(eh);function ef(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(ex(),{children:(0,r.jsx)("title",{children:"Protofy - Apis"})}),(0,r.jsx)(eu.apis.component,{...e})]})}},54283:function(e,t,a){"use strict";a.d(t,{$:function(){return l},J:function(){return o}});var r=a(94801),s=a(55858),i=a(53596);let n=(0,i.j)();class o{get(e,t){var a;return null!==(a=this.data[e])&&void 0!==a?a:t}getObjectSchema(){return this.objectSchema}getModelName(){return this.modelName}getLocation(){let e=this.objectSchema.is("location").getFields();if(!e.length)throw"Model error: "+this.getModelName()+" doesn't have location information";let t=e[0],a=this.objectSchema.getFieldKeyDefinition(t,"latKey"),r=this.objectSchema.getFieldKeyDefinition(t,"lonKey");if(this.data[t])return{lat:this.data[t][a],lon:this.data[t][r]}}getId(){return this.data[this.idField]}getNotificationsTopic(e){return"notifications/".concat(this.getModelName(),"/").concat(e,"/").concat(this.getId())}getNotificationsPayload(){return this.serialize()}setId(e,t){return new this.constructor({...t||this.data,[this.idField]:e},this.session,this.modelName)}isVisible(){return!this.isDeleted()}isDeleted(){return!!this.data._deleted}list(e,t,a){if(!e)return this.read();{let{parsed:t,searchWithoutTags:a}=function(e){let t;let a=/(\w+):("[^"]+"|\S+)/g,r={},s=e;for(;null!==(t=a.exec(e));){let e=t[1].toLowerCase(),a=t[2].replace(/"/g,"").toLowerCase();r[e]=a,s=s.replace(t[0],"")}return{parsed:r,searchWithoutTags:s=s.trim()}}(e);for(let[e,a]of Object.entries(t))if(!this.data.hasOwnProperty(e)||this.data[e]!=a){n.debug({data:this.data[e]},"discarded: ".concat(JSON.stringify(this.data[e])));return}let s=this.objectSchema.is("search").getFields();for(var r=0;r<s.length;r++)if((this.data[s[r]]+"").toLowerCase().includes(a.toLowerCase()))return this.read()}}async listTransformed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,s=this.list(e,a,r);if(s)return await this.getObjectSchema().apply("list",s,t)}create(e){let t=this.getData(e);return n.debug({transformed:t},"Creating object: ".concat(JSON.stringify(t))),new this.constructor(t,this.session,this.modelName).validate()}async createTransformed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=await this.getObjectSchema().apply("create",{...this.data},e);return this.create(t)}read(e){return{...this.data}}async readTransformed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=await this.getObjectSchema().apply("read",this.read(t),e);return a}update(e,t){return e.setId(this.getId(),{...t||e.data})}async updateTransformed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await this.getObjectSchema().apply("update",{...e.data},t,{...this.data});return this.update(e,a)}delete(e){return new this.constructor({_deleted:!0,...e||this.data},this.session,this.modelName)}async deleteTransformed(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=await this.getObjectSchema().apply("delete",{...this.data},e);return this.delete(t)}validate(){return this.schema.parse(this.data),this}serialize(){return JSON.stringify(this.data)}static getApiOptions(){throw Error("Derived class must implement getApiOptions")}static _newInstance(e,t){throw Error("Derived class must implement _newInstance.")}static unserialize(e,t){return this._newInstance(JSON.parse(e),t)}static load(e,t){return this._newInstance(e,t)}static sort(e,t,a){return e.sort((e,r)=>e[t]>r[t]?"asc"===a?1:-1:e[t]<r[t]?"asc"===a?-1:1:0)}getData(e){return{...this.getObjectSchema().applyGenerators(null!=e?e:this.data)}}constructor(e,t,a,i){var n,o;this.data=e,this.session=null!=a?a:(0,r.ed)(),this.schema=t,this.objectSchema=s.U.load(this.schema),this.modelName=null!==(n=null==i?void 0:i.toLowerCase())&&void 0!==n?n:"unknown";let l=this.objectSchema.is("id");l.getFields().length>1&&(l=l.isNot("fallbackId")),this.idField=null!==(o=l.getFirst("id"))&&void 0!==o?o:"id"}}class l extends o{static _newInstance(e,t){throw Error("Derived class must implement _newInstance.")}static createDerived(e,t,a,r){class s extends l{static _newInstance(e,t){return new s(e,t)}static getApiOptions(){return{name:a,prefix:r}}constructor(a,r){super(a,t,r,e.substring(0,e.length-5).toLowerCase())}}return s.schemaInstance=t,Object.defineProperty(s,"name",{value:e,writable:!1}),s}constructor(e,t,a,r){super(e,t,a,r)}}},55858:function(e,t,a){"use strict";a.d(t,{U:function(){return s}});var r=a(34406);class s{getFields(){return Object.keys(this.shape)}getFieldKeyDefinition(e,t){return this.shape[e]?this.shape[e]._def[t]:void 0}applyGenerators(e){let t={...e};return Object.keys(this.shape).forEach(a=>{if(this.shape[a]._def.generate){let r=this.shape[a]._def.generate;(!e[a]||r.force)&&(t[a]="function"==typeof r.generator?r.generator(e):r.generator)}}),t}async apply(e,t,a,s){let i={...t},n=this.is("events"),o=Object.keys(n.shape);for(var l=0;l<o.length;l++){let t=o[l],c=n.shape[t],p=void 0!==r&&r.versions&&r.versions.node,_=c._def.events.filter(t=>t.eventName==e&&(!t.eventContext||"client"==t.eventContext&&!p||"server"==t.eventContext&&p));for(var d=0;d<_.length;d++){let e=_[d];a[e.eventHandler]&&(i=await a[e.eventHandler](t,e,i,s))}}return i}getLayout(e){let t=[[]],a=0;return Object.keys(this.shape).forEach(r=>{let s=this.shape[r];t[a].length==e&&(t.push([]),a++),t[a].push({...s,name:r})}),t}getFirst(e){return Object.keys(this.shape).find(t=>{if(this.shape[t]._def[e])return t})}isDisplay(e){let t={};return Object.keys(this.shape).forEach(a=>{(!this.shape[a]._def.display||this.shape[a]._def.display.includes("*")||this.shape[a]._def.display.includes(e))&&(t[a]=this.shape[a])}),new s(t)}is(e){let t={};return Object.keys(this.shape).forEach(a=>{this.shape[a]._def[e]&&(t[a]=this.shape[a])}),new s(t)}isNot(e){let t={};return Object.keys(this.shape).forEach(a=>{this.shape[a]._def[e]||(t[a]=this.shape[a])}),new s(t)}isAfter(e){let t={};return Object.keys(this.shape).forEach(a=>{var r;(null===(r=this.shape[a]._def)||void 0===r?void 0:r.after)&&this.shape[a]._def.after==e&&(t[a]=this.shape[a])}),new s(t)}isBefore(e){let t={};return Object.keys(this.shape).forEach(a=>{var r;(null===(r=this.shape[a]._def)||void 0===r?void 0:r.before)&&this.shape[a]._def.before==e&&(t[a]=this.shape[a])}),new s(t)}merge(e){let t={};return Object.keys(this.shape).forEach(a=>{let r=e.isBefore(a);(t={...t,...r.shape})[a]=this.shape[a];let s=e.isAfter(a);t={...t,...s.shape}}),new s(t)}static load(e){return new s(e.shape)}constructor(e){this.shape=e}}},43657:function(e,t,a){"use strict";a.d(t,{jb:function(){return r}});let r=(e,t)=>t},93976:function(e,t,a){"use strict";a.d(t,{Yq:function(){return p}});var r=a(30195),s=a(43657),i=a(75370),n=a(19034),o=a.n(n),l=a(54283);let d=r.z.object((0,s.jb)("schema",{path:r.z.string().search(),from:r.z.string().search(),user:r.z.string().generate(e=>"me").search(),payload:r.z.record(r.z.string(),r.z.any()).search(),created:r.z.string().generate(e=>o()().toISOString()).search()})),c=r.z.object({...i.Pp.shape,...d.shape});class p extends l.J{list(e){return e?JSON.stringify(this.data).toLowerCase().includes(e.toLowerCase())?this.read():void 0:this.read()}static _newInstance(e,t){return new p(e,t)}constructor(e,t){super(e,c,t,"Event")}}},3559:function(e,t,a){"use strict";a.d(t,{d:function(){return o}});var r=a(30195),s=a(75370),i=a(54283);let n=s.V_.object({name:r.z.string().label("name").hint("user, admin, ...").static().id().search(),workspaces:r.z.array(r.z.string()).hidden(),permissions:r.z.array(r.z.string()).optional(),admin:r.z.boolean().optional()}),o=i.$.createDerived("GroupModel",n)},52415:function(e,t,a){"use strict";a.d(t,{Wk:function(){return l}});var r=a(30195),s=a(54283);let i=r.z.object({id:r.z.string().search().id().generate(e=>e.name.charAt(0).toUpperCase()+e.name.slice(1)+"Model").hidden(),name:r.z.string().search().static(),features:r.z.any().generate({},!0).hidden(),keys:r.z.record(r.z.string().optional(),r.z.object({type:r.z.union([r.z.literal("string"),r.z.literal("number"),r.z.literal("boolean"),r.z.literal("array"),r.z.literal("object"),r.z.literal("record"),r.z.literal("union")]),params:r.z.array(r.z.string()).optional(),modifiers:r.z.array(r.z.object({name:r.z.union([r.z.literal("id"),r.z.literal("search"),r.z.literal("generate"),r.z.literal("display"),r.z.literal("optional"),r.z.literal("email"),r.z.literal("label"),r.z.literal("hint"),r.z.literal("static"),r.z.literal("min"),r.z.literal("max"),r.z.literal("secret"),r.z.literal("onCreate"),r.z.literal("onUpdate"),r.z.literal("onRead"),r.z.literal("onDelete"),r.z.literal("onList"),r.z.literal("name"),r.z.literal("location")]),params:r.z.array(r.z.string()).optional()}).name("name")).optional()}).name("name")).generate({})}),n=r.z.object({...i.shape}),o=e=>({...e,keys:Object.keys(e.keys?e.keys:{}).reduce((t,a)=>({...t,[a]:{type:"string",...e.keys[a]}}),{})});class l extends s.J{getDefaultSchemaFilePath(){return l.getDefaultSchemaFilePath(this.data.name)}static getDefaultSchemaFilePath(e){return"/packages/app/bundles/custom/objects/"+e+".ts"}create(e){let t=null!=e?e:this.getData(),a=o(t);return super.create(a)}update(e,t){let a=null!=t?t:e.data,r=o(a);return super.update(e,r)}static _newInstance(e,t){return new l(e,t)}constructor(e,t){super(e,n,t,"Object")}}},28044:function(e,t,a){"use strict";a.d(t,{T:function(){return d}});var r=a(30195),s=a(75370),i=a(19034),n=a.n(i),o=a(54283);let l=s.V_.object({username:r.z.string().email().label("email").hint("user@example.com").static().id().search(),type:r.z.string().min(1).label("group").hint("user, admin, ...").search().help("The type refers to a group name. Groups contains privileges (admin true/false) and workspaces."),password:r.z.string().min(6).hint("**********").secret().onCreate("cypher").onUpdate("update").onRead("clearPassword").onList("clearPassword").help("Salted hashed password using bcrypt."),permissions:r.z.array(r.z.string()).optional().label("additional permissions"),createdAt:r.z.string().min(1).generate(e=>n()().toISOString()).search().hidden(),lastLogin:r.z.string().optional().search().hidden(),from:r.z.string().min(1).search().generate(e=>"admin").help("Interface used to create the user. Users can be created from command line or from the admin panel").hidden()}),d=o.$.createDerived("UserModel",l)},10347:function(e,t,a){"use strict";a.d(t,{t:function(){return i}});var r=a(52322),s=a(2784);let i=(0,s.createContext)({active:0,setActive:e=>{}}),n=s.forwardRef((e,t)=>{let{initialState:a=0,children:n}=e,[o,l]=(0,s.useState)(a);return(0,r.jsx)(i.Provider,{value:{active:o,setActive:l},children:n})});t.Z=n},91681:function(e,t,a){"use strict";var r=a(52322),s=a(2784),i=a(10347),n=a(17277);let o=s.forwardRef((e,t)=>{let{activeId:a,onSetActive:o=e=>{},...l}=e,{active:d,setActive:c}=(0,s.useContext)(i.t);return(0,r.jsx)(n.Z,{onPress:()=>{o(a),c(a)},theme:a===d?"active":null,chromeless:a!==d,...l})});t.Z=o},61667:function(e,t,a){"use strict";var r=a(52322),s=a(2784),i=a(10347),n=a(52026);let o=s.forwardRef((e,t)=>{let{activeId:a,fast:o=!1,children:l,...d}=e,{active:c}=(0,s.useContext)(i.t),p=c==a;return o?(0,s.useMemo)(()=>(0,r.jsx)(n.Stack,{ref:t,position:"absolute",top:p?0:-1e4,...d,children:l}),[p]):p?(0,r.jsx)(n.Stack,{...d,ref:t,children:l}):null});t.Z=o},50897:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var r=a(52322);a(2784);var s=a(25237),i=a.n(s);let n=i()(()=>Promise.all([a.e(7788),a.e(2881)]).then(a.bind(a,90704)).then(e=>e.default),{loadableGenerated:{webpack:()=>[90704]},ssr:!1}),o=i()(()=>a.e(4210).then(a.bind(a,4210)).then(e=>e.default),{loadableGenerated:{webpack:()=>[4210]},ssr:!1}),l={component:e=>{let{pagination:t,conditionalRowStyles:a,rowsPerPage:s,columns:i,rows:l,onRowPress:d,handlePerRowsChange:c,handlePageChange:p,totalRows:_,currentPage:m,handleSort:u}=e;return(0,r.jsx)(o,{print:!1,export:!1,filter:!1,columns:i,data:l,children:(0,r.jsx)(n,{conditionalRowStyles:a,responsive:!0,striped:!0,pointerOnHover:!0,columns:i,data:l,defaultSortField:"created",defaultSortAsc:!1,onRowClicked:d,onChangeRowsPerPage:c,onChangePage:p,paginationTotalRows:_,paginationDefaultPage:m,pagination:t,paginationServer:!0,sortServer:!0,paginationPerPage:s,onSort:u,paginationRowsPerPageOptions:[10,15,20,25,50,100,500,1e3]})})},column:function(e,t,a,r,s){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";return{name:e,selector:t,sortable:a,cell:r,grow:s,minWidth:i}},columns:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t}}},13997:function(e,t,a){"use strict";a.d(t,{V:function(){return ec},p:function(){return ed}});var r=a(52322),s=a(8939),i=a(89929),n=a(66306),o=a(48115),l=a(2784),d=a(39684),c=a(26887);let p=(e,t,a,r)=>{let[s,i]=(0,l.useState)(e);(0,c.a)(e=>t(e),i,s);let{message:n}=(0,d.mU)(a);return console.log("subscribed to topic for changes: ",a),(0,l.useEffect)(()=>{if(n&&n.message){let e="string"==typeof n.message?n.message:JSON.stringify(n.message),[,,a]=(JSON.parse(e),n.topic.split("/"));t(i)}},[n]),[s,i]};var _=a(52026),m=a(99553),u=a(24066),h=a(6289),x=a(40914),f=a(94484);let b=e=>{let{index:t,data:a,width:s}=e,i=a.element.data,n=a.model.load(i),o=(0,f.d5)();return a.getCard?a.getCard(i,s):(0,r.jsx)(x.q,{height:a.itemHeight,cursor:"pointer",topBarOutSideScrollArea:!1,backgroundColor:"$color1",elevation:"$0",hoverStyle:{o:.8,backgroundColor:"$"+o.tint+"1",elevation:"$1"},borderWidth:1,pointerEvents:"none",pointerEventsControls:"none",onPress:()=>a.onSelectItem(n),...a.getPicture?{image:a.getPicture(i,s),hasPicture:!0}:{},children:a.getBody?a.getBody(i,s):(0,r.jsx)(_.Stack,{mb:"$4",width:s,children:(0,r.jsx)(u.G,{initialData:a.element,name:n.getId(),spinnerSize:75,loadingText:(0,r.jsxs)("div",{className:"  _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ai-center _jc-center ",children:["Loading data...",(0,r.jsx)("p",{className:"  is_Paragraph _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _ff-299667014 _fow-bold _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto font_body "})]}),objectId:n.getId(),sourceUrl:a.sourceUrl+"/"+n.getId(),mode:"preview",model:a.model,extraFields:a.extraFields,icons:a.icons,customFields:a.customFields,columnWidth:s-a.contentMargin,onDelete:a.onDelete,deleteable:a.deleteable,extraMenuActions:a.extraMenuActions})},i.key)})},g=e=>{let{overScanBy:t=5,gridElementCard:a,itemMinWidth:s=400,itemHeight:i,rightGap:n=30,contentMargin:o=50,onSelectItem:d=e=>{},extraMenuActions:c,spacing:p=20,getPicture:u,getBody:x,getCard:f,model:g,items:v,sourceUrl:j,customFields:w,onDelete:y,deleteable:N,extraFields:S,icons:P,children:I,...k}=e,z=(0,l.useRef)(null),C=v.map((e,t)=>({id:"item_"+t,element:(0,h.E)("loaded",e),model:g,sourceUrl:j,customFields:w,extraFields:S,icons:P,itemMinWidth:s,getPicture:u,getBody:x,getCard:f,spacing:p,contentMargin:o,onSelectItem:d,onDelete:y,deleteable:N,itemHeight:i,extraMenuActions:c}));return(0,r.jsxs)(_.Stack,{f:1,ref:z,...k,children:[(0,r.jsx)(m.rj,{overScanBy:t,rightGap:n,containerRef:z,spacing:p,data:C,card:null!=a?a:b,itemMinWidth:s},C.length),I]})};a(18190);var v=a(43260);let j=e=>{let{index:t,data:a,width:s}=e,i=a.element,n=a.model.load(i),o=a.onDelete;return(0,r.jsx)(_.Stack,{width:s,children:(0,r.jsx)(v.I,{compact:!0,innerContainerProps:{mb:"$3",mt:"$5",mx:"$3"},onDelete:o,json:i,name:n.getId(),isTemplate:!1})},i.key)},w=e=>{var t,a;let{itemMinWidth:s=400,rightGap:i=30,contentMargin:n=40,spacing:o=20,...d}=e,c=(0,l.useRef)(null),{items:p,model:u}=(0,l.useContext)(ed),h=null==p?void 0:null===(a=p.data)||void 0===a?void 0:null===(t=a.items)||void 0===t?void 0:t.map((e,t)=>({id:"item_"+t,element:e,model:u,onDelete:d.onDelete}));return(0,r.jsx)(_.Stack,{ml:"$5",ref:c,f:1,...d,children:(0,r.jsx)(m.rj,{rightGap:i,containerRef:c,spacing:o,data:h,card:j,itemMinWidth:s},h.length)})};var y=a(41473),N=a(2715),S=a(16399),P=a(91838),I=a(10836);let k=e=>{let{...t}=e,{resolvedTheme:a}=(0,S.P)(),i=(0,l.useRef)(null),n=(0,l.useContext)(ed),{tint:o}=(0,f.d5)(),[d,c]=(0,l.useState)({location:{lat:"",lon:""}}),p=n.items.data.items.map(e=>{let t=n.model.load(e);return{modelItem:t,location:t.getLocation()}}).filter(e=>e.location);return(0,l.useMemo)(()=>p.map((e,t)=>(0,r.jsx)(N.Jx,{color:"var(--"+o+"10)",longitude:e.location.lon,latitude:e.location.lat,anchor:"bottom",onClick:t=>{t.originalEvent.stopPropagation(),c(e)}},"marker-".concat(t))),[n.items.data.items,o]),(0,r.jsx)(_.Stack,{ref:i,f:1,...t,children:(0,r.jsx)(s.FA,{flex:1,alignItems:"center",justifyContent:"center",space:"$4",mt:"$-10",children:(0,r.jsxs)(I.Z,{children:[(0,r.jsx)(y.u,{size:"$7"}),(0,r.jsxs)("h2",{className:"  is_H2 _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-1316330269 _mr-0px _mb-0px _ml-0px _tt-230633015 _ff-299667014 _fow-233016295 _ls-167744214 _fos-229441375 _lh-222976728 _ussel-auto font_heading ",children:[(0,r.jsx)("span",{className:"  _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px ",children:"Missing "}),(0,r.jsx)(P.I,{children:(0,r.jsx)("span",{className:"  _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _col-137137640 ",children:"API Key"})})]}),(0,r.jsx)("p",{className:"  is_Paragraph _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-1316330269 _mr-0px _mb-0px _ml-0px _ff-299667014 _fow-233016233 _ls-167744152 _fos-229441313 _lh-222976666 _ussel-auto _ta-center font_body ",children:"Map rendering is unavailable without a Mapbox access token."}),(0,r.jsx)(P.I,{children:(0,r.jsxs)("p",{className:"  is_Paragraph _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _ff-299667014 _fow-233016233 _ls-167744152 _fos-229441313 _lh-222976666 _ussel-auto _ta-center font_body ",children:["Please visit ",(0,r.jsx)("a",{style:{fontWeight:"bold",color:"var(--color10)"},href:"https://www.mapbox.com",target:"_blank",rel:"noopener noreferrer",children:"Mapbox"})," to create your token and enable map features."]})})]})})})};a(51185);var z=a(96666),C=a(10347),$=a(51813),A=a(65126),O=a(91681),D=a(53726),F=a(68604),T=a(81815),E=a(99062),Z=a(57909),L=a(57441),R=a(40641),M=a(62624),q=a(42738),U=a(30195),V=a(53763),W=a(9393),B=a(57643),G=a(82695),J=a(26879),H=a(50897),K=a(1963),X=a(61773),Y=a(96455);let Q=e=>{var t,a,s;let{sourceUrl:i,onDelete:n=()=>{},deleteable:o=()=>{},extraMenuActions:d=[],enableAddToInitialData:c}=e,{items:p,model:m,selected:u,setSelected:h,state:x,push:f,replace:b,mergePush:g,tableColumns:v,rowIcon:j,onSelectItem:w}=(0,l.useContext)(ed),y=[{when:e=>u.some(t=>t.id===m.load(e).getId()),style:{backgroundColor:"var(--color4)"},"&:hover":{backgroundColor:"var(--color4)"}}],N=m.load({}),S=N.getObjectSchema().isDisplay("table"),I=["ZodString","ZodNumber","ZodBoolean"],k=null!=v?v:H.Z.columns(...Object.keys(S.shape).filter(e=>{var t;return I.includes(null===(t=S.shape[e]._def)||void 0===t?void 0:t.typeName)}).map(e=>{var t;return H.Z.column(null!==(s=null===(t=S.shape[e]._def)||void 0===t?void 0:t.label)&&void 0!==s?s:e,e,!0)}));return(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _pt-1481558276 _fw-wrap ",children:(0,r.jsx)(P.I,{children:(0,r.jsx)(H.Z.component,{pagination:!1,conditionalRowStyles:y,rowsPerPage:x.itemsPerPage?x.itemsPerPage:25,handleSort:(e,t)=>g({orderBy:e.selector,orderDirection:t}),handlePerRowsChange:e=>f("itemsPerPage",e),handlePageChange:e=>f("page",parseInt(e,10)-1),currentPage:(isNaN(parseInt(x.page,10))?0:parseInt(x.page,10))+1,totalRows:null==p?void 0:null===(t=p.data)||void 0===t?void 0:t.total,columns:[H.Z.column((0,r.jsx)(_.Theme,{reset:!0,children:(0,r.jsxs)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 ",children:[(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mt-1481558214 _ml-1481558152 _o-0d0t846 ",children:(0,r.jsx)(J.XZ,{focusStyle:{outlineWidth:0},checked:u.length>1,onPress:e=>{if(u.length)h([]);else{var t,a;console.log("selection all: ",null==p?void 0:null===(t=p.data)||void 0===t?void 0:t.items),h(null==p?void 0:null===(a=p.data)||void 0===a?void 0:a.items)}},children:(0,r.jsx)(J.XZ.Indicator,{children:(0,r.jsx)(K.G,{})})})}),u.length>1&&(0,r.jsx)(Y.o,{enableAddToInitialData:c,type:"bulk",mt:"1px",ml:"-5px",element:u,sourceUrl:i,deleteable:o,onDelete:n,extraMenuActions:d})]})}),"",!1,e=>(0,r.jsx)(_.Theme,{reset:!0,children:(0,r.jsxs)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ml-1481558152 _o-0d0t846 ",children:[(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mt-1481558214 ",children:(0,r.jsx)(J.XZ,{focusStyle:{outlineWidth:0},onPress:()=>{let t=e=>m.load(e).getId(),a=t(e),r=u.some(e=>t(e)===a);r?h(u.filter(e=>t(e)!==a)):h([...u,e])},checked:u.some(t=>m.load(t).getId()===m.load(e).getId()),children:(0,r.jsx)(J.XZ.Indicator,{children:(0,r.jsx)(X.J,{})})})}),(0,r.jsx)(Y.o,{enableAddToInitialData:c,type:"item",ml:"-5px",mt:"1px",element:m.load(e),sourceUrl:i+"/"+m.load(e).getId(),deleteable:o,onDelete:n,extraMenuActions:d}),j&&(0,r.jsx)(P.I,{children:(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _o-0d0t846 _ml-1481558214 _t-6px ",children:l.createElement(j,{size:"$1",color:"$color7"})})})]})}),!0,j?"115px":"75px"),...k],rows:null==p?void 0:null===(a=p.data)||void 0===a?void 0:a.items,onRowPress:e=>w?w(m.load(e)):b("item",m.load(e).getId())})})})};a(1435);var ee=a(61667),et=a(48859),ea=a(95753),er=a(46835),es=a(71932),ei=a(5632);let en="  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ml-1316330238 _ai-center ",eo="  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ai-center _ml-1481558152 ",el="  is_Paragraph _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _ff-299667014 _fow-233016140 _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto font_body ",ed=(0,l.createContext)({items:(0,h.E)("pending"),model:null,selected:[],setSelected:e=>null,onSelectItem:void 0,state:{},push:()=>null,mergePush:()=>null,removePush:()=>null,replace:()=>null,tableColumns:[],rowIcon:null,sourceUrl:""}),ec=(0,l.forwardRef)((e,t)=>{let{onSelectItem:a,itemData:d,rowIcon:c,disableViewSelector:_=!1,initialItems:m,sourceUrl:x,numColumnsForm:f=1,name:b,pluralName:v,entityName:j,hideAdd:y=!1,enableAddToInitialData:N=!1,pageState:S,icons:J={},model:H,extraFields:K={},columns:X,onEdit:ec=e=>e,onDelete:ep=e=>e,onAdd:e_=e=>e,views:em,extraViews:eu=[],openMode:eh="edit",disableToggleMode:ex,customFields:ef={},dataTableRawProps:eb={},dataTableListProps:eg={},dataTableGridProps:ev={},dataMapProps:ej={},extraFieldsForms:ew={},extraFieldsFormsEdit:ey={},extraFieldsFormsAdd:eN={},customFieldsForms:eS={},defaultView:eP="list",disableViews:eI=[],toolBarContent:ek=null,onAddButton:ez,extraMenuActions:eC=[],deleteable:e$=()=>!0,objectProps:eA={},refreshOnHotReload:eO=!1}=e,eD=null!==(e7=null!=j?j:v)&&void 0!==e7?e7:b+"s",{query:eF}=(0,ei.useRouter)(),[eT,eE]=(0,l.useState)(null!=S?S:eF),eZ=async e=>{let t=await o.bl.get({url:x,...eT});e(t)},[eL,eR]=p(m,eZ,"notifications/"+H.load({}).getModelName()+"/#",H),[eM,eq]=(0,l.useState)(null!=m?m:(0,h.E)("pending")),[eU,eV]=(0,l.useState)(!1),{push:eW,mergePush:eB,removePush:eG,replace:eJ}=(0,G.N)(eT),[eH,eK]=(0,l.useState)([]),[eX,eY]=(0,l.useState)(d),{search:eQ,setSearch:e0,setSearchName:e1}=(0,l.useContext)(er.c),e2=eC&&eC.some(e=>e.menus&&e.menus.includes("global"));(0,G.v)(eE),(0,l.useEffect)(()=>{},[]),(0,l.useEffect)(()=>{eL&&eL.isLoaded&&eq(eL)},[eL]),(0,B.rf)(()=>{eQ?eW("search",eQ,!1):eG("search")},[eQ]),(0,l.useEffect)(()=>{e1(eD)}),(0,B.rf)(()=>{eZ(eR)},[eT.orderBy+"_"+eT.itemsPerPage+"_"+eT.page+"_"+eT.search+"_"+eT.orderDirection]);let e5=(0,V.Py)();var e4,e3,e6,e7,e9,e8,te,tt=[{name:"list",icon:E.a,component:Q,props:{sourceUrl:x,deleteable:e$,onDelete:async e=>{if(Array.isArray(eH)&&eH.length&&x){let e=eH.map(e=>o.bl.get("".concat(x,"/").concat(H.load(e).getId(),"/delete")));await Promise.all(e),eK([])}else x&&await o.bl.get("".concat(e,"/delete"));ep({sourceUrl:e,selected:eH})},enableAddToInitialData:N,extraMenuActions:eC,...eg}},{name:"grid",icon:T.J,component:g,props:{mt:"$8",model:H,items:null==eL?void 0:null===(e4=eL.data)||void 0===e4?void 0:e4.items,sourceUrl:x,customFields:ef,extraFields:K,icons:J,ml:"$5",deleteable:e$,onDelete:async e=>{await o.bl.get(e+"/delete"),ep({sourceUrl:e,selected:eH})},onSelectItem:a||(e=>eJ("item",e.getId())),extraMenuActions:eC,...ev}},{name:"raw",icon:Z.S,component:w,props:{mt:"$8",onDelete:async e=>{await o.bl.get("".concat(x,"/").concat(e,"/delete")),ep({sourceUrl:x,selected:eH,key:e})},...eb}}];let ta={name:"map",icon:q.$,component:k,props:{mt:"$3",onDelete:async e=>{await o.bl.get("".concat(x,"/").concat(e,"/delete"))},...ej}},tr=H.load({}).getObjectSchema().is("location");tr.getFields().length&&(tt=[...tt,ta]);let ts=(null!=em?em:[...tt,...eu]).filter(e=>!eI.includes(e.name)),ti=-1!=ts.findIndex(e=>e.name==eT.view)?ts.findIndex(e=>e.name==eT.view):ts.findIndex(e=>e.name==eP),tn=e=>{let t=e.split("/");return t.pop()},to=eM&&eM.isLoaded?Math.ceil((null===(e3=eM.data)||void 0===e3?void 0:e3.total)/(null===(e6=eM.data)||void 0===e6?void 0:e6.itemsPerPage)):0;return eL&&eL.isError?(0,r.jsxs)(I.Z,{children:["Error: ",eL.error&&eL.error.error?eL.error.error:eL.error]}):(eT.editFile,(0,r.jsx)(z.Z,{atom:eM,children:(0,r.jsx)("div",{ref:t,className:"  _ai-stretch _dsp-flex _fd-column _bxs-border-box _pos-relative _mih-0px _miw-0px  _h-10037 _fg-1 _fs-1 _fb-auto ",children:(0,r.jsx)(ed.Provider,{value:{items:eM,sourceUrl:x,model:H,selected:eH,setSelected:eK,onSelectItem:a,state:eT,push:eW,mergePush:eB,removePush:eG,replace:eJ,tableColumns:X,rowIcon:c},children:(0,r.jsxs)(C.Z,{initialState:-1==ti?0:ti,children:[eT.editFile&&(0,r.jsx)(et.l,{id:"file-widget-"+tn(null!==(e9=eT.editFile)&&void 0!==e9?e9:"").split(".")[0],isFull:!1,hideCloseIcon:!1,isModified:!0,setIsModified:()=>{},icons:[(0,r.jsx)(ea.q,{onPress:()=>{eG("editFile")},children:(0,r.jsx)(L.X,{color:"var(--color)",size:"$1"})})],currentFileName:tn(null!==(e8=eT.editFile)&&void 0!==e8?e8:""),currentFile:eT.editFile}),(0,r.jsx)($.a,{integratedChat:!0,p:"$2",pt:"$5",pl:"$5",setOpen:eV,open:eU,hideAccept:!0,description:"",children:(0,r.jsx)(s.FA,{f:1,jc:"center",ai:"center",id:"admin-dataview-create-dlg",children:(0,r.jsx)(i.p,{maxHeight:"90vh",children:(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mr-1316330238 ",children:(0,r.jsx)(u.G,{id:"admin-eo",name:b,numColumns:f,mode:"add",onSave:async(e,t)=>{try{let e=H.load(t),a=eL.data.items.find(t=>t.id===e.getId());if(a)throw{error:"This id already exists"};let r=await o.bl.post(x,e_(e.create().getData()));if(r.isError)throw r.error;eV(!1),e5.show(b+" created",{message:e.getId()})}catch(e){throw console.log("original error: ",e,e.flatten()),(0,h.E)("error",null,e instanceof U.z.ZodError?e.flatten():e)}},model:H,extraFields:{...K,...ew,...eN},icons:J,customFields:{...ef,...eS},...eA})})})})}),(0,r.jsx)($.a,{integratedChat:!0,p:"$1",pt:"$5",pl:"$5",hideAccept:!0,acceptCaption:"Save",setOpen:e=>{eY(void 0),eG("item")},open:eT.item,description:"",children:(0,r.jsx)("div",{className:"  _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 _jc-center _ai-center ",children:(0,r.jsx)(i.p,{maxHeight:"90vh",children:(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mr-1316330238 ",children:(0,r.jsx)(u.G,{disableToggleMode:ex,initialData:eX,name:b,spinnerSize:75,loadingText:(0,r.jsxs)("div",{className:"  _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ai-center _jc-center ",children:["Loading data for ",b,(0,r.jsx)("p",{className:"  is_Paragraph _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _ff-299667014 _fow-bold _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto font_body ",children:eT.item})]}),objectId:eT.item,sourceUrl:x+"/"+eT.item,numColumns:f,mode:eh,onSave:async(e,t)=>{try{eY(void 0);let a=H.load(t).getId(),r=await o.bl.post(x+"/"+a,ec(H.load(e).update(H.load(t)).getData()));if(r.isError)throw r.error;let{item:s,...i}=eT;eE(i),e5.show(b+" updated",{message:"Saved new settings for: "+a})}catch(e){throw(0,h.E)("error",null,e instanceof U.z.ZodError?e.flatten():e)}},model:H,extraFields:{...K,...ew,...ey},icons:J,customFields:{...ef,...eS},...eA})})})})}),!eT.editFile&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _pt-1481558152 _pr-1316330300 _pl-1316330300 _mb-1481558276 ",children:[(0,r.jsxs)("div",{className:"  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _l--12px _fg-1 _ai-center ",children:[(0,r.jsx)("p",{className:el,children:(0,r.jsx)("span",{className:"  _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _fos-229441251 _col-137137671 ",children:v?v.charAt(0).toUpperCase()+v.slice(1):b.charAt(0).toUpperCase()+b.slice(1)+"s"})}),e2?(0,r.jsx)(P.I,{children:(0,r.jsx)(Y.o,{type:"global",sourceUrl:"",hideDeleteButton:!0,element:"",extraMenuActions:eC})}):(0,r.jsx)(r.Fragment,{}),ek]}),(0,r.jsxs)("div",{className:"  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ai-center ",children:[(0,r.jsx)("div",{className:eo,children:eM.isLoaded&&(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ml-1481558214 ",children:(0,r.jsxs)("div",{className:en,children:[(0,r.jsx)("div",{className:en,children:(0,r.jsxs)("span",{className:"  _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _fos-14px _col-137137640 ",children:[eM.data.itemsPerPage*eM.data.page+1,"-",Math.min(eM.data.total,eM.data.itemsPerPage*(eM.data.page+1))," of ",eM.data.total]})}),(0,r.jsxs)(P.I,{children:[(0,r.jsx)(es.z,{Icon:R.s,onPress:e=>{e.stopPropagation(),eM.data.page>0&&eW("page",eM.data.page-1)},ml:"$3",disabled:!(eM.data.page>0)}),(0,r.jsx)("span",{className:"  is_Spacer _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-1481558152 _miw-1481558152 _fs-0 _pe-none _w-1481558152 _h-1481558152 "}),(0,r.jsx)(es.z,{Icon:M._,onPress:e=>{e.stopPropagation(),eM.data.page<to-1&&eW("page",eM.data.page+1)},ml:"$3",disabled:!(eM.data.page<to-1)})]})]})})}),(0,r.jsxs)("div",{className:eo,children:[!_&&(0,r.jsx)(A.Z,{marginRight:"$3",children:ts.map((e,t)=>(0,r.jsx)(O.Z,{onSetActive:()=>eW("view",e.name),activeId:t,children:l.createElement(e.icon,{size:"$1",strokeWidth:1})},t))}),!y&&(0,r.jsx)(P.I,{children:(0,r.jsx)(n.zx,{id:"admin-dataview-add-btn",hoverStyle:{o:1},o:.7,circular:!0,onPress:()=>{ez?ez():eV(!0)},chromeless:!0,children:(0,r.jsx)(F.v,{color:"$color10"})})})]})]})]}),eL&&eL.isError&&(0,r.jsx)(D.q,{children:(0,r.jsx)("p",{className:el,children:(0,W.e)(eL.error)})}),(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 ",children:(0,r.jsx)(z.Z,{atom:eM,children:ts.map((e,t)=>(0,r.jsx)(ee.Z,{height:"100%",activeId:t,children:l.createElement(e.component,{...e.props})},t))})})]})]})})})}))});a(41234)},24066:function(e,t,a){"use strict";a.d(t,{G:function(){return en}});var r=a(52322),s=a(80939),i=a(66306),n=a(8939),o=a(84291),l=a(45734),d=a(59928),c=a(36907),p=a(52026),_=a(60545),m=a(89560),u=a(32627),h=a(60166),x=a(57441),f=a(7324),b=a(99062),g=a(57909),v=a(91838),j=a(51813),w=a(48715),y=a(4273);function N(e){let{showLabel:t=!0,containerProps:a,defaultValue:s,children:i,...o}=e;return(0,r.jsxs)(n.sL,{f:1,...a,children:[(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 ",children:(0,r.jsxs)(y.iR,{f:1,defaultValue:[50],min:0,max:100,step:1,...o,children:[(0,r.jsx)(y.iR.Track,{f:1,children:(0,r.jsx)(y.iR.TrackActive,{})}),(0,r.jsx)(y.iR.Thumb,{index:0,size:"$1",circular:!0,elevate:!0}),i]})}),t&&(0,r.jsx)("div",{className:"  _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _fs-0 _ai-flex-end _miw-40px _t--8px ",children:o.value})]})}a(5006);var S=a(6289),P=a(26887),I=a(48115),k=a(99553),z=a(10836),C=a(96666),$=a(53726),A=a(2784),O=a(9393),D=a(55858),F=a(75370),T=a(57643),E=a(94484),Z=a(96455);function L(e){let{choices:t,defaultSelections:a=[],onSetSelections:s,maxHeight:i="150px"}=e,o=(0,A.useRef)(null),[l,d]=(0,A.useState)(!1),[c,p]=(0,A.useState)(a),_=(e,a)=>{let r=t[t.indexOf(a)];if(c.includes(r)){let e=c.filter(e=>e!==r);s(e),p(e)}else{let e=c.concat(r);s(e),p(e)}};return(0,r.jsx)(v.I,{children:(0,r.jsxs)("div",{ref:o,onClick:()=>d(e=>!e),className:"  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0  _bg-115898854 _w-10037 _h-797770429 _jc-441309761 _ai-center _pr-10px _pl-10px _pt-7px _pb-7px _btlr-6px _btrr-6px _bbrr-6px _bblr-6px _outlineColor-791969495 _outlineWidth-1px _outlineStyle-solid _btc-791969495 _brc-791969495 _bbc-791969495 _blc-791969495 _cur-pointer ",children:[(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fw-wrap _h-797770429 _ox-hidden _oy-hidden _fg-1 _gap-1481558245 ",children:c.length>0?c.map((e,t)=>(0,r.jsx)("p",{onClick:t=>_(t,e),className:"  is_Paragraph _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _ff-299667014 _fow-233016140 _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto font_body  _pr-7px _pl-7px _pt-4px _pb-4px _bg-549765356 _btlr-4px _btrr-4px _bbrr-4px _bblr-4px _col-white ",children:e},t)):(0,r.jsx)("p",{className:"  is_Paragraph _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _col-791969557 _ff-299667014 _fow-233016140 _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto _pr-7px _pl-7px _pt-4px _pb-4px _btlr-4px _btrr-4px _bbrr-4px _bblr-4px font_body ",children:"Select"})}),(0,r.jsx)(h._,{}),l?(0,r.jsx)(n.FA,{zIndex:999,position:"absolute",top:"130%",left:"0%",width:"100%",backgroundColor:"$gray1",paddingHorizontal:"7px",paddingVertical:"7px",borderRadius:4,outlineColor:"$gray6",outlineWidth:1,outlineStyle:"solid",borderColor:"$borderColor",maxHeight:i,gap:"$1.5",overflow:"scroll",children:t.map((e,t)=>c.includes(e)?(0,r.jsx)("p",{onClick:t=>_(t,e),className:"  is_Paragraph _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _ussel-auto   _cur-0hover-pointer _pr-10px _pl-10px _pt-7px _pb-7px _btlr-4px _btrr-4px _bbrr-4px _bblr-4px _fos-229441220 _col-675002279 _ff-299667014 _fow-233016140 _ls-167744059 _lh-222976573 _bg-549765356 font_body ",children:e},t):(0,r.jsx)("p",{onClick:t=>_(t,e),className:"  is_Paragraph _bg-0hover-744986709 _cur-0hover-pointer _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _col-675002279 _ff-299667014 _fow-233016140 _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto _pr-10px _pl-10px _pt-7px _pb-7px _btlr-4px _btrr-4px _bbrr-4px _bblr-4px font_body ",children:e}))}):null]})})}a(94611);var R=a(70396);let M="  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 ",q="  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 _mt-1316330145 ",U=" _mt-1481558400",V=" _mt-1481558214",W=" _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0  _ml-1481558276  ",B="  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 ",G=e=>e&&e[0].toUpperCase()+e.slice(1),J={color:"var(--color9)",size:"$1",strokeWidth:1},H=e=>{var t;let{ele:a,i,icon:n,children:o,inArray:l=!1}=e;return(0,r.jsxs)("fieldset",{className:(0,R.concatClassName)("  is_Fieldset _ai-stretch _dsp-flex _fd-column _bxs-border-box _pos-relative _mih-0px _miw-0px  _gap-1481558214 _fg-1 _fs-1 _fb-auto  "+(i?" _ml-1316330238":" _ml-1481558400")),children:[!l&&(0,r.jsxs)(s.__,{fontWeight:"bold",children:[(0,r.jsx)(v.I,{children:(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mr-1481558214 ",children:A.createElement(n,J)})}),null!==(t=a._def.label)&&void 0!==t?t:a.name]}),l&&(0,r.jsx)("span",{className:"  is_Spacer _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-1481558276 _miw-1481558276 _fs-0 _pe-none _w-1481558276 _h-1481558276 "}),o]},i)},K={ZodString:"",ZodNumber:"0",ZodBoolean:!0,default:""},X=e=>K.hasOwnProperty(e)?K[e]:"ZodArray"==e?[]:"ZodObject"==e?{}:K.default,Y=e=>{var t;let{ele:a,elementDef:s,icon:n,path:o,arrData:l,getElement:d,setFormData:c,data:p,setData:_,mode:u,customFields:h}=e;return(0,r.jsxs)(ea,{ele:a,title:" ("+l.length+")",icon:g.S,path:o,children:[(0,r.jsx)("div",{className:B,children:l.map((e,t)=>(0,r.jsxs)("div",{className:(0,R.concatClassName)(""+(W+(t?V:U))),children:["ZodObject"!=s.type._def.typeName&&(0,r.jsx)(v.I,{children:(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _mr-1481558214 _t-20px ",children:"edit"==u||"add"==u?(0,r.jsx)(m.z,{...J}):(0,r.jsx)(f.$,{...J})})}),d({ele:{...s.type._def,_def:s.type._def,name:t},icon:n,i:0,x:0,data:p,setData:_,mode:u,customFields:h,path:[...o,a.name],inArray:!0,arrayName:a.name}),("edit"==u||"add"==u)&&(0,r.jsx)("div",{onClick:()=>{l.splice(t,1),c(a.name,[...l])},className:(0,R.concatClassName)(" _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ml-1481558214 _t-13px _btlr-1307610029 _btrr-1307610029 _bbrr-1307610029 _bblr-1307610029 _pt-1481558214 _pr-1481558214 _pb-1481558214 _pl-1481558214 _als-flex-start _cur-pointer  _bg-0hover-312414245 _o-0active-0d0t746  "+("ZodObject"!=s.type._def.typeName?" ":"  _pos-absolute _r-1316330269 _t-6px")),children:(0,r.jsx)(x.X,{color:"var(--red7)",strokeWidth:2,size:20})})]},t))}),("edit"==u||"add"==u)&&(0,r.jsxs)(i.zx,{mt:"$4",onPress:()=>{let e="ZodLazy"==a._def.typeName?a._def.getter()._def:a._def;"ZodOptional"==e.typeName?e.innerType._def.type._def.typeName:e.type._def.typeName,c(a.name,[...l,X(s.type._def.typeName)])},children:["Add",null!==(t=a._def.label)&&void 0!==t?t:a.name]})]})},Q=e=>{let{ele:t,elementDef:a,icon:s,path:i,data:n,setData:o,mode:l,customFields:d,inArray:c,arrayName:p,getFormData:_}=e;return(0,r.jsx)(ea,{simple:!0,ele:t,title:c?t._def.keyName?_(t._def.keyName,[...i,t.name]):p+" #"+(t.name+1):t.name,icon:b.a,path:i,children:(0,r.jsx)("div",{className:B,children:Object.keys(a.shape()).map((e,c)=>{let p=a.shape();return(0,r.jsx)("div",{className:(0,R.concatClassName)(" _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0  "+(c?" _mt-1316330238":U)),children:er({ele:{...p[e],name:e},icon:s,i:0,x:0,data:n,setData:o,mode:l,customFields:d,path:[...i,t.name]})},c)})})})},ee=e=>{let{ele:t,icon:a,i:s,inArray:i,eleArray:n,formData:o,generatedOptions:l,setFormData:d}=e,c=["ZodNumber","ZodString","ZodLiteral"],p=n.map(e=>c.includes(e.typeName)?String(e.value):JSON.stringify(e.value));return(0,r.jsx)(H,{ele:t,icon:a,i:s,inArray:i,children:(0,r.jsx)(L,{choices:l.length?l:p,defaultSelections:o,onSetSelections:e=>d(t.name,e)})})},et=e=>{let{ele:t,inArray:a,recordData:s,elementDef:l,icon:d,data:c,setData:p,mode:_,customFields:m,path:u,setFormData:h}=e,[x,f]=(0,A.useState)(!1),[g,v]=(0,A.useState)(""),w=(0,A.useRef)(null),[y,N]=(0,A.useContext)(ei);(0,A.useEffect)(()=>{if(x){let e=setTimeout(()=>{var e;null===(e=w.current)||void 0===e||e.focus()},100);return()=>clearTimeout(e)}},[x]);let S=async()=>{let e=X(t._def.valueType._def.typeName),a=[...u,t.name,g].join("/");f(!1),v(""),N(function(e,t){let a=t.substring(0,t.lastIndexOf("/")+1),r=e.filter(e=>!e.startsWith(a)||e===a);return r.push(t),r}(y,a)),h(t.name,{...s,[g]:e})};return(0,r.jsxs)(ea,{ele:t,title:a?" #"+(t.name+1):"...",icon:b.a,path:u,children:[(0,r.jsx)("div",{className:B,children:s?Object.keys(s).map((e,a)=>(0,r.jsx)("div",{className:(0,R.concatClassName)(""+(W+(a?V:U))),children:er({ele:{...l.valueType,name:e},icon:d,i:0,x:0,data:c,setData:p,mode:_,customFields:m,path:[...u,t.name]})},a)):null}),(0,r.jsx)(j.a,{acceptCaption:"Add field",setOpen:f,open:x,onAccept:S,title:"Add new field",description:"",children:(0,r.jsx)(n.FA,{f:1,id:"eo-add-field-input",alignItems:"center",mt:"$6",justifyContent:"center",children:(0,r.jsx)(o.II,{f:1,value:g,onChangeText:e=>v(e),textAlign:"center",id:"name",placeholder:"Field name...",ref:w,onKeyPress:e=>{"Enter"===e.key&&S()}})})}),("edit"==_||"add"==_)&&(0,r.jsx)(i.zx,{id:"eo-obj-comp-btn",mt:"$5",onPress:()=>{f(!0)},children:" Add field"})]})},ea=e=>{let{ele:t,title:a,children:s,icon:i,simple:o=!1,path:c}=e,[p,_]=(0,A.useContext)(ei),m=[...c,t.name].join("/"),u=(0,r.jsx)(n.sL,{mb:"$2",id:"eo-formgroup",br:"$5",f:1,elevation:p.includes(m)?10:0,hoverStyle:{elevation:10},children:(0,r.jsx)(l.U,{value:p,onValueChange:e=>_(e),onPress:e=>e.stopPropagation(),type:"multiple",boc:"$gray6",f:1,children:(0,r.jsxs)(l.U.Item,{br:"$5",bw:1,boc:"$gray6",value:m,children:[(0,r.jsx)(l.U.Trigger,{p:0,px:8,height:43,bc:"$transparent",focusStyle:{bc:"$transparent"},br:p.includes(m)?"$0":"$5",btlr:"$5",btrr:"$5",bw:"$0",flexDirection:"row",ai:"center",children:e=>{let{open:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.I,{children:o?A.createElement(i,J):(0,r.jsx)(r.Fragment,{})}),(0,r.jsx)("p",{className:"  is_Paragraph _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-1481558214 _ff-299667014 _fow-233016140 _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto font_body ",children:a}),(0,r.jsx)("span",{className:"  is_Spacer _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-1316330176 _miw-1316330176 _fs-1 _w-1316330176 _h-1316330176 _pe-none _fg-1 "}),(0,r.jsx)(d.b,{animation:"quick",rotate:t?"180deg":"0deg",children:(0,r.jsx)(h._,{size:"$1"})})]})}}),(0,r.jsx)(l.U.Content,{br:"$5",children:s})]})})});return o?u:(0,r.jsx)(H,{ele:t,icon:i,i:0,children:u})},er=e=>{var t,a,s,i,n,l;let{ele:d,icon:p,i:_,x:m,data:u,setData:h,mode:x,customFields:f={},path:b=[],inArray:g=!1,arrayName:j=""}=e,y=null!==(s=null===(a=d._def)||void 0===a?void 0:null===(t=a.innerType)||void 0===t?void 0:t._def)&&void 0!==s?s:d._def,S=(e,t)=>{let a=u;b.forEach(e=>{Array.isArray(a)||a.hasOwnProperty(e)||(a[e]={}),a=a[e]}),a[e]=t,h({data:u})},P=(e,t)=>{let a=null!=u?u:{};for(let e of null!=t?t:b)("object"==typeof a&&a.hasOwnProperty(e)||Array.isArray(a)&&a.length>e)&&(a=a[e]);return"string"==typeof a?a:a&&a.hasOwnProperty(e)?a[e]:""},I=y.typeName;if("ZodLazy"==I){let e=y.getter();y=e._def,I=e.constructor.name,e.name=d.name,d=e}if(f.hasOwnProperty(d.name)||f.hasOwnProperty("*")){let e=f.hasOwnProperty(d.name)?f[d.name]:f["*"],t="function"==typeof e.component?e.component(b,P(d.name),e=>S(d.name,e),x,u):e.component;if(t)return e.hideLabel?t:(0,r.jsx)(H,{ele:d,icon:p,i:_,inArray:g,children:t})}if("ZodUnion"==I&&"preview"!=x){let e=y.displayOptions?y.displayOptions:y.options.map(e=>e._def.value),t=y.options.map(e=>e._def.value);d._def.dependsOn&&u&&u[d._def.dependsOn]&&"function"==typeof d._def.generateOptions&&(t=[...e=d._def.generateOptions(u)]);let a=d._def.dependsOn,s=d._def.dependsOnValue;return(0,r.jsx)(H,{ele:d,icon:p,i:_,inArray:g,children:a?u[a]?s?s==u[a]?(0,r.jsx)(w.E,{f:1,data:u,title:d.name,elements:e,value:e[t.indexOf(P(d.name))],setValue:a=>S(d.name,t[e.indexOf(a)])}):(0,r.jsx)(o.II,{focusStyle:{outlineWidth:1},disabled:!0,placeholder:d._def.hint?d._def.hint:"Fill "+a+" property first",bc:"$backgroundTransparent"}):(0,r.jsx)(w.E,{f:1,data:u,title:d.name,elements:e,value:e[t.indexOf(P(d.name))],setValue:a=>S(d.name,t[e.indexOf(a)])}):(0,r.jsx)(o.II,{focusStyle:{outlineWidth:1},disabled:!0,placeholder:d._def.hint?d._def.hint:"Fill "+a+" property first",bc:"$backgroundTransparent"}):(0,r.jsx)(w.E,{f:1,data:u,title:d.name,elements:e,value:e[t.indexOf(P(d.name))],setValue:a=>S(d.name,t[e.indexOf(a)])})})}if("ZodNumber"==I&&"preview"!=x){if(y.checks){let e=y.checks.find(e=>"min"==e.kind),t=y.checks.find(e=>"max"==e.kind);if(e&&t)return(0,r.jsx)(H,{ele:d,icon:p,i:_,inArray:g,children:(0,r.jsx)(v.I,{children:(0,r.jsx)("div",{className:q,children:(0,r.jsx)(N,{onValueChange:e=>S(d.name,e),value:[null!==(i=P(d.name))&&void 0!==i?i:e.value],width:190,min:e.value,max:t.value})})})})}}else if("ZodObject"==I)return(0,r.jsx)(Q,{ele:d,elementDef:y,icon:p,path:b,data:u,setData:h,mode:x,customFields:f,inArray:g,arrayName:j,getFormData:P});else if("ZodArray"==I){let e=P(d.name)?P(d.name):[],t=[];"function"==typeof d._def.generateOptions&&(t=d._def.generateOptions(u));let a=!d._def.innerType&&"ZodUnion"===d._def.type._def.typeName;return a?(0,r.jsx)(ee,{ele:d,icon:p,i:_,inArray:g,eleArray:d._def.type._def.options,formData:e,generatedOptions:t,setFormData:S}):(0,r.jsx)(Y,{data:u,setData:h,mode:x,ele:d,elementDef:y,icon:p,customFields:f,path:b,arrData:e||t,getElement:er,setFormData:S})}else if("ZodRecord"==I){let e=P(d.name);return(0,r.jsx)(et,{ele:d,inArray:g,recordData:e,elementDef:y,icon:p,data:u,setData:h,mode:x,customFields:f,path:b,setFormData:S})}else if("ZodBoolean"==I){let e=P(d.name);return(0,r.jsx)(H,{ele:d,icon:p,i:_,inArray:g,children:(0,r.jsx)(v.I,{children:(0,r.jsx)("div",{className:q,children:(0,r.jsx)(c.rs,{disabled:"add"!=x&&"edit"!=x,checked:e,onCheckedChange:e=>S(d.name,e),size:"$2",children:(0,r.jsx)(c.rs.Thumb,{animation:"quick"})})})})})}let k="";return"function"!=typeof d._def.generateOptions||(k=d._def.generateOptions(),P(d.name)||S(d.name,k)),(0,r.jsx)(H,{ele:d,icon:p,i:_,inArray:g,children:(0,r.jsx)("div",{className:M,children:(0,r.jsx)(o.II,{id:"editable-object-input-"+(null==d?void 0:d.name),..."edit"!=x&&"add"!=x?{bw:0,forceStyle:"hover"}:{},focusStyle:{outlineWidth:1},disabled:"view"==x||"preview"==x||"edit"==x&&d._def.static||d._def.dependsOn&&!u[d._def.dependsOn],secureTextEntry:d._def.secret,value:k&&!P(d.name)?k:P(d.name),onChangeText:e=>S(d.name,"ZodNumber"==d._def.typeName?e.replace(/[^0-9.-]/g,""):e),placeholder:u?null!==(l=null!==(n=d._def.hint)&&void 0!==n?n:d._def.label)&&void 0!==l?l:"number"==typeof d.name?"...":d.name:"",autoFocus:0==m&&0==_,onBlur:()=>{if("ZodNumber"==d._def.typeName){let e=parseFloat(P(d.name));isNaN(e)||S(d.name,e)}},bc:"$backgroundTransparent"})})})},es=e=>{let{index:t,data:a,width:s}=e;a.ele._def.size,a.ele._def.numColumns;let i=a.ele._def.size||1;return(0,r.jsx)(n.sL,{f:1,width:s*i+(i-1)*(a.columnMargin/i),children:er({ele:a.ele,icon:a.icon,i:a.i,x:a.x,data:a.data||a.defaultData,setData:a.setData,mode:a.mode,customFields:a.customFields})},a.x)},ei=(0,A.createContext)([[],e=>{}]),en=e=>{let{externalErrorHandling:t,error:a,setError:s,data:o,setData:l,EditIconNearTitle:d=!1,autoWidth:c=!1,columnMargin:h=30,columnWidth:f=350,extraMenuActions:b,disableToggleMode:g,name:w,initialData:y,loadingTop:N,spinnerSize:L,loadingText:q,title:V,sourceUrl:W=null,onSave:J,mode:H="view",model:K,icons:X={},extraFields:Y={},numColumns:Q=1,objectId:ee,onDelete:et=()=>{},deleteable:ea=()=>!0,customFields:er={},...en}=e,[eo,el]=(0,A.useState)(null!=y?y:(0,S.E)("pending")),[ed,ec]=(0,A.useState)(H),[ep,e_]=(0,A.useState)(""),[em,eu]=(0,A.useState)(eo),eh=o&&l;o&&l||(o=em,l=eu);let[ex,ef]=(0,A.useState)(!1),[eb,eg]=(0,A.useState)();a&&s||t||(a=eb,s=eg);let[ev,ej]=(0,A.useState)(!1),[ew,ey]=(0,A.useState)(!1),[eN,eS]=(0,A.useState)(!1),eP=(0,A.useRef)(),[eI,ek]=(0,A.useState)([]);(0,P.a)(e=>{"add"!=H&&I.bl.get(W,e)},el,y),(0,A.useEffect)(()=>{eo.data&&l(eo)},[eo]),(0,T.rf)(()=>ec(H),[H]),(0,T.rf)(()=>{eN?ey(!0):eS(!0)},[o]);let ez=(0,A.useMemo)(()=>{let e=K.load(o.data),t=D.U.load(F.V_.object(Y)),a=e.getObjectSchema().isDisplay(ed).merge(t).getLayout(1),r={},s={};return a.forEach((e,t)=>e.forEach((e,a)=>{var i,n;let d=X[e.name]?X[e.name]:"edit"==ed||"add"==ed?m.z:u.V,c=null!==(i=e._def.group)&&void 0!==i?i:0;r.hasOwnProperty(c)||(r[c]=[]),e._def.hasOwnProperty("defaultValue")&&(s[e.name]=e._def.defaultValue),r[c].push({id:t+"_"+a,icon:d,i:a,x:t,ele:e,data:o.data,setData:l,mode:ed,size:null!==(n=e._def.size)&&void 0!==n?n:1,numColumns:Q,customFields:er,columnMargin:h,defaultData:s})})),r},[Y,o,K,h,Q,ed,H,eo]),eC=(0,A.useMemo)(()=>Object.keys(ez).map((e,t)=>(0,r.jsxs)(n.sL,{ref:eP,mt:"$0",width:c?"100%":f*Q+h,f:1,children:[(0,r.jsx)("div",{className:M,children:(0,r.jsx)(k.rj,{masonry:!1,containerRef:eP,spacing:h/2,data:ez[e],card:es,itemMinWidth:f,columns:Q})}),"preview"==ed&&(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _t-1316333121 ",children:(0,r.jsx)(Z.o,{type:"item",sourceUrl:W,onDelete:et,deleteable:ea,element:K.load(o.data),extraMenuActions:b})})]})),[h,ez,f,Q]),{tint:e$}=(0,E.d5)();return(0,r.jsx)(ei.Provider,{value:[eI,ek],children:(0,r.jsxs)(p.Stack,{width:"100%",...en,children:[(0,r.jsx)(j.a,{showCancel:!0,acceptCaption:"Discard",cancelCaption:"Keep editing",onAccept:async()=>{let e=await I.bl.get(W);el(e),ec("view")},cancelTint:e$,acceptTint:"red",open:ev,setOpen:ej,title:"Are you sure you want to leave?",description:"",children:(0,r.jsx)(z.Z,{mt:"$5",children:"All unsaved changes will be lost"})}),(0,r.jsx)(C.Z,{forceLoad:"add"==ed||o.data,waitForLoading:1e3,spinnerSize:L,loadingText:null!=q?q:"Loading "+ee,top:null!=N?N:-30,atom:o,children:(0,r.jsxs)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _w-10037 ",children:[(0,r.jsxs)("div",{className:"  _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ai-center ",children:[(0,r.jsx)(n.sL,{mt:"preview"==ed?"$4":void 0,ml:"preview"==ed?"$4":void 0,id:"eo-dlg-title",children:(0,r.jsxs)("h3",{className:"  is_H3 _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _tt-230632984 _ff-299667014 _fow-233016264 _ls-167744183 _fos-229441344 _lh-222976697 _ussel-auto font_heading ",children:[(0,r.jsx)(v.I,{children:(0,r.jsx)("h3",{className:"  is_H3 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _col-549765294 _tt-230632984 _ff-299667014 _fow-233016264 _ls-167744183 _fos-229441344 _lh-222976697 _ussel-auto font_heading ",children:G(H)})})," ".concat(G(w))]})}),V&&(0,r.jsx)("div",{className:(0,R.concatClassName)(" _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0  _mr-1316330238  "+(d?" _fg-0 _fs-1 _fb-auto":" _fg-1 _fs-1 _fb-auto")),children:(0,r.jsxs)("span",{className:"  _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _fow-bold _fos-40px ",children:[(0,r.jsx)(v.I,{children:(0,r.jsx)("span",{className:"  _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _col-549765294 ",children:G(ed)})}),(0,r.jsxs)("span",{className:"  _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _col-137137671 ",children:[" ",G(w)]})]})}),!g&&("view"==ed||"edit"==ed)&&(0,r.jsx)("div",{onClick:async()=>{"edit"==ed&&ew?ej(!0):(e_(ed),ec("view"==ed?"edit":"view"))},className:"  _o-0active-0d0t846 _ai-stretch _dsp-flex _fd-row _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0  _cur-pointer ",children:(0,r.jsx)(v.I,{children:(0,r.jsx)("div",{className:B,children:"view"==ed?(0,r.jsx)(m.z,{color:"var(--color8)"}):"view"==ep?(0,r.jsx)(x.X,{color:"var(--color8)"}):null})})})]}),(0,r.jsxs)("div",{className:(0,R.concatClassName)(" _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _w-10037 _fg-1  _ai-center _jc-center  "+(V?" _mt-1316330300":U)),children:[a&&(0,r.jsx)($.q,{children:(0,r.jsx)("p",{className:"  is_Paragraph _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-0px _ff-299667014 _fow-233016140 _ls-167744059 _fos-229441220 _lh-222976573 _ussel-auto font_body ",children:(0,O.e)(a.error)})}),eC,"preview"!=ed&&(0,r.jsx)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _mt-1316330145 _pt-1481558214 _pr-1481558214 _pb-1316330238 _pl-1481558214 _w-10037 _fg-1 _als-center ",children:("add"==ed||"edit"==ed)&&!eh&&(0,r.jsx)(v.I,{children:(0,r.jsx)(i.zx,{f:1,onPress:async()=>{ef(!0);try{await J(eo.data,o.data),ep!=ed&&ec(ep)}catch(e){s(e),console.log("e: ",e)}ef(!1)},children:ex?(0,r.jsx)(_.$,{}):"add"==ed?"Create":"Save"})})})]})]})})]})})};a(31851)},99553:function(e,t,a){"use strict";a.d(t,{rj:function(){return m}});var r=a(52322),s=a(52026),i=a(8939),n=a(2784),o=a(23724),l=a(11667),d=a(23510);let c={width:0,height:0},p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],[a,r]=(0,n.useState)(c);return(0,n.useLayoutEffect)(()=>{let{current:t}=e;if(t){let e=()=>{let e=getComputedStyle(t),a=parseFloat,s=t.clientWidth-a(e.paddingTop)-a(e.paddingBottom),i=t.clientHeight-a(e.paddingLeft)-a(e.paddingRight);r({height:i,width:s})};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}}},t.concat(e.current)),a},_=e=>{let[t,a]=(0,n.useState)(!1),[r,s]=(0,n.useState)(0);return(0,n.useLayoutEffect)(()=>{let t;let{current:a}=e;if(a){let e=()=>{t||(t=window.requestAnimationFrame(()=>{s(a.scrollTop),t=void 0}))};return a.addEventListener("scroll",e),()=>{a.removeEventListener("scroll",e),t&&window.cancelAnimationFrame(t)}}},[e.current]),(0,n.useLayoutEffect)(()=>{a(!0);let e=window.setTimeout(()=>{a(!1)},1e3/6);return()=>window.clearTimeout(e)},[r]),{scrollTop:r,isScrolling:t}},m=n.forwardRef((e,t)=>{let{overScanBy:a=5,masonry:c=!0,containerRef:m,rightGap:u=0,spacing:h,children:x,data:f,card:b,columns:g,itemMinWidth:v=200,gap:j}=e;if(s.isWeb&&f&&b){if(c&&m){var w,y;let e={current:(null===(w=m.current)||void 0===w?void 0:w.container)?null==m?void 0:null===(y=m.current)||void 0===y?void 0:y.container.firstChild:m.current},{width:t,height:r}=p(e),{scrollTop:s,isScrolling:i}=_(e),n=(0,o.G)({width:Math.max(0,t-u),columnGutter:h,columnWidth:v}),c=(0,l.y)(n);return(0,d.$)({positioner:n,scrollTop:s,isScrolling:i,height:r,items:f,overscanBy:a,resizeObserver:c,render:b})}return(0,r.jsx)(i.sL,{flexWrap:"wrap",children:f.map((e,t)=>(0,r.jsxs)(s.Stack,{m:h/2,children:[" ",n.createElement(b,{index:e.index,data:{...e},width:v})," "]},t))})}if(s.isWeb)return(0,r.jsx)("div",{ref:t,style:{gap:j,display:"grid",gridTemplateColumns:"repeat( auto-fill, minmax(".concat(v,"px, 1fr) )")},children:x});let N=n.Children.toArray(x);return(0,r.jsx)(i.sL,{alignItems:"center",justifyContent:"center",flexWrap:"wrap",children:N.map((e,t)=>e?(0,r.jsx)(i.sL,{flex:1,minWidth:v,marginRight:j,marginBottom:j,children:e},t):null)})})},96455:function(e,t,a){"use strict";a.d(t,{o:function(){return u}});var r=a(52322),s=a(8939),i=a(52026),n=a(86838),o=a(51813),l=a(2784),d=a(91838),c=a(10281),p=a(13742),_=a(71932),m=a(13997);let u=e=>{let{type:t,sourceUrl:a="",enableAddToInitialData:u=!1,onDelete:h,element:x,deleteable:f,extraMenuActions:b=[],hideDeleteButton:g,...v}=e,[j,w]=(0,l.useState)(!1),[y,N]=(0,l.useState)(!1),{selected:S,setSelected:P,model:I}=(0,l.useContext)(m.p),k=e=>{let{id:t="",type:a,text:i,Icon:n,onPress:o,disabled:l}=e;return(0,r.jsxs)(s.sL,{id:t,ml:"$1",o:1,br:"$5",p:"$3",als:"flex-start",cursor:l?"default":"pointer",pressStyle:l?{}:{o:.7},hoverStyle:l?{}:{bc:"$color5"},onPress:e=>{l||(o("global"===a?"*":x,e),w(!1))},children:[(0,r.jsx)(n,{size:"$1",color:l?"var(--gray9)":"var(--color9)",strokeWidth:2}),(0,r.jsx)("span",{className:"  _col-675002279 _dsp-inline _bxs-border-box _ww-break-word _mt-0px _mr-0px _mb-0px _ml-1481558152 ",children:i})]})};return(0,r.jsxs)(i.Stack,{...v,children:[(0,r.jsx)(o.a,{acceptCaption:"Delete",setOpen:N,open:y,onAccept:async e=>{await h(a),e(!1)},title:"Delete ",description:"Are you sure want to delete this item?",w:280,children:(0,r.jsx)("div",{className:"  _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-1 _fg-1 _jc-center _ai-center "})}),(0,r.jsxs)(n.J2,{onOpenChange:w,open:j,placement:"bottom",children:[(0,r.jsx)(n.J2.Trigger,{children:(0,r.jsx)(_.z,{id:"more-btn-".concat(a.split("/").slice(-1)),Icon:c.h,onPress:e=>{e.stopPropagation(),w(!0)},ml:"$3"})}),(0,r.jsx)(n.J2.Content,{padding:0,space:0,left:"$7",top:"$2",bw:1,boc:"$borderColor",bc:"$color1",children:(0,r.jsx)(d.I,{children:(0,r.jsx)("div",{onClick:e=>e.stopPropagation(),className:"  _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 _ai-center _jc-center _pt-1481558152 _pr-1481558152 _pb-1481558152 _pl-1481558152 ",children:(0,r.jsxs)("div",{className:"  _ai-stretch _dsp-flex _fd-column _fb-auto _bxs-border-box _pos-relative _mih-0px _miw-0px _fs-0 ",children:[b.map((e,s)=>{var i;return(!e.menus&&"item"===t||e.menus&&(null===(i=e.menus)||void 0===i?void 0:i.includes(t)))&&e.isVisible&&e.isVisible(x)&&(0,r.jsx)(k,{id:"more-btn-".concat(a.split("/").slice(-1),"-option-").concat(s+1),type:t,text:"function"==typeof e.text?e.text(t):e.text,Icon:e.icon,onPress:e.action},s)}),!1,g?(0,r.jsx)(r.Fragment,{}):(0,r.jsx)(k,{type:t,text:"Delete",id:"more-btn-".concat(a.split("/").slice(-1),"-delete"),Icon:p.V,disabled:!f(x),onPress:(e,t)=>{t.stopPropagation(),N(!0),w(!1)}})]})})})})]})]})};a(66286)},1888:function(e,t,a){"use strict";a.d(t,{F7:function(){return n},eq:function(){return o}});var r=a(44499),s=a(6429),i=a(48115);let n=e=>r.l.SSR?e:void 0;function o(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n(async n=>{var o,l,d,c,p,_;let m={itemsPerPage:parseInt(n.query.itemsPerPage)?parseInt(n.query.itemsPerPage):"",page:parseInt(n.query.page,10)?parseInt(n.query.page,10):"",search:null!==(o=n.query.search)&&void 0!==o?o:"",orderBy:null!==(l=n.query.orderBy)&&void 0!==l?l:"",orderDirection:null!==(d=n.query.orderDirection)&&void 0!==d?d:"",view:null!==(c=n.query.view)&&void 0!==c?c:"",item:null!==(p=n.query.item)&&void 0!==p?p:"",editFile:null!==(_=n.query.editFile)&&void 0!==_?_:"",..."function"==typeof a?await a(n):a},u="function"==typeof e?e(n):e;return(0,s.NA)(n,t,{sourceUrl:u,initialItems:await i.bl.get({url:(0,s.VM)(u,n),...m}),itemData:n.query.item?await i.bl.get((0,s.VM)(u+"/"+n.query.item,n)):"",extraData:{..."function"==typeof r?await r(n):r},pageState:{...m}})})}},26887:function(e,t,a){"use strict";a.d(t,{a:function(){return s}});var r=a(57643);let s=(e,t,a)=>(0,r.qR)(()=>{a&&"pending"!=a.status?t(a):e(t)})},82695:function(e,t,a){"use strict";a.d(t,{N:function(){return o},v:function(){return n}});var r=a(5632),s=a(57643);let i=(e,t)=>{let{[t]:a,...r}=e;return r},n=e=>{let{query:t}=(0,r.useRouter)();(0,s.rf)(()=>{e(t)},[t])},o=e=>{let{replace:t,push:a,query:s}=(0,r.useRouter)(),n=()=>Object.keys(null!=e?e:{}).reduce((t,a)=>""!==e[a]?{...t,[a]:e[a]}:t,{});return{push:function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2];a({query:{...s,...n(),[e]:t}},void 0,{shallow:r})},mergePush:e=>{a({query:{...s,...n(),...e}},void 0,{shallow:!0})},removePush:e=>{a({query:i(s,e)},void 0,{shallow:!0})},removeReplace:e=>{t({query:i(s,e)},void 0,{shallow:!0})},replace:(e,a)=>{t({query:{...s,...n(),[e]:a}},void 0,{shallow:!0})},mergeReplace:a=>{t({query:{...n(),...e,...a}},void 0,{shallow:!0})}}}},41234:function(){},31851:function(){},14528:function(){},1435:function(){},5006:function(){},66286:function(){},18190:function(){},94611:function(){},51185:function(){}},function(e){e.O(0,[8641,8081,4733,1335,8873,2859,6313,3950,3661,9331,4092,9927,6116,9498,1967,5619,9884,995,1004,4152,8676,767,1773,8859,9774,2888,179],function(){return e(e.s=68425)}),_N_E=e.O()}]);