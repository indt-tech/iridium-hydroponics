"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4532],{56626:function(e,t,n){n.d(t,{Z:function(){return a}});var s=n(2784),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=(e,t)=>{let n=(0,s.forwardRef)(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:l,children:c,...d},u)=>(0,s.createElement)("svg",{ref:u,...r,width:a,height:a,stroke:n,strokeWidth:l?24*Number(i)/Number(a):i,className:`lucide lucide-${o(e)}`,...d},[...t.map(([e,t])=>(0,s.createElement)(e,t)),...(Array.isArray(c)?c:[c])||[]]));return n.displayName=`${e}`,n}},1599:function(e,t,n){n.d(t,{Z:function(){return r}});var s=n(56626);let r=(0,s.Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]])},81412:function(e,t,n){n.r(t);var s=n(52322),r=n(93589),o=n(2784),a=n(1201),i=n(48115),l=n(91838),c=n(57643),d=n(1599),u=n(17029),g=n(752);t.default=e=>{let{tags:t=[],zIndex:n=1,onScreen:p=!0,mode:m="default"}=e,[h,f]=(0,o.useState)(!0),[y,w]=(0,g.KO)(a.qF),v=(0,o.useRef)(),E=()=>{let e=document.querySelector(".rcw-messages-container");e&&(e.scrollTop=e.scrollHeight)};(0,c.tj)(e=>{e.target.classList.contains("rcw-input")&&e.target.focus()});let b=e=>{let t=e.parentNode.parentNode.parentNode,n=document.createElement("img");n.src="/images/youtube-play.svg",n.style.width="".concat(e.offsetWidth,"px"),n.style.height="".concat(e.offsetHeight,"px"),n.style.position="absolute",n.style.transformOrigin="center",n.style.transform="scale(0.20)",n.style.cursor="Pointer",n.style.pointerEvents="none",n.style.left="15px",n.style.top="15px","static"===getComputedStyle(t).position&&(t.style.position="relative"),t.appendChild(n)},{width:k,height:N}=(0,c.iP)(),L=(e,t)=>{if(v.current){let n=v.current.getBoundingClientRect(),s=-((t-n.top)*1),r=-((e-n.right)*1);v.current.firstChild&&n.bottom===n.top&&n.bottom&&(v.current.firstChild.style.bottom=s+"px",v.current.firstChild.style.right=r+"px")}};(0,o.useEffect)(()=>{let e=new MutationObserver(e=>{e.forEach(e=>{"childList"===e.type&&e.addedNodes.length&&e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE&&(e.classList.contains("rcw-message")||e.classList.contains("rcw-conversation-container"))){let t=e.getElementsByClassName("rcw-message-img");for(let e of t)if(e.complete){b(e),E();for(let e=1;e<11;e++)setTimeout(()=>E(),100*e)}else e.addEventListener("load",()=>{E();for(let e=1;e<11;e++)setTimeout(()=>E(),100*e);b(e)})}}),(e.target.classList.contains("is_DialogContent")||e.target.closest(".is_DialogContent"))&&!e.target.closest(".rcw-widget-container")&&L(window.innerWidth,window.innerHeight)})}),t=document.querySelector("body");return t&&e.observe(t,{childList:!0,subtree:!0}),()=>{e.disconnect()}},[]);let C=async()=>{console.log("requesting: ","/adminapi/v1/resources?search=tags:"+t.join(","));let e=await i.bl.get("/adminapi/v1/resources?search=tags:"+t.join(","));if(e.isLoaded&&e.data.items&&e.data.items.length){let t=e.data.items.map(async e=>{if("text"==e.type){let t=await i.bl.get(e.url,void 0,!0);return t.data}if("youtube"==e.type){let t=e.url.split("=");if(t.length<2)return null;let n=t[1];return"[![video](https://img.youtube.com/vi/"+n+"/0.jpg)]("+e.url+' "Video Title")\n'+e.description}return null}),n=await Promise.all(t);return n.filter(e=>null!==e)}return[]},x=async()=>{let e=await C();if(e.forEach(e=>(0,r.addResponseMessage)(e)),!y){let e="I'm here to help you. Feel free to ask questions about the system.";(0,r.addResponseMessage)(e),w(e)}};(0,o.useEffect)(()=>{L(window.innerWidth,window.innerHeight)},[k,N]);let[M,_]=(0,o.useState)(),[R,j]=(0,o.useState)();(0,o.useEffect)(()=>{var e=document.createElement("input");e.type="file",e.accept="image/*",e.style.display="none",e.addEventListener("change",e=>{var t=e.target.files[0];if(t){let e=new FileReader;e.onload=e=>{_({content:e.target.result,filename:t.name})},e.readAsDataURL(t)}});var t=document.createElement("div");t.className="rcw-picker-icon-container",t.addEventListener("click",()=>{e.click()});let n=u.createRoot(t);n.render((0,s.jsx)(d.Z,{size:24,className:"rcw-picker-icon"}));var r=v.current.getElementsByClassName("rcw-picker-btn")[0];return r&&r.parentNode.replaceChild(t,r),()=>{n.unmount()}},[null==v?void 0:null===(T=v.current)||void 0===T?void 0:T.isOpen,R]);for(var T,W=0;W<20;W++)(0,c.KS)(()=>{L(window.innerWidth,window.innerHeight)},50*W);let[A]=(0,g.KO)(a.XD);return(0,s.jsx)(l.I,{children:(0,s.jsx)("div",{ref:v,onMouseDown:e=>e.preventDefault(),onClick:e=>e.preventDefault(),style:{transform:"none",zIndex:1e5,bottom:0,right:0,position:"fixed"},children:(0,s.jsx)("div",{style:{position:"absolute"},children:(0,s.jsx)(r.Widget,{title:"Assistant",subtitle:"Get help, ideas and documentation",handleNewUserMessage:async e=>{console.log("Prompt chain: ",A);let t=e.startsWith("/"),n=e.startsWith("/help"),s=!!(t&&(null==M?void 0:M.content)),o=A.reduce((t,s)=>t+(n?s.generateCommand(e,t):s.generate(e,t,null==M?void 0:M.content)),"")+(n?"\n                                    ]\n\n                                    End of command list.\n\n                                    The user wants to know the list of available commands. Include all the commands in the reply, and include a small description of the command. use the field action for the description of what the command does, but summarize it. \n                                    ":t?"\n\n                                    ------\n                                    request: ".concat(e.replace(/^\/\S+/,"").trim()):'\n                                    reply directly to the user, acting as the assistant.\n\n                                    The question of the user for the assistant is:\n                                    "'.concat(e,'".'));s&&(o=[{type:"image_url",image_url:M.content},o]),console.log("prompt: ",o),(0,r.toggleMsgLoader)();let a=await i.bl.post("/adminapi/v1/assistants",{messages:[{role:"user",content:o}],best_of:4,temperature:n?0:1,gptModel:s?"gpt-4-vision-preview":void 0});if((0,r.toggleMsgLoader)(),console.log("result: ",a),a.isError)(0,r.addResponseMessage)("Error generating response: ",a.error);else if(a.data.error){var l=a.data.error.message;"invalid_api_key"==a.data.error.code&&(l+='\nPlease add your key on ".env": \nOPENAI_API_KEY={YOUR KEY HERE}'),(0,r.addResponseMessage)(l)}else(0,r.addResponseMessage)(a.data.choices[0].message.content),w(a.data.choices[0].message.content),_(void 0)},handleToggle:async e=>{e&&h&&(f(!1),(0,r.toggleMsgLoader)(),await x(),(0,r.toggleMsgLoader)()),j(e)},handleLauncher:!0})})})})}}}]);