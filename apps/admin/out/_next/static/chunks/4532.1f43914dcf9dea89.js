"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4532],{56626:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(2784),o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=(e,t)=>{let n=(0,r.forwardRef)(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:l,children:c,...d},u)=>(0,r.createElement)("svg",{ref:u,...o,width:a,height:a,stroke:n,strokeWidth:l?24*Number(i)/Number(a):i,className:`lucide lucide-${s(e)}`,...d},[...t.map(([e,t])=>(0,r.createElement)(e,t)),...(Array.isArray(c)?c:[c])||[]]));return n.displayName=`${e}`,n}},1599:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(56626);let o=(0,r.Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]])},5993:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(56626);let o=(0,r.Z)("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]])},88724:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(56626);let o=(0,r.Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},81412:function(e,t,n){n.r(t);var r=n(52322),o=n(2784),s=n(93589),a=n(1201),i=n(48115),l=n(91838),c=n(57643),d=n(1599),u=n(88724),p=n(5993),g=n(17029),h=n(752),m=n(66306),f=n(8939);t.default=e=>{let{tags:t=[],zIndex:n=1,onScreen:y=!0,mode:v="default"}=e,[w,b]=(0,o.useState)(!0),[k,E]=(0,h.KO)(a.qF),x=(0,o.useRef)(),L=()=>{let e=document.querySelector(".rcw-messages-container");e&&(e.scrollTop=e.scrollHeight)};(0,c.tj)(e=>{e.target.classList.contains("rcw-input")&&e.target.focus()});let N=e=>{let t=e.parentNode.parentNode.parentNode,n=document.createElement("img");n.src="/images/youtube-play.svg",n.style.width="".concat(e.offsetWidth,"px"),n.style.height="".concat(e.offsetHeight,"px"),n.style.position="absolute",n.style.transformOrigin="center",n.style.transform="scale(0.20)",n.style.cursor="Pointer",n.style.pointerEvents="none",n.style.left="15px",n.style.top="15px","static"===getComputedStyle(t).position&&(t.style.position="relative"),t.appendChild(n)},{width:C,height:M}=(0,c.iP)(),j=(e,t)=>{if(x.current){let n=x.current.getBoundingClientRect(),r=-((t-n.top)*1),o=-((e-n.right)*1);x.current.firstChild&&n.bottom===n.top&&n.bottom&&(x.current.firstChild.style.bottom=r+"px",x.current.firstChild.style.right=o+"px")}};(0,o.useEffect)(()=>{let e=new MutationObserver(e=>{e.forEach(e=>{"childList"===e.type&&e.addedNodes.length&&e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE&&(e.classList.contains("rcw-message")||e.classList.contains("rcw-conversation-container"))){let t=e.getElementsByClassName("rcw-message-img");for(let e of t)if(e.complete){N(e),L();for(let e=1;e<11;e++)setTimeout(()=>L(),100*e)}else e.addEventListener("load",()=>{L();for(let e=1;e<11;e++)setTimeout(()=>L(),100*e);N(e)})}}),(e.target.classList.contains("is_DialogContent")||e.target.closest(".is_DialogContent"))&&!e.target.closest(".rcw-widget-container")&&j(window.innerWidth,window.innerHeight)})}),t=document.querySelector("body");return t&&e.observe(t,{childList:!0,subtree:!0}),()=>{e.disconnect()}},[]);let _=async()=>{console.log("requesting: ","/adminapi/v1/resources?search=tags:"+t.join(","));let e=await i.bl.get("/adminapi/v1/resources?search=tags:"+t.join(","));if(e.isLoaded&&e.data.items&&e.data.items.length){let t=e.data.items.map(async e=>{if("text"==e.type){let t=await i.bl.get(e.url,void 0,!0);return t.data}if("youtube"==e.type){let t=e.url.split("=");if(t.length<2)return null;let n=t[1];return"[![video](https://img.youtube.com/vi/"+n+"/0.jpg)]("+e.url+' "Video Title")\n'+e.description}return null}),n=await Promise.all(t);return n.filter(e=>null!==e)}return[]},R=async()=>{let e=await _();if(e.forEach(e=>(0,s.addResponseMessage)(e)),!k){let e="I'm here to help you. Feel free to ask questions about the system.";(0,s.addResponseMessage)(e),E(e)}};(0,o.useEffect)(()=>{j(window.innerWidth,window.innerHeight)},[C,M]);let[S,Z]=(0,o.useState)(),[O,T]=(0,o.useState)();(0,o.useEffect)(()=>{var e=document.createElement("input");e.type="file",e.accept="image/*",e.style.display="none",e.addEventListener("change",e=>{var t=e.target.files[0];if(t){let e=new FileReader;e.onload=e=>{Z({content:e.target.result,filename:t.name})},e.readAsDataURL(t)}});var t=document.createElement("div");t.className="rcw-picker-icon-container",t.addEventListener("click",()=>{e.click()});let n=g.createRoot(t);n.render((0,r.jsx)(d.Z,{size:24,className:"rcw-picker-icon"}));var o=x.current.getElementsByClassName("rcw-picker-btn")[0];return o&&o.parentNode.replaceChild(t,o),()=>{n.unmount()}},[null==x?void 0:null===(z=x.current)||void 0===z?void 0:z.isOpen,O]);for(var z,P=0;P<20;P++)(0,c.KS)(()=>{j(window.innerWidth,window.innerHeight)},50*P);let[W]=(0,h.KO)(a.XD);return(0,r.jsx)(l.I,{children:(0,r.jsx)("div",{ref:x,onMouseDown:e=>e.preventDefault(),onClick:e=>e.preventDefault(),style:{transform:"none",zIndex:1e5,bottom:0,right:0,position:"fixed"},children:(0,r.jsx)("div",{style:{position:"absolute"},children:(0,r.jsx)(s.Widget,{title:"Assistant",launcher:e=>(0,r.jsx)(m.zx,{onPress:e,animation:"lazy",alignSelf:"flex-end",marginTop:"40px",hoverStyle:{backgroundColor:"$color7"},backgroundColor:"$color7",size:"$5",right:"$5",bottom:"$5",circular:!0,children:O?(0,r.jsx)(f.sL,{animation:"bouncy",enterStyle:{rotate:"-90deg"},children:(0,r.jsx)(u.Z,{size:"30px",fillOpacity:0,color:"white"})}):(0,r.jsx)(p.Z,{fillOpacity:0,color:"white"})}),subtitle:"Get help, ideas and documentation",handleNewUserMessage:async e=>{console.log("Prompt chain: ",W);let t=e.startsWith("/"),n=e.startsWith("/help"),r=!!(t&&(null==S?void 0:S.content)),o=W.reduce((t,r)=>t+(n?r.generateCommand(e,t):r.generate(e,t,null==S?void 0:S.content)),"")+(n?"\n                                    ]\n\n                                    End of command list.\n\n                                    The user wants to know the list of available commands. Include all the commands in the reply, and include a small description of the command. use the field action for the description of what the command does, but summarize it. \n                                    ":t?"\n\n                                    ------\n                                    request: ".concat(e.replace(/^\/\S+/,"").trim()):'\n                                    reply directly to the user, acting as the assistant.\n\n                                    The question of the user for the assistant is:\n                                    "'.concat(e,'".'));r&&(o=[{type:"image_url",image_url:S.content},o]),console.log("prompt: ",o),(0,s.toggleMsgLoader)();let a=await i.bl.post("/adminapi/v1/assistants",{messages:[{role:"user",content:o}],best_of:4,temperature:n?0:1,gptModel:r?"gpt-4-vision-preview":void 0});if((0,s.toggleMsgLoader)(),console.log("result: ",a),a.isError)(0,s.addResponseMessage)("Error generating response: ",a.error);else if(a.data.error){var l=a.data.error.message;"invalid_api_key"==a.data.error.code&&(l+='\nPlease add your key on ".env": \nOPENAI_API_KEY={YOUR KEY HERE}'),(0,s.addResponseMessage)(l)}else(0,s.addResponseMessage)(a.data.choices[0].message.content),E(a.data.choices[0].message.content),Z(void 0)},handleToggle:async e=>{e&&w&&(b(!1),(0,s.toggleMsgLoader)(),await R(),(0,s.toggleMsgLoader)()),T(e)},handleLauncher:!0})})})})}}}]);