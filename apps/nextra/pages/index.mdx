# Protofy

**Protofy** is a complete and functional full stack Javascript/React/ESP32 software architecture, packaged as a portable and ready to use project.
Designed to facilitate the creation of modern, interactive, multi-platform applications (Android and iOS mobile, web, desktop, microcontrollers), automations, IoT systems, and REST APIs. 

It provides a preconfigured and extensible set of programs, packaged as a yarn workspace, that are fully integrated and work together to create a seamless developer experience.

You can start a full development environment that combines the ability to create and integrate: Websites, Native Mobile Apps for Android and iOS, Desktop applications for Windows, Linux and Mac, Rest APIs and IoT systems using ESP32.

We build upon popular technologies and tools from the NPM ecosystem, like Next.js, Electron, Express, Pino, Nextra, Aedes, Redbird, LevelJS, Tamagui, and Zod, combined with ESPHome for configuring and controlling IoT devices.

Protofy provides a complete and functional software architecture within a folder, with all the pieces nicely integrated and ready to be extended and customized.

The system includes a functional user system with login and register, JWT sessions and a fully functional admin panel with low code widgets, database explorer and editor, and a fully extensible CMS.

From the developer perspective, protofy is a yarn workspace monorepo, with an apps/ folder containing expo, express, next and electron apps, combined with a reverse proxy, a MQTT broker and a LevelJS database system.
There is also a packages/ folder with a set of available libraries, and packages/app where you can place shared code between all the apps.

There is an Object system based on Zod + some custom extensions, and a system to create Rest APIs from Zod schemas, combined with react widgets that provides automatic forms and interactive widgets, for a given Zod Schema.

The system can be configured and extended by any user using the web admin panel, or by editing the code using your prefered code editor. 


## üèÉ‚Äç‚ôÇÔ∏è Getting started

You can run the project using your local environment or using docker.

Clone the project:

```
git clone https://github.com/Protofy-xyz/Protofy.git
cd Protofy
```

### Option 1: Local environment (simpler): 

To run Protofy in your local environment. 

If you don't have yarn installed globally, you may need to do (first time only):

```
npm i -g yarn
```

Start protofy in development mode (hot reload)

```sh
yarn && yarn start-dev-full
```


### Option 2: Docker (more advanced)

To run the project using docker (no node or npm needed) just run:

```
cd docker
./start-dev
```

if you want to run it in background mode, use:

```
cd docker
./dev
```

To compile protofy in production mode using docker:

```
cd docker
./web-build
./start-prod
```

## Access the system

By default there is a proxy running on port `8080` that redirects to the **next.js** app on port `3000` and the **api** on port `3001` and the **admin-api** on port `3002`. You can go to `apps/proxy/index.ts` to change defaults or add more services like the expo app.

Once the Next.js app is running you can go to `http://localhost:8080` to see the web app. 

*Reminder: If you have problems accessing the services, remember to check your firewall configuration.*

## üôã‚Äç‚ôÇÔ∏è Adding a user
The first time you run the starter you won't have users. You can easily create one on `http://localhost:8080/auth/login` but this one will be a normal user. If you want to create an admin user you can do it by running the following command:

```sh
yarn add-user user@email.com password admin
```

Or if you started with docker: 

```
cd docker
./add-user
```

We just created a user with `admin` type.
The admin panel requires to have a user with `admin` type to be able to access it.

Normal users can register through the interface, or you can create user accounts (whout admin panel access):

```sh
yarn add-user user@email.com password user
```

Or if you started with docker: 

```
cd docker
./add-user
```

## üî® Admin Panel
Once you've logged in with and admin account, you will be able to access the admin panel. The admin panel (also called Workspace) is the place where you can create and manage your system entities, like pages, apis, devices, users, objects, etc...